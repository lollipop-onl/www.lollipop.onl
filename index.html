<!doctype html>
<html data-n-head-ssr>
  <head>
    <link rel="preload" href="/_nuxt/63f2c43b668bc41801ef.js" as="script"><link rel="preload" href="/_nuxt/7ad8d55b9f2306065a8d.js" as="script"><link rel="preload" href="/_nuxt/e7e5084f2957a4db6cda.css" as="style"><link rel="preload" href="/_nuxt/c0393ebd98189b802a9a.js" as="script"><link rel="preload" href="/_nuxt/3dd9f654b6a2ae6bc299.css" as="style"><link rel="preload" href="/_nuxt/d3c720332ba6bc309111.js" as="script"><link rel="stylesheet" href="/_nuxt/e7e5084f2957a4db6cda.css"><link rel="stylesheet" href="/_nuxt/3dd9f654b6a2ae6bc299.css">
  </head>
  <body>
    <div data-server-rendered="true" id="__nuxt"><!----><div id="__layout"><div data-v-ff649d12><pre data-v-ff649d12>version: 0.0.8</pre><div data-v-57ea9dbe data-v-ff649d12><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/a1094d7b-132c-344f-839e-65d5086534ee.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/abad9273-a1c7-d3c8-6bab-d90c7783d7c0.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/a8f2eae8-57f1-b9dc-0b81-099e12086be8.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/1f559d6b-a0fe-6a73-0400-8465c250551a.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe><img src="https://placehold.jp/320x320.png" data-v-9b2fa110 data-v-57ea9dbe></div></div></div></div><script>window.__NUXT__=function(s,a,n,p,e,l,c,t,o,i,r,d,m,u,f,g,h,b,x,v,k,E,y,A,w,_){return{layout:"default",data:[{qiitaItems:[{rendered_body:'<p>記事を書いているときに参考にしたウェブページを掲載しますが、タイトルのコピーが厄介です。</p>\n\n<p>そんなときのために、表示しているページのタイトルをコピーするブックマークレットをご紹介します。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="c1">// タイトルを参照</span>\n  <span class="kd">const</span> <span class="nx">title</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>\n\n  <span class="c1">// コピーの元にするtextareaを作成</span>\n  <span class="kd">const</span> <span class="nx">textarea</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">\'</span><span class="s1">textarea</span><span class="dl">\'</span><span class="p">);</span>\n  <span class="nx">textarea</span><span class="p">.</span><span class="nx">textContent</span> <span class="o">=</span> <span class="nx">title</span><span class="p">;</span>\n\n  <span class="c1">// bodyタグの最後にtextareaを追加</span>\n  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">textarea</span><span class="p">);</span>\n\n  <span class="c1">// textareaの内容をクリップボードにコピー</span>\n  <span class="nx">textarea</span><span class="p">.</span><span class="nx">select</span><span class="p">();</span>\n  <span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="dl">\'</span><span class="s1">copy</span><span class="dl">\'</span><span class="p">);</span>\n\n  <span class="c1">// 最初に作成したtextareaをbodyから削除</span>\n  <span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">textarea</span><span class="p">);</span>\n\n  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Copyed this website title "</span><span class="p">${</span><span class="nx">title</span><span class="p">}</span><span class="s2">"`</span><span class="p">);</span>\n<span class="p">})();</span>\n</pre></div></div>\n\n<p>Minified:</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span><span class="kd">const</span> <span class="nx">e</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">title</span><span class="p">,</span><span class="nx">t</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">"</span><span class="s2">textarea</span><span class="dl">"</span><span class="p">);</span><span class="nx">t</span><span class="p">.</span><span class="nx">textContent</span><span class="o">=</span><span class="nx">e</span><span class="p">,</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span><span class="nx">t</span><span class="p">.</span><span class="nx">select</span><span class="p">(),</span><span class="nb">document</span><span class="p">.</span><span class="nx">execCommand</span><span class="p">(</span><span class="dl">"</span><span class="s2">copy</span><span class="dl">"</span><span class="p">),</span><span class="nb">document</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">removeChild</span><span class="p">(</span><span class="nx">t</span><span class="p">),</span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`Copyed this website title "</span><span class="p">${</span><span class="nx">e</span><span class="p">}</span><span class="s2">"`</span><span class="p">)})();</span>\n</pre></div></div>\n\n<p>使い方：</p>\n\n<p>冒頭に<code>javascript:</code>をつけてブックマークに保存してください。あとは、登録したブックマークを実行したらタイトルがコピーできるようになります。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">javascript</span><span class="p">(()</span><span class="o">=&gt;</span><span class="p">{</span><span class="kd">const</span><span class="p">...});</span>\n</pre></div></div>\n',body:'記事を書いているときに参考にしたウェブページを掲載しますが、タイトルのコピーが厄介です。\n\nそんなときのために、表示しているページのタイトルをコピーするブックマークレットをご紹介します。\n\n```ts\n(() => {\n  // タイトルを参照\n  const title = document.title;\n\n  // コピーの元にするtextareaを作成\n  const textarea = document.createElement(\'textarea\');\n  textarea.textContent = title;\n\n  // bodyタグの最後にtextareaを追加\n  document.body.appendChild(textarea);\n  \n  // textareaの内容をクリップボードにコピー\n  textarea.select();\n  document.execCommand(\'copy\');\n\n  // 最初に作成したtextareaをbodyから削除\n  document.body.removeChild(textarea);\n\n  console.log(`Copyed this website title "${title}"`);\n})();\n```\n\nMinified:\n\n```ts\n(()=>{const e=document.title,t=document.createElement("textarea");t.textContent=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),console.log(`Copyed this website title "${e}"`)})();\n```\n\n使い方：\n\n冒頭に`javascript:`をつけてブックマークに保存してください。あとは、登録したブックマークを実行したらタイトルがコピーできるようになります。\n\n```ts\njavascript(()=>{const...});\n```\n',coediting:a,comments_count:0,created_at:b,group:p,id:"234c2a8203ac951bef19",likes_count:0,private:a,reactions_count:0,tags:[{name:"bookmarklet",versions:[]}],title:"見ているサイトのタイトルをコピーするブックマークレット",updated_at:b,url:"https://qiita.com/simochee/items/234c2a8203ac951bef19",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>\n\n<p>せっかくTypeScriptを使っているのだから、<code>Vue.set</code>も型安全にしたい！と、誰しも一度は考えたことがあるのではないでしょうか？</p>\n\n<p>この記事では、過程とともに<code>Vue.set</code>を型安全にする実装をご紹介します。</p>\n\n<h1>\n<span id="tldr" class="fragment"></span><a href="#tldr"><i class="fa fa-link"></i></a>TL;DR</h1>\n\n<p><details><summary>最終的なコード</summary><br>\n<p></p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">Vue</span><span class="p">.</span><span class="nx">typedSet</span> <span class="o">=</span> <span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Vue</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// src/@types/vue.d.ts</span>\n<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="nx">declare</span> <span class="nx">module</span> <span class="dl">\'</span><span class="s1">vue/types/vue</span><span class="dl">\'</span> <span class="p">{</span>\n  <span class="kr">interface</span> <span class="nx">VueConstructor</span> <span class="p">{</span>\n    <span class="nx">typedSet</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]):</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p></p>\n<br>\n</details></p>\n\n<h1>\n<span id="vuesetの型" class="fragment"></span><a href="#vueset%E3%81%AE%E5%9E%8B"><i class="fa fa-link"></i></a><code>Vue.set</code>の型</h1>\n\n<p><code>Vue.set</code>の型は<code>vue/types/vue.d.ts</code>に以下のように定義されています。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre>  <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span><span class="p">;</span>\n  <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">array</span><span class="p">:</span> <span class="nx">T</span><span class="p">[],</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">number</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">):</span> <span class="nx">T</span><span class="p">;</span>\n</pre></div></div>\n\n<p>配列の場合は問題ないのですが、オブジェクトの値は本来の型とは異なるものを設定できてしまいます。</p>\n\n<p>これは良くない、ということで型安全にする手立てを考えてみましょう。</p>\n\n<h1>\n<span id="型安全なvuesetの型を考える" class="fragment"></span><a href="#%E5%9E%8B%E5%AE%89%E5%85%A8%E3%81%AAvueset%E3%81%AE%E5%9E%8B%E3%82%92%E8%80%83%E3%81%88%E3%82%8B"><i class="fa fa-link"></i></a>型安全な<code>Vue.set</code>の型を考える</h1>\n\n<p>まずは、型安全な<code>Vue.set</code>がどのようなものかを考えてみましょう。</p>\n\n<p>第２引数は第１引数で取りうるKeyを指定でき、第３引数では第2引数で指定した第１引数のKeyの値と同じ型を指定することができる、ということになります。</p>\n\n<p>これを型定義に書き起こすと、以下のようになります。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre>  <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]):</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span>\n</pre></div></div>\n\n<p>これ１つで配列もオブジェクトもOKなSetメソッドの型を定義することができました。</p>\n\n<h1>\n<span id="vueconstructorへの型指定" class="fragment"></span><a href="#vueconstructor%E3%81%B8%E3%81%AE%E5%9E%8B%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a><code>VueConstructor</code>への型指定</h1>\n\n<p><code>Vue.set</code>の型が定義されている<code>vue/types/vue.d.ts</code>の<code>VueConstructor</code>を拡張しましょう。</p>\n\n<p>TypeScriptでは対象範囲全ての<code>@types</code>以下の型定義ファイルを自動でコンパイルに含めてくれます。<br>\n今回は<code>src/@types/</code>以下に<code>vue.d.ts</code>という型定義ファイルを作成しました。</p>\n\n<p>この中に、<code>VueConstructor</code>を拡張するような型定義を書いてみましょう。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// src/@types/vue.d.ts</span>\n<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="nx">declare</span> <span class="nx">module</span> <span class="dl">\'</span><span class="s1">vue/types/vue</span><span class="dl">\'</span> <span class="p">{</span>\n  <span class="kr">interface</span> <span class="nx">VueConstructor</span> <span class="p">{</span>\n    <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]):</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p><code>declare module</code>は続くモジュール名（今回の場合は<code>node_modules/vue</code>以下の<code>types/vue.d.ts</code>を指定）の内部を拡張することができます。<br>\n<code>declare module \'vue/types/vue\' { ... }</code>の<code>{ ... }</code>内は<code>vue/types/vue.d.ts</code>で<code>export</code>されているインターフェースをオーバーライドすることができます。</p>\n\n<h1>\n<span id="使ってみた" class="fragment"></span><a href="#%E4%BD%BF%E3%81%A3%E3%81%A6%E3%81%BF%E3%81%9F"><i class="fa fa-link"></i></a>使ってみた</h1>\n\n<p>これで、<code>Vue.set</code>をタイプセーフに拡張できました。試してみましょう。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fa1094d7b-132c-344f-839e-65d5086534ee.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=4a8a475de3085bbada26d56fa83a36fa" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fa1094d7b-132c-344f-839e-65d5086534ee.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=4a8a475de3085bbada26d56fa83a36fa" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/a1094d7b-132c-344f-839e-65d5086534ee.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fa1094d7b-132c-344f-839e-65d5086534ee.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=99e970267021d8181cf8cac78a40e30d 1x" loading="lazy"></a></p>\n\n<p>キーは補完されるようになりました！続いて不正な値を設定してみましょう！</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Ffc37302d-338d-03b7-fc2f-62dd699e3f72.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=24dc3a0b7d28a063f3d4325b7b8f5666" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Ffc37302d-338d-03b7-fc2f-62dd699e3f72.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=24dc3a0b7d28a063f3d4325b7b8f5666" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/fc37302d-338d-03b7-fc2f-62dd699e3f72.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Ffc37302d-338d-03b7-fc2f-62dd699e3f72.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=65197acc5e82c37e260f820889db0fcf 1x" loading="lazy"></a></p>\n\n<p>おやおや・・・<code>obj.foo</code>は文字列なのに<code>0</code>を設定できてしまいました。これはいけない。</p>\n\n<h2>\n<span id="不正な型を設定できる理由" class="fragment"></span><a href="#%E4%B8%8D%E6%AD%A3%E3%81%AA%E5%9E%8B%E3%82%92%E8%A8%AD%E5%AE%9A%E3%81%A7%E3%81%8D%E3%82%8B%E7%90%86%E7%94%B1"><i class="fa fa-link"></i></a>不正な型を設定できる理由</h2>\n\n<p>TypeScriptのインターフェース拡張は「すでにある定義を壊さない形での拡張」のみが許されます。<br>\nさらに、関数の場合は引数の数が同じ定義の関数があればチェック対象となります。</p>\n\n<p>つまりこの事象は、型安全な方の型チェックに引っかかったけど、後続の型安全でない方の型チェックがパスしたからOK、みたいな挙動になってしまっているわけです。</p>\n\n<p>ということで、純粋に<code>Vue.set</code>を拡張するだけでは元の定義が後に控えているためあまり意味がありません。</p>\n\n<h1>\n<span id="後続の型定義を参照させないようにする" class="fragment"></span><a href="#%E5%BE%8C%E7%B6%9A%E3%81%AE%E5%9E%8B%E5%AE%9A%E7%BE%A9%E3%82%92%E5%8F%82%E7%85%A7%E3%81%95%E3%81%9B%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>後続の型定義を参照させないようにする</h1>\n\n<p>TypeScriptで後続の型定義を探す条件は「全く同じ定義の型」に限られます。</p>\n\n<p>以下のような型定義の場合は<code>fn()</code>は引数さえあれば型エラーになりません。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kr">interface</span> <span class="nx">Sample</span> <span class="p">{</span>\n  <span class="nx">fn</span><span class="p">(</span><span class="nx">foo</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n  <span class="nx">fn</span><span class="p">(</span><span class="nx">bar</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="nx">fn</span><span class="p">(</span><span class="dl">\'</span><span class="s1">a</span><span class="dl">\'</span><span class="p">);</span>\n<span class="nx">fn</span><span class="p">({});</span>\n</pre></div></div>\n\n<p>これに第２引数のあるメソッドを追加してみると、正しく型チェックが行われるようになります。当然といえば当然ですね。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kr">interface</span> <span class="nx">Sample</span> <span class="p">{</span>\n  <span class="nx">fn</span><span class="p">(</span><span class="nx">baz</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="nx">qux</span><span class="p">:</span> <span class="nx">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n  <span class="nx">fn</span><span class="p">(</span><span class="nx">foo</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n  <span class="nx">fn</span><span class="p">(</span><span class="nx">bar</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="k">void</span><span class="p">;</span>\n<span class="p">}</span>\n\n<span class="nx">fn</span><span class="p">(</span><span class="dl">\'</span><span class="s1">a</span><span class="dl">\'</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">// OK</span>\n<span class="nx">fn</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>   <span class="c1">// Error</span>\n</pre></div></div>\n\n<p>つまり、引数の数を増やせば、後続の型定義を参照させずに済むということです。<br>\nこれを<del>悪用</del>利用して、型定義上だけ、フラグを追加してみます。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// src/@types/vue.d.ts</span>\n<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="nx">declare</span> <span class="nx">module</span> <span class="dl">\'</span><span class="s1">vue/types/vue</span><span class="dl">\'</span> <span class="p">{</span>\n  <span class="kr">interface</span> <span class="nx">VueConstructor</span> <span class="p">{</span>\n    <span class="kd">set</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">],</span> <span class="nx">isTyped</span><span class="p">:</span> <span class="kc">true</span><span class="p">):</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>これで、第4引数に<code>true</code>が渡された場合は型安全な<code>Vue.set</code>を利用することができるようになります。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2F4c93f1fb-b024-3bb5-6237-15e9dea2175c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=5ffc9df69a13726a1f1c6d3555477463" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2F4c93f1fb-b024-3bb5-6237-15e9dea2175c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=5ffc9df69a13726a1f1c6d3555477463" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/4c93f1fb-b024-3bb5-6237-15e9dea2175c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2F4c93f1fb-b024-3bb5-6237-15e9dea2175c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=d5cb5c7cc09ae1efe9836144b2e36602 1x" loading="lazy"></a></p>\n\n<p>先程の例でも文字列以外は設定できなくなりました。</p>\n\n<hr>\n\n<p>で、終わってしまいたかったのですが、いつか本当に<code>Vue.set</code>の第4引数にフラグが追加されてしまったときにこの型定義では困ります。<br>\nまた、まやかしの型定義はそれ自体が黒魔術なのであまり胸を張って使えるものではありませんね。</p>\n\n<p>代案を考えましょう。</p>\n\n<h1>\n<span id="vuetypedsetを実装する" class="fragment"></span><a href="#vuetypedset%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>Vue.typedSet</code>を実装する</h1>\n\n<p><code>Vue.set</code>の拡張は厳しそうです。<br>\nならばいっそ、<code>Vue.typedSet</code>という新しいグローバルメソッドを定義してしまいましょう。</p>\n\n<p>Vueのグローバルメソッドの追加は簡単で、<code>Vue.newGlobalMethod = Function</code>のようにVueにプロパティを生やすだけです。</p>\n\n<p><code>Vue.typedSet</code>は<code>Vue.set</code>のエイリアスで良いので、実装自体は以下のようになります。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">Vue</span><span class="p">.</span><span class="nx">typedSet</span> <span class="o">=</span> <span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Vue</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>\n</pre></div></div>\n\n<p>もし、Nuxtを使用しているのなら、プラグインを定義してこれをサーバー・クライアント双方で呼び出すようにしておけば問題ないでしょう。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// @/plugins/vue-typedSet.ts`</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Plugin</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@nuxt/types</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="kd">const</span> <span class="nx">plugin</span><span class="p">:</span> <span class="nx">Plugin</span> <span class="o">=</span> <span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">inject</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="nx">Vue</span><span class="p">.</span><span class="nx">typedSet</span> <span class="o">=</span> <span class="p">(</span><span class="na">object</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="na">key</span><span class="p">:</span> <span class="nx">any</span><span class="p">,</span> <span class="na">value</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">Vue</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">object</span><span class="p">,</span> <span class="nx">key</span><span class="p">,</span> <span class="nx">value</span><span class="p">);</span>\n<span class="p">});</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="nx">plugin</span><span class="p">;</span>\n</pre></div></div>\n\n<p>最後に、先程拡張した型定義のメソッド名を<code>typedSet</code>に変更しましょう。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// src/@types/vue.d.ts</span>\n<span class="k">import</span> <span class="nx">Vue</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="nx">declare</span> <span class="nx">module</span> <span class="dl">\'</span><span class="s1">vue/types/vue</span><span class="dl">\'</span> <span class="p">{</span>\n  <span class="kr">interface</span> <span class="nx">VueConstructor</span> <span class="p">{</span>\n    <span class="nx">typedSet</span><span class="o">&lt;</span><span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">object</span><span class="p">:</span> <span class="nx">T</span><span class="p">,</span> <span class="nx">key</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]):</span> <span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">];</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>新しいメソッドを定義してしまいましたが、これで型安全に<code>Vue.set</code>できるようになりました！</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fee193bab-eb63-b419-321e-03a5acf036a3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=3d8c6f20c6aed221bf04de2a7aa24bc7" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fee193bab-eb63-b419-321e-03a5acf036a3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=3d8c6f20c6aed221bf04de2a7aa24bc7" alt="image.png" data-canonical-src="https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/ee193bab-eb63-b419-321e-03a5acf036a3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fee193bab-eb63-b419-321e-03a5acf036a3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=de157df47691460ff48fb65bb1f35e45 1x" loading="lazy"></a></p>\n\n<p>めでたしめでたし。</p>\n\n<h1>\n<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>\n\n<ul>\n<li><a href="https://012-jp.vuejs.org/guide/extending.html" rel="nofollow noopener" target="_blank">Vue の拡張 - vue.js</a></li>\n<li><a href="https://qiita.com/ka_/items/3727c3f16dc69fed935c" id="reference-3738486528aa53033812">foo, bar, baz の続き - Qiita</a></li>\n</ul>\n',body:"# はじめに\n\nせっかくTypeScriptを使っているのだから、`Vue.set`も型安全にしたい！と、誰しも一度は考えたことがあるのではないでしょうか？\n\nこの記事では、過程とともに`Vue.set`を型安全にする実装をご紹介します。\n\n# TL;DR\n\n<details><summary>最終的なコード</summary>\n<p>\n\n```ts\nVue.typedSet = (object: any, key: any, value: any) => Vue.set(object, key, value);\n```\n\n```ts\n// src/@types/vue.d.ts\nimport Vue from 'vue';\n\ndeclare module 'vue/types/vue' {\n  interface VueConstructor {\n    typedSet<T extends object, K extends keyof T>(object: T, key: K, value: T[K]): T[K];\n  }\n}\n```\n\n</p>\n</details>\n\n\n# `Vue.set`の型\n\n`Vue.set`の型は`vue/types/vue.d.ts`に以下のように定義されています。\n\n```ts\n  set<T>(object: object, key: string | number, value: T): T;\n  set<T>(array: T[], key: number, value: T): T;\n```\n\n配列の場合は問題ないのですが、オブジェクトの値は本来の型とは異なるものを設定できてしまいます。\n\nこれは良くない、ということで型安全にする手立てを考えてみましょう。\n\n# 型安全な`Vue.set`の型を考える\n\nまずは、型安全な`Vue.set`がどのようなものかを考えてみましょう。\n\n第２引数は第１引数で取りうるKeyを指定でき、第３引数では第2引数で指定した第１引数のKeyの値と同じ型を指定することができる、ということになります。\n\nこれを型定義に書き起こすと、以下のようになります。\n\n```ts\n  set<T extends object, K extends keyof T>(object: T, key: K, value: T[K]): T[K];\n```\n\nこれ１つで配列もオブジェクトもOKなSetメソッドの型を定義することができました。\n\n# `VueConstructor`への型指定\n\n`Vue.set`の型が定義されている`vue/types/vue.d.ts`の`VueConstructor`を拡張しましょう。\n\nTypeScriptでは対象範囲全ての`@types`以下の型定義ファイルを自動でコンパイルに含めてくれます。\n今回は`src/@types/`以下に`vue.d.ts`という型定義ファイルを作成しました。\n\nこの中に、`VueConstructor`を拡張するような型定義を書いてみましょう。\n\n```ts\n// src/@types/vue.d.ts\nimport Vue from 'vue';\n\ndeclare module 'vue/types/vue' {\n  interface VueConstructor {\n    set<T extends object, K extends keyof T>(object: T, key: K, value: T[K]): T[K];\n  }\n}\n```\n\n`declare module`は続くモジュール名（今回の場合は`node_modules/vue`以下の`types/vue.d.ts`を指定）の内部を拡張することができます。\n`declare module 'vue/types/vue' { ... }`の`{ ... }`内は`vue/types/vue.d.ts`で`export`されているインターフェースをオーバーライドすることができます。\n\n# 使ってみた\n\nこれで、`Vue.set`をタイプセーフに拡張できました。試してみましょう。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/a1094d7b-132c-344f-839e-65d5086534ee.png)\n\nキーは補完されるようになりました！続いて不正な値を設定してみましょう！\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/fc37302d-338d-03b7-fc2f-62dd699e3f72.png)\n\nおやおや・・・`obj.foo`は文字列なのに`0`を設定できてしまいました。これはいけない。\n\n## 不正な型を設定できる理由\n\nTypeScriptのインターフェース拡張は「すでにある定義を壊さない形での拡張」のみが許されます。\nさらに、関数の場合は引数の数が同じ定義の関数があればチェック対象となります。\n\nつまりこの事象は、型安全な方の型チェックに引っかかったけど、後続の型安全でない方の型チェックがパスしたからOK、みたいな挙動になってしまっているわけです。\n\nということで、純粋に`Vue.set`を拡張するだけでは元の定義が後に控えているためあまり意味がありません。\n\n# 後続の型定義を参照させないようにする\n\nTypeScriptで後続の型定義を探す条件は「全く同じ定義の型」に限られます。\n\n以下のような型定義の場合は`fn()`は引数さえあれば型エラーになりません。\n\n```ts\ninterface Sample {\n  fn(foo: string) => void;\n  fn(bar: any) => void;\n}\n\nfn('a');\nfn({});\n```\n\nこれに第２引数のあるメソッドを追加してみると、正しく型チェックが行われるようになります。当然といえば当然ですね。\n\n```ts\ninterface Sample {\n  fn(baz: string, qux: number) => void;\n  fn(foo: string) => void;\n  fn(bar: any) => void;\n}\n\nfn('a', 0); // OK\nfn(0, 0);   // Error\n```\n\nつまり、引数の数を増やせば、後続の型定義を参照させずに済むということです。\nこれを~~悪用~~利用して、型定義上だけ、フラグを追加してみます。\n\n```ts\n// src/@types/vue.d.ts\nimport Vue from 'vue';\n\ndeclare module 'vue/types/vue' {\n  interface VueConstructor {\n    set<T extends object, K extends keyof T>(object: T, key: K, value: T[K], isTyped: true): T[K];\n  }\n}\n```\n\nこれで、第4引数に`true`が渡された場合は型安全な`Vue.set`を利用することができるようになります。\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/4c93f1fb-b024-3bb5-6237-15e9dea2175c.png)\n\n先程の例でも文字列以外は設定できなくなりました。\n\n---\n\nで、終わってしまいたかったのですが、いつか本当に`Vue.set`の第4引数にフラグが追加されてしまったときにこの型定義では困ります。\nまた、まやかしの型定義はそれ自体が黒魔術なのであまり胸を張って使えるものではありませんね。\n\n代案を考えましょう。\n\n# `Vue.typedSet`を実装する\n\n`Vue.set`の拡張は厳しそうです。\nならばいっそ、`Vue.typedSet`という新しいグローバルメソッドを定義してしまいましょう。\n\nVueのグローバルメソッドの追加は簡単で、`Vue.newGlobalMethod = Function`のようにVueにプロパティを生やすだけです。\n\n`Vue.typedSet`は`Vue.set`のエイリアスで良いので、実装自体は以下のようになります。\n\n```ts\nVue.typedSet = (object: any, key: any, value: any) => Vue.set(object, key, value);\n```\n\nもし、Nuxtを使用しているのなら、プラグインを定義してこれをサーバー・クライアント双方で呼び出すようにしておけば問題ないでしょう。\n\n```ts\n// @/plugins/vue-typedSet.ts`\nimport { Plugin } from '@nuxt/types';\n\nconst plugin: Plugin = (context, inject) => {\n  Vue.typedSet = (object: any, key: any, value: any) => Vue.set(object, key, value);\n});\n\nexport default plugin;\n```\n\n最後に、先程拡張した型定義のメソッド名を`typedSet`に変更しましょう。\n\n```ts\n// src/@types/vue.d.ts\nimport Vue from 'vue';\n\ndeclare module 'vue/types/vue' {\n  interface VueConstructor {\n    typedSet<T extends object, K extends keyof T>(object: T, key: K, value: T[K]): T[K];\n  }\n}\n```\n\n新しいメソッドを定義してしまいましたが、これで型安全に`Vue.set`できるようになりました！\n\n![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/ee193bab-eb63-b419-321e-03a5acf036a3.png)\n\nめでたしめでたし。\n\n# 参考\n\n* [Vue の拡張 - vue.js](https://012-jp.vuejs.org/guide/extending.html)\n* [foo, bar, baz の続き - Qiita](https://qiita.com/ka_/items/3727c3f16dc69fed935c)\n",coediting:a,comments_count:0,created_at:"2019-10-17T21:23:09+09:00",group:p,id:"4d31414cb612f96a4c9f",likes_count:e,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:g,versions:[]}],title:"TypeScriptでVue.setを型安全にしたい",updated_at:"2019-10-21T20:10:33+09:00",url:"https://qiita.com/simochee/items/4d31414cb612f96a4c9f",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h2>\n<span id="profile" class="fragment"></span><a href="#profile"><i class="fa fa-link"></i></a>Profile</h2>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-user-profile-images.imgix.net%2Fhttps%253A%252F%252Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%252F0%252F127934%252Fprofile-images%252F1558357993%3Fixlib%3Drb-1.2.2%26auto%3Dcompress%252Cformat%26lossless%3D0%26w%3D300%26s%3D5680c7c3e731dcc74dc2e6f5eb18d267?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=a574ec04faf21ea0d157e1038767275f" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-user-profile-images.imgix.net%2Fhttps%253A%252F%252Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%252F0%252F127934%252Fprofile-images%252F1558357993%3Fixlib%3Drb-1.2.2%26auto%3Dcompress%252Cformat%26lossless%3D0%26w%3D300%26s%3D5680c7c3e731dcc74dc2e6f5eb18d267?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=a574ec04faf21ea0d157e1038767275f" width="120px" data-canonical-src="https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fprofile-images%2F1558357993?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;lossless=0&amp;w=300&amp;s=5680c7c3e731dcc74dc2e6f5eb18d267" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-user-profile-images.imgix.net%2Fhttps%253A%252F%252Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%252F0%252F127934%252Fprofile-images%252F1558357993%3Fixlib%3Drb-1.2.2%26auto%3Dcompress%252Cformat%26lossless%3D0%26w%3D300%26s%3D5680c7c3e731dcc74dc2e6f5eb18d267?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=67d50f8170ce749f59281e6698b29280 1x" loading="lazy"></a><br>\n・simochee <sub>(しもちぃって読みます)</sub><br>\n・フロントエンドエンジニア<br>\n・<a href="https://qiita.com/simochee">Qiita (simochee)</a><br>\n・<a href="https://twitter.com/lollipop_onl" rel="nofollow noopener" target="_blank">Twitter</a></p>\n\n<hr>\n\n<h2>\n<span id="proposal-collection-normalization" class="fragment"></span><a href="#proposal-collection-normalization"><i class="fa fa-link"></i></a><a href="https://github.com/tc39/proposal-collection-normalization" rel="nofollow noopener" target="_blank">proposal-collection-normalization</a>\n</h2>\n\n<p><em>Stage 2</em></p>\n\n<p><strong>Map/SetへKeyとValueを正規化する<br><code>coerceKey</code>と<code>coerceValue</code>の追加</strong></p>\n\n<hr>\n\n<h3>\n<span id="以降実際に動かしてはいません" class="fragment"></span><a href="#%E4%BB%A5%E9%99%8D%E5%AE%9F%E9%9A%9B%E3%81%AB%E5%8B%95%E3%81%8B%E3%81%97%E3%81%A6%E3%81%AF%E3%81%84%E3%81%BE%E3%81%9B%E3%82%93"><i class="fa fa-link"></i></a>※以降、実際に動かしてはいません</h3>\n\n<hr>\n\n<h2>\n<span id="keyの正規化オブジェクトのkeyをkeyとして設定する" class="fragment"></span><a href="#key%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%8C%96%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%AEkey%E3%82%92key%E3%81%A8%E3%81%97%E3%81%A6%E8%A8%AD%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Keyの正規化①<br>オブジェクトのKeyをKeyとして設定する</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">profile</span> <span class="o">=</span> <span class="p">{</span> <span class="na">email</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee@example.com</span><span class="dl">\'</span> <span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">pointMap</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="p">{</span>\n  <span class="na">coerceKey</span><span class="p">:</span> <span class="p">({</span> <span class="nx">email</span> <span class="p">})</span> <span class="o">=&gt;</span> <span class="nx">email</span><span class="p">,</span>\n<span class="p">});</span>\n\n<span class="nx">pointMap</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="nx">profile</span><span class="p">,</span> <span class="mi">1200</span><span class="p">);</span>\n\n<span class="nx">pointMap</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">\'</span><span class="s1">simochee@example.com</span><span class="dl">\'</span><span class="p">);</span> <span class="c1">// 1200</span>\n</pre></div></div>\n\n<hr>\n\n<h2>\n<span id="keyの正規化keyを文字列化させる" class="fragment"></span><a href="#key%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%8C%96key%E3%82%92%E6%96%87%E5%AD%97%E5%88%97%E5%8C%96%E3%81%95%E3%81%9B%E3%82%8B"><i class="fa fa-link"></i></a>Keyの正規化②<br>Keyを文字列化させる</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="p">{</span>\n  <span class="na">coerceKey</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>\n<span class="p">});</span>\n\n<span class="nx">map</span><span class="p">.</span><span class="kd">set</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">);</span>\n<span class="nx">map</span><span class="p">.</span><span class="nx">has</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="c1">// true</span>\n\n<span class="c1">// map.has(\'1\') // true? false?</span>\n\n<span class="p">[...</span><span class="nx">map</span><span class="p">.</span><span class="nx">entries</span><span class="p">()];</span> <span class="c1">// [[\'1\', \'simochee\']]</span>\n</pre></div></div>\n\n<hr>\n\n<h2>\n<span id="valueの正規化データをインスタンス化させる" class="fragment"></span><a href="#value%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%8C%96%E3%83%87%E3%83%BC%E3%82%BF%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E5%8C%96%E3%81%95%E3%81%9B%E3%82%8B"><i class="fa fa-link"></i></a>Valueの正規化①<br>データをインスタンス化させる</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="p">{</span>\n  <span class="na">coerceValue</span><span class="p">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="nx">user</span> <span class="k">instanceof</span> <span class="nx">UserModel</span>\n      <span class="p">?</span> <span class="nx">user</span>\n      <span class="p">:</span> <span class="k">new</span> <span class="nx">UserModel</span><span class="p">(</span><span class="nx">user</span><span class="p">);</span>\n  <span class="p">},</span>\n<span class="p">});</span>\n</pre></div></div>\n\n<hr>\n\n<h2>\n<span id="valueの正規化不正なインスタンスの場合エラーにする" class="fragment"></span><a href="#value%E3%81%AE%E6%AD%A3%E8%A6%8F%E5%8C%96%E4%B8%8D%E6%AD%A3%E3%81%AA%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%BF%E3%83%B3%E3%82%B9%E3%81%AE%E5%A0%B4%E5%90%88%E3%82%A8%E3%83%A9%E3%83%BC%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Valueの正規化②<br>不正なインスタンスの場合エラーにする</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Map</span><span class="p">(</span><span class="kc">undefined</span><span class="p">,</span> <span class="p">{</span>\n  <span class="na">coerceValue</span><span class="p">:</span> <span class="p">(</span><span class="nx">user</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">user</span> <span class="k">instanceof</span> <span class="nx">UserModel</span><span class="p">))</span> <span class="p">{</span>\n      <span class="k">throw</span> <span class="k">new</span> <span class="nx">TypeError</span><span class="p">(</span><span class="dl">\'</span><span class="s1">データの方が不正です</span><span class="dl">\'</span><span class="p">);</span>\n    <span class="p">}</span>\n\n    <span class="k">return</span> <span class="nx">user</span><span class="p">;</span>\n  <span class="p">},</span>\n<span class="p">});</span>\n</pre></div></div>\n\n<hr>\n\n<h2>\n<span id="references" class="fragment"></span><a href="#references"><i class="fa fa-link"></i></a>References</h2>\n\n<ul>\n<li><a href="https://github.com/tc39/proposal-collection-normalization" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/tc39/proposal-collection-normalization</a></li>\n</ul>\n',body:"## Profile\n\n<img src=\"https://qiita-user-profile-images.imgix.net/https%3A%2F%2Fqiita-image-store.s3.ap-northeast-1.amazonaws.com%2F0%2F127934%2Fprofile-images%2F1558357993?ixlib=rb-1.2.2&auto=compress%2Cformat&lossless=0&w=300&s=5680c7c3e731dcc74dc2e6f5eb18d267\" width=\"120px\" />\n・simochee <sub>(しもちぃって読みます)</sub>\n・フロントエンドエンジニア\n・[Qiita (simochee)](https://qiita.com/simochee)\n・[Twitter](https://twitter.com/lollipop_onl)\n\n---\n\n## [proposal-collection-normalization](https://github.com/tc39/proposal-collection-normalization)\n\n*Stage 2*\n\n**Map/SetへKeyとValueを正規化する<br>`coerceKey`と`coerceValue`の追加**\n\n---\n\n### ※以降、実際に動かしてはいません\n\n---\n\n## Keyの正規化①<br>オブジェクトのKeyをKeyとして設定する\n\n```ts\nconst profile = { email: 'simochee@example.com' };\n\nconst pointMap = new Map(undefined, {\n  coerceKey: ({ email }) => email,\n});\n\npointMap.set(profile, 1200);\n\npointMap.get('simochee@example.com'); // 1200\n```\n\n---\n\n## Keyの正規化②<br>Keyを文字列化させる\n\n```ts\nconst map = new Map(undefined, {\n  coerceKey: String,\n});\n\nmap.set(1, 'simochee');\nmap.has(1); // true\n\n// map.has('1') // true? false?\n\n[...map.entries()]; // [['1', 'simochee']]\n```\n\n---\n\n## Valueの正規化①<br>データをインスタンス化させる\n\n```ts\nconst map = new Map(undefined, {\n  coerceValue: (user) => {\n    return user instanceof UserModel\n      ? user\n      : new UserModel(user);\n  },\n});\n```\n\n---\n\n## Valueの正規化②<br>不正なインスタンスの場合エラーにする\n\n```ts\nconst map = new Map(undefined, {\n  coerceValue: (user) => {\n    if (!(user instanceof UserModel)) {\n      throw new TypeError('データの方が不正です');\n    }\n\n    return user;\n  },\n});\n```\n\n---\n\n## References\n\n* https://github.com/tc39/proposal-collection-normalization\n",coediting:a,comments_count:0,created_at:"2019-10-08T09:52:33+09:00",group:p,id:"197dd4ecf1ec7aca4366",likes_count:2,private:a,reactions_count:0,tags:[{name:"TC39",versions:[]}],title:"proposal-collection-normalization",updated_at:"2019-10-09T20:26:14+09:00",url:"https://qiita.com/simochee/items/197dd4ecf1ec7aca4366",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="事象" class="fragment"></span><a href="#%E4%BA%8B%E8%B1%A1"><i class="fa fa-link"></i></a>事象</h1>\n\n<p><code>is</code>属性で要素名を指定しているコンポーネントに対して、<code>v-model</code>を使用すると、<code>v-model</code>が機能しなくなりました。</p>\n\n<p>どういうことかは例を見ていただくと早いです。</p>\n\n<h2>\n<span id="正常" class="fragment"></span><a href="#%E6%AD%A3%E5%B8%B8"><i class="fa fa-link"></i></a>正常</h2>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">v-model=</span><span class="s">"value"</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://jsfiddle.net/simochee/fjdvowr7/4" class="autolink" rel="nofollow noopener" target="_blank">https://jsfiddle.net/simochee/fjdvowr7/4</a></p>\n</blockquote>\n\n<h2>\n<span id="異常" class="fragment"></span><a href="#%E7%95%B0%E5%B8%B8"><i class="fa fa-link"></i></a>異常</h2>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">is=</span><span class="s">"input"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">v-model=</span><span class="s">"value"</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://jsfiddle.net/simochee/fjdvowr7/5" class="autolink" rel="nofollow noopener" target="_blank">https://jsfiddle.net/simochee/fjdvowr7/5</a></p>\n</blockquote>\n\n<h1>\n<span id="原因" class="fragment"></span><a href="#%E5%8E%9F%E5%9B%A0"><i class="fa fa-link"></i></a>原因</h1>\n\n<p>なぜこんな挙動になるのか、それを解決する記述を見つけることはできませんでした。</p>\n\n<p>ともかく<code>is</code>と<code>v-model</code>は併用しないよう気をつけましょう。</p>\n\n<h1>\n<span id="おまけ" class="fragment"></span><a href="#%E3%81%8A%E3%81%BE%E3%81%91"><i class="fa fa-link"></i></a>おまけ</h1>\n\n<p>疑似<code>v-model</code>の場合は更に奇妙な挙動になりました。</p>\n\n<p>初期値は設定されるし、入力値は設定できるものの、代入による値を上書きできなくなります。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span>\n  <span class="na">is=</span><span class="s">"input"</span>\n  <span class="na">type=</span><span class="s">"text"</span>\n  <span class="na">:value=</span><span class="s">"value"</span>\n  <span class="err">@</span><span class="na">input=</span><span class="s">"value = $event.target.value"</span>\n<span class="nt">&gt;</span>\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://jsfiddle.net/simochee/fjdvowr7/7/" class="autolink" rel="nofollow noopener" target="_blank">https://jsfiddle.net/simochee/fjdvowr7/7/</a></p>\n</blockquote>\n',body:'# 事象\n\n`is`属性で要素名を指定しているコンポーネントに対して、`v-model`を使用すると、`v-model`が機能しなくなりました。\n\nどういうことかは例を見ていただくと早いです。\n\n## 正常\n\n```html\n<input type="text" v-model="value">\n```\n\n> https://jsfiddle.net/simochee/fjdvowr7/4\n\n## 異常\n\n```html\n<div is="input" type="text" v-model="value">\n```\n\n> https://jsfiddle.net/simochee/fjdvowr7/5\n\n# 原因\n\nなぜこんな挙動になるのか、それを解決する記述を見つけることはできませんでした。\n\nともかく`is`と`v-model`は併用しないよう気をつけましょう。\n\n# おまけ\n\n疑似`v-model`の場合は更に奇妙な挙動になりました。\n\n初期値は設定されるし、入力値は設定できるものの、代入による値を上書きできなくなります。\n\n```html\n<div\n  is="input"\n  type="text"\n  :value="value"\n  @input="value = $event.target.value"\n>\n```\n\n> https://jsfiddle.net/simochee/fjdvowr7/7/\n',coediting:a,comments_count:0,created_at:v,group:p,id:"b903cbf9227120d92e7e",likes_count:0,private:a,reactions_count:0,tags:[{name:g,versions:[]}],title:"Vueのisとv-modelは併用してはいけない",updated_at:v,url:"https://qiita.com/simochee/items/b903cbf9227120d92e7e",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p><a href=""><code>@typescript-eslint</code></a>は先日v2にメジャーアップデートしました。</p>\n\n<p>それに伴って（？）、VueファイルをLintしようとすると以下のようにエラーが表示されるようになりました。</p>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre>/myproject/src/components/partials/Base/BaseRadio.vue\n  23:9  error  Parsing error: <span class="s1">\'&gt;\'</span> expected\n</pre></div></div>\n\n<p>どうもこれ、<code>@typescript-eslint</code>のv2と<code>vue-eslint-parser</code>に互換性がないことが原因のようです。</p>\n\n<blockquote>\n<p>Incompatibility with typescript-eslint@2<br>\n<a href="https://github.com/vuejs/eslint-plugin-vue/issues/944" class="autolink" rel="nofollow noopener" target="_blank">https://github.com/vuejs/eslint-plugin-vue/issues/944</a></p>\n</blockquote>\n\n<p>ということで、<code>eslint-plugin-vue</code>側がv2に対応するまではバージョンをあげないほうが無難かもしれません。</p>\n\n<p>対応したらそのときは、この記事を更新します。</p>\n',body:"[`@typescript-eslint`]()は先日v2にメジャーアップデートしました。\n\nそれに伴って（？）、VueファイルをLintしようとすると以下のようにエラーが表示されるようになりました。\n\n```sh\n/myproject/src/components/partials/Base/BaseRadio.vue\n  23:9  error  Parsing error: '>' expected\n```\n\nどうもこれ、`@typescript-eslint`のv2と`vue-eslint-parser`に互換性がないことが原因のようです。\n\n> Incompatibility with typescript-eslint@2\n> https://github.com/vuejs/eslint-plugin-vue/issues/944\n\nということで、`eslint-plugin-vue`側がv2に対応するまではバージョンをあげないほうが無難かもしれません。\n\n対応したらそのときは、この記事を更新します。\n",coediting:a,comments_count:0,created_at:"2019-09-05T20:31:12+09:00",group:p,id:"126f42f2e42fcf194515",likes_count:3,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:"ESLint",versions:[]},{name:"eslint-plugin-vue",versions:[]}],title:"vue-eslint-parserには@typescript-eslint v2との互換性がない",updated_at:"2019-09-05T20:32:56+09:00",url:"https://qiita.com/simochee/items/126f42f2e42fcf194515",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<blockquote>\n<p>Failed to start the X server (your graphical interface). It is likely that it is not setup correctly. whould you like to view the X server output to diagnose the problem?</p>\n</blockquote>\n\n<p>などと言ってLinux Mintが起動しなくなった。ヤバい。</p>\n\n<p>どうも原因はNvidiaのドライバインストールしたことに関連しているみたい？</p>\n\n<p>以下の手順で解消。</p>\n\n<h4>\n<span id="1-リカバリモードでlinux-mintを起動" class="fragment"></span><a href="#1-%E3%83%AA%E3%82%AB%E3%83%90%E3%83%AA%E3%83%A2%E3%83%BC%E3%83%89%E3%81%A7linux-mint%E3%82%92%E8%B5%B7%E5%8B%95"><i class="fa fa-link"></i></a>1. リカバリモードでLinux Mintを起動</h4>\n\n<h4>\n<span id="2-root権限のターミナルにログイン" class="fragment"></span><a href="#2-root%E6%A8%A9%E9%99%90%E3%81%AE%E3%82%BF%E3%83%BC%E3%83%9F%E3%83%8A%E3%83%AB%E3%81%AB%E3%83%AD%E3%82%B0%E3%82%A4%E3%83%B3"><i class="fa fa-link"></i></a>2. root権限のターミナルにログイン</h4>\n\n<h4>\n<span id="3-xserverの設定ファイルを開く" class="fragment"></span><a href="#3-xserver%E3%81%AE%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E9%96%8B%E3%81%8F"><i class="fa fa-link"></i></a>3. Xserverの設定ファイルを開く</h4>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre><span class="c"># Xserverの設定ファイルを書き出す</span>\n<span class="nv">$ </span>X <span class="nt">-configure</span>\n\n<span class="c"># 設定ファイルを開く。場所は↑のコマンドの結果を見る</span>\n<span class="nv">$ </span>vi /root/xorg.conf.new\n</pre></div></div>\n\n<h4>\n<span id="4-設定ファイルを変更" class="fragment"></span><a href="#4-%E8%A8%AD%E5%AE%9A%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>4. 設定ファイルを変更</h4>\n\n<p><code>Device</code>セクションの<code>Driver</code>の項目が`<code>になっていたので、</code>nvidia`に変更する。</p>\n\n<h4>\n<span id="5-再起動" class="fragment"></span><a href="#5-%E5%86%8D%E8%B5%B7%E5%8B%95"><i class="fa fa-link"></i></a>5. 再起動</h4>\n\n<h4>\n<span id="復旧" class="fragment"></span><a href="#%E5%BE%A9%E6%97%A7"><i class="fa fa-link"></i></a>復旧！</h4>\n\n<p>Nvidiaはどうしてこう相性悪いこと多いのか。</p>\n',body:"\n> Failed to start the X server (your graphical interface). It is likely that it is not setup correctly. whould you like to view the X server output to diagnose the problem?\n\nなどと言ってLinux Mintが起動しなくなった。ヤバい。\n\nどうも原因はNvidiaのドライバインストールしたことに関連しているみたい？\n\n以下の手順で解消。\n\n#### 1. リカバリモードでLinux Mintを起動\n\n#### 2. root権限のターミナルにログイン\n\n#### 3. Xserverの設定ファイルを開く\n\n```sh\n# Xserverの設定ファイルを書き出す\n$ X -configure\n\n# 設定ファイルを開く。場所は↑のコマンドの結果を見る\n$ vi /root/xorg.conf.new\n```\n\n#### 4. 設定ファイルを変更\n\n`Device`セクションの`Driver`の項目が``になっていたので、`nvidia`に変更する。\n\n#### 5. 再起動\n\n#### 復旧！\n\nNvidiaはどうしてこう相性悪いこと多いのか。\n",coediting:a,comments_count:0,created_at:"2019-08-23T08:56:24+09:00",group:p,id:"344a183c6d05a7d5d7b4",likes_count:0,private:a,reactions_count:0,tags:[{name:"NVIDIA",versions:[]},{name:"LinuxMint",versions:[]},{name:"xserver",versions:[]}],title:"Linux MintがXserverがどうので起動しなくなった",updated_at:"2019-08-23T08:56:33+09:00",url:"https://qiita.com/simochee/items/344a183c6d05a7d5d7b4",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h2>\n<span id="nuxt-29-以降" class="fragment"></span><a href="#nuxt-29-%E4%BB%A5%E9%99%8D"><i class="fa fa-link"></i></a>Nuxt 2.9 以降</h2>\n\n<p>Nuxt 2.9からTypeScriptが外部パッケージ化され、あたらしく<code>@nuxt/types</code>が利用可能になりました。</p>\n\n<p><code>@nuxt/types</code>は手動でのインストールは不要で2.9から追加された<code>@nuxt/typescript-runtime</code>または<code>@nuxt/typescript-build</code>をインストールすることで利用できるようになります。</p>\n\n<p>あとは、<code>@nuxt/types</code>が提供する<code>Context</code>型を<code>context</code>へ指定することで型安全にコーディングできるようになります。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Context</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@nuxt/types</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">nuxt-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="cm">/** Lifecycle */</span>\n  <span class="k">async</span> <span class="nx">asyncData</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">Context</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="p">{</span> <span class="nx">app</span><span class="p">,</span> <span class="nx">store</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>\n\n    <span class="c1">// プラグインにもアクセスできる！</span>\n    <span class="nx">app</span><span class="p">.</span><span class="nx">$plugin</span><span class="p">.</span><span class="nx">run</span><span class="p">();</span>\n\n    <span class="c1">// VuexにDispatchできる！</span>\n    <span class="k">await</span> <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">user/checkAuth</span><span class="dl">\'</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<h2>\n<span id="nuxt-28-以前" class="fragment"></span><a href="#nuxt-28-%E4%BB%A5%E5%89%8D"><i class="fa fa-link"></i></a>Nuxt 2.8 以前</h2>\n\n<p>NuxtとTypeScriptを使う時、<code>fetch</code>と<code>asyncData</code>の引数 <code>context</code> の型がなくて困った経験ありませんか？</p>\n\n<p>Nuxtではコアパッケージの1つである<code>@nuxt/vue-app</code>というパッケージが <code>context</code> の型を提供しています。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Context</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@nuxt/vue-app</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">nuxt-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="cm">/** Lifecycle */</span>\n  <span class="k">async</span> <span class="nx">asyncData</span><span class="p">(</span><span class="nx">context</span><span class="p">:</span> <span class="nx">Context</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{</span>\n    <span class="kd">const</span> <span class="p">{</span> <span class="nx">app</span><span class="p">,</span> <span class="nx">store</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">context</span><span class="p">;</span>\n\n    <span class="c1">// プラグインにもアクセスできる！</span>\n    <span class="nx">app</span><span class="p">.</span><span class="nx">$plugin</span><span class="p">.</span><span class="nx">run</span><span class="p">();</span>\n\n    <span class="c1">// VuexにDispatchできる！</span>\n    <span class="k">await</span> <span class="nx">store</span><span class="p">.</span><span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">user/checkAuth</span><span class="dl">\'</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>これで、<code>context: any</code>や独自のインターフェースの定義が不要になります。</p>\n\n<p>（ドキュメントのどこにも記載がないのはなぜなんだろうか・・・？）</p>\n',body:"## Nuxt 2.9 以降\n\nNuxt 2.9からTypeScriptが外部パッケージ化され、あたらしく`@nuxt/types`が利用可能になりました。\n\n`@nuxt/types`は手動でのインストールは不要で2.9から追加された`@nuxt/typescript-runtime`または`@nuxt/typescript-build`をインストールすることで利用できるようになります。\n\nあとは、`@nuxt/types`が提供する`Context`型を`context`へ指定することで型安全にコーディングできるようになります。\n\n```ts\nimport { Context } from '@nuxt/types';\nimport { Component, Vue } from 'nuxt-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  /** Lifecycle */\n  async asyncData(context: Context): Promise<void> {\n    const { app, store } = context;\n\n    // プラグインにもアクセスできる！\n    app.$plugin.run();\n\n    // VuexにDispatchできる！\n    await store.dispatch('user/checkAuth');\n  }\n}\n```\n\n## Nuxt 2.8 以前\n\nNuxtとTypeScriptを使う時、`fetch`と`asyncData`の引数 `context` の型がなくて困った経験ありませんか？\n\nNuxtではコアパッケージの1つである`@nuxt/vue-app`というパッケージが `context` の型を提供しています。\n\n```ts\nimport { Context } from '@nuxt/vue-app';\nimport { Component, Vue } from 'nuxt-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  /** Lifecycle */\n  async asyncData(context: Context): Promise<void> {\n    const { app, store } = context;\n\n    // プラグインにもアクセスできる！\n    app.$plugin.run();\n\n    // VuexにDispatchできる！\n    await store.dispatch('user/checkAuth');\n  }\n}\n```\n\nこれで、`context: any`や独自のインターフェースの定義が不要になります。\n\n（ドキュメントのどこにも記載がないのはなぜなんだろうか・・・？）\n",coediting:a,comments_count:0,created_at:"2019-08-08T15:29:46+09:00",group:p,id:"77e074e48d036ce2444b",likes_count:6,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:h,versions:[]}],title:"Nuxt×TypeScriptでfetch, asyncDataの引数に型を指定する",updated_at:"2019-08-27T11:38:34+09:00",url:"https://qiita.com/simochee/items/77e074e48d036ce2444b",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="rscssとは" class="fragment"></span><a href="#rscss%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>RSCSSとは</h1>\n\n<blockquote>\n<p>Styling CSS without losing your sanity</p>\n</blockquote>\n\n<p>正気を保ってCSSを書くためのアイデア。<br>\nルールではないため、シンプルにするためなら無視しても問題ない。</p>\n\n<h1>\n<span id="bemとrscssの比較" class="fragment"></span><a href="#bem%E3%81%A8rscss%E3%81%AE%E6%AF%94%E8%BC%83"><i class="fa fa-link"></i></a>BEMとRSCSSの比較</h1>\n\n<ul>\n<li>命名規則\n\n<ul>\n<li>BEMはBlock、Element、Modifierを一つのクラスに連結する</li>\n<li>RSCSSはそれぞれ単独のクラスとして定義する</li>\n</ul>\n</li>\n<li>親子関係\n\n<ul>\n<li>BEMはBlockとElement、ElementとElementの親子関係は厳密ではない</li>\n<li>RSCSSはすべてのセレクタを親子関係として定義する</li>\n</ul>\n</li>\n<li>ネスト\n\n<ul>\n<li>BEMはネストの制約はない</li>\n<li>RSCSSのネストの深さは必ず１で、コンポーネントからの親子関係で指定する</li>\n</ul>\n</li>\n</ul>\n\n<h1>\n<span id="構成する要素" class="fragment"></span><a href="#%E6%A7%8B%E6%88%90%E3%81%99%E3%82%8B%E8%A6%81%E7%B4%A0"><i class="fa fa-link"></i></a>構成する要素</h1>\n\n<h2>\n<span id="bem" class="fragment"></span><a href="#bem"><i class="fa fa-link"></i></a>BEM</h2>\n\n<ul>\n<li>Block: 単独で意味のあるまとまり</li>\n<li>Element: 単独では意味を持たない、ブロックに結び付けられた要素\n\n<ul>\n<li>クラスを<code>__</code>で接続する</li>\n</ul>\n</li>\n<li>Modifier: ブロックまたはエレメントのフラグ\n\n<ul>\n<li>クラスを<code>--</code>で接続する</li>\n</ul>\n</li>\n</ul>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.product-list</span>\n  <span class="k">&amp;</span><span class="nt">__item</span>\n    <span class="k">&amp;</span><span class="nt">--pickup</span>\n    <span class="k">&amp;</span><span class="nt">__name</span>\n    <span class="k">&amp;</span><span class="nt">__description</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"product-list"</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"product-list__item"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"product-list__item__name"</span><span class="nt">&gt;</span>Product #01<span class="nt">&lt;/h3&gt;</span>\n    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"product-list__item__description"</span><span class="nt">&gt;</span>Lorem ipsum dolor sit amet.<span class="nt">&lt;/p&gt;</span>\n  <span class="nt">&lt;/li&gt;</span>\n  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"product-list__item product-list__item--pickup"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"product-list__item__name"</span><span class="nt">&gt;</span>Product #02 - Pickup!<span class="nt">&lt;/h3&gt;</span>\n    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"product-list__item__description"</span><span class="nt">&gt;</span>Lorem ipsum dolor sit amet.<span class="nt">&lt;/p&gt;</span>\n  <span class="nt">&lt;/li&gt;</span>\n<span class="nt">&lt;/ul&gt;</span>\n</pre></div></div>\n\n<h2>\n<span id="rscss" class="fragment"></span><a href="#rscss"><i class="fa fa-link"></i></a>RSCSS</h2>\n\n<ul>\n<li>Component: BEMでのBlock\n\n<ul>\n<li>クラス名に必ず<code>-</code>を含む<strong>複数単語</strong>で構成する</li>\n</ul>\n</li>\n<li>Element: BEMでのElement\n\n<ul>\n<li>クラス名に<code>-</code>を<strong>含まない</strong>\n</li>\n<li>複数単語の場合でも<code>-</code>や<code>_</code>で連結しない</li>\n<li><strong>Componentからの親子関係で指定する</strong></li>\n<li>ネストは必ず１つ</li>\n</ul>\n</li>\n<li>Variant: BEMでのModifier\n\n<ul>\n<li>クラス名が必ず<code>-</code>で始まる</li>\n</ul>\n</li>\n</ul>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.product-list</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.item</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.item.-pickup</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.item</span> <span class="o">&gt;</span> <span class="nc">.name</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.item</span> <span class="o">&gt;</span> <span class="nc">.description</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;ul</span> <span class="na">class=</span><span class="s">"product-list"</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"item"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"name"</span><span class="nt">&gt;</span>Product #01<span class="nt">&lt;/h3&gt;</span>\n    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"description"</span><span class="nt">&gt;</span>Lorem ipsum dolor sit amet.<span class="nt">&lt;/p&gt;</span>\n  <span class="nt">&lt;/li&gt;</span>\n  <span class="nt">&lt;li</span> <span class="na">class=</span><span class="s">"item -pickup"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;h3</span> <span class="na">class=</span><span class="s">"name"</span><span class="nt">&gt;</span>Product #02 - Pickup!<span class="nt">&lt;/h3&gt;</span>\n    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"description"</span><span class="nt">&gt;</span>Lorem ipsum dolor sit amet.<span class="nt">&lt;/p&gt;</span>\n  <span class="nt">&lt;/li&gt;</span>\n<span class="nt">&lt;/ul&gt;</span>\n</pre></div></div>\n\n<h1>\n<span id="bemにはないrscssの規則" class="fragment"></span><a href="#bem%E3%81%AB%E3%81%AF%E3%81%AA%E3%81%84rscss%E3%81%AE%E8%A6%8F%E5%89%87"><i class="fa fa-link"></i></a>BEMにはないRSCSSの規則</h1>\n\n<h2>\n<span id="レイアウト" class="fragment"></span><a href="#%E3%83%AC%E3%82%A4%E3%82%A2%E3%82%A6%E3%83%88"><i class="fa fa-link"></i></a>レイアウト</h2>\n\n<p>レイアウトに関するプロパティ（<code>position</code>、<code>margin</code>、<code>width</code>など）はコンポーネントに含めず、更に親のコンポーネントクラスを定義してそこで指定するようにします。</p>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.article-list</span>\n  <span class="k">&amp;</span>\n    <span class="nd">+clearfix</span>\n\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.article-card</span>\n    <span class="nl">width</span><span class="p">:</span> <span class="m">33</span><span class="mi">.3%</span>\n    <span class="nl">float</span><span class="p">:</span> <span class="nb">left</span>\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://rscss.io/layouts.html" rel="nofollow noopener" target="_blank">Layout</a></p>\n</blockquote>\n\n<h2>\n<span id="ヘルパークラス" class="fragment"></span><a href="#%E3%83%98%E3%83%AB%E3%83%91%E3%83%BC%E3%82%AF%E3%83%A9%E3%82%B9"><i class="fa fa-link"></i></a>ヘルパークラス</h2>\n\n<p><code>!important</code>を付与し、最優先でスタイルを外付けしたいときに使用するヘルパークラスを定義できます。<br>\nヘルパークラスは必ず<code>_</code>で始めます。</p>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">._unmargin</span>\n  <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span> <span class="o">!</span><span class="n">important</span>\n\n<span class="nc">._hidden-sp</span>\n  <span class="k">@media</span> <span class="p">(</span><span class="nv">$sp</span><span class="p">)</span>\n    <span class="nl">display</span><span class="p">:</span> <span class="nb">none</span> <span class="o">!</span><span class="n">important</span>\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://rscss.io/helpers.html" rel="nofollow noopener" target="_blank">Helpers</a></p>\n</blockquote>\n\n<h2>\n<span id="コンポーネントのネスト" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AE%E3%83%8D%E3%82%B9%E3%83%88"><i class="fa fa-link"></i></a>コンポーネントのネスト</h2>\n\n<p>コンポーネントをネストする必要があるときは以下の２つのガイドラインを参考に簡単かつ疎結合に定義するようにしてください。</p>\n\n<h3>\n<span id="variantを使う" class="fragment"></span><a href="#variant%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>Variantを使う</h3>\n\n<p>コンポーネントをネストさせた際に、子のクラスをコンポーネントで指定するとそのコンポーネント名と密結合なクラスとなっていまします。</p>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.article-header</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.vote-box</span> <span class="o">&gt;</span> <span class="nc">.up</span>\n    <span class="c1">// よくない</span>\n</pre></div></div>\n\n<p>代わりに、Variantで指定するようにしてください。そうすればコンポーネント名の変更や利用場面の自由度があがります。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"article-header"</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"vote-box -highlight"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"up"</span><span class="nt">&gt;</span> ... <span class="nt">&lt;/div&gt;</span>\n  <span class="nt">&lt;/div&gt;</span>\n<span class="nt">&lt;/div&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.article-header</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.-highlight</span> <span class="o">&gt;</span> <span class="nc">.up</span>\n    <span class="c1">// ...</span>\n</pre></div></div>\n\n<h3>\n<span id="プリプロセッサのextendを活用する" class="fragment"></span><a href="#%E3%83%97%E3%83%AA%E3%83%97%E3%83%AD%E3%82%BB%E3%83%83%E3%82%B5%E3%81%AEextend%E3%82%92%E6%B4%BB%E7%94%A8%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>プリプロセッサの<code>@extend</code>を活用する</h3>\n\n<p>コンポーネントをネストさせることでクラス名が複雑になることがあります。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"search-form"</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"input"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>\n  <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"search-button -red -large"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/button&gt;</span>\n<span class="nt">&lt;/div&gt;</span>\n</pre></div></div>\n\n<p>代わりに、Elementと定義した上で<code>@extend</code>を使用すれば簡潔に表現できます。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"search-form"</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"input"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>\n  <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Search<span class="nt">&lt;/button&gt;</span>\n<span class="nt">&lt;/div&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="sass"><div class="highlight"><pre><span class="nc">.search-form</span>\n  <span class="k">&amp;</span> <span class="o">&gt;</span> <span class="nc">.submit</span>\n    <span class="k">@extend</span> <span class="nc">.search-button</span>\n    <span class="k">@extend</span> <span class="nc">.search-button.-red</span>\n    <span class="k">@extend</span> <span class="nc">.search-button.-large</span>\n</pre></div></div>\n\n<h1>\n<span id="クラス名のチェック" class="fragment"></span><a href="#%E3%82%AF%E3%83%A9%E3%82%B9%E5%90%8D%E3%81%AE%E3%83%81%E3%82%A7%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>クラス名のチェック</h1>\n\n<p>Stylelintで<code>stylelint-rscss</code>というルールセットが利用できます。<br>\nこのルールセットでは「コンポーネントに<code>-</code>が含まれていない」とか「親子として指定してよい上限」などといったルールに違反した記述をチェックすることができます。</p>\n\n<blockquote>\n<p><a href="https://github.com/rstacruz/stylelint-rscss" rel="nofollow noopener" target="_blank"><code>stylelint-rscss</code></a></p>\n</blockquote>\n\n<h1>\n<span id="リンク" class="fragment"></span><a href="#%E3%83%AA%E3%83%B3%E3%82%AF"><i class="fa fa-link"></i></a>リンク</h1>\n\n<ul>\n<li><a href="https://rscss.io" rel="nofollow noopener" target="_blank">RSCSS (Official Document)</a></li>\n<li><a href="https://qiita.com/kk6/items/760efba180ec526903db" id="reference-ba8b2b5319cbd15cd47c">日本語ドキュメント</a></li>\n</ul>\n',body:'# RSCSSとは\n\n> Styling CSS without losing your sanity\n\n正気を保ってCSSを書くためのアイデア。\nルールではないため、シンプルにするためなら無視しても問題ない。\n\n# BEMとRSCSSの比較\n\n* 命名規則\n  - BEMはBlock、Element、Modifierを一つのクラスに連結する\n  - RSCSSはそれぞれ単独のクラスとして定義する\n* 親子関係\n  - BEMはBlockとElement、ElementとElementの親子関係は厳密ではない\n  - RSCSSはすべてのセレクタを親子関係として定義する\n* ネスト\n  - BEMはネストの制約はない\n  - RSCSSのネストの深さは必ず１で、コンポーネントからの親子関係で指定する\n\n# 構成する要素\n\n## BEM\n\n* Block: 単独で意味のあるまとまり\n* Element: 単独では意味を持たない、ブロックに結び付けられた要素\n  - クラスを`__`で接続する\n* Modifier: ブロックまたはエレメントのフラグ\n  - クラスを`--`で接続する\n\n```sass\n.product-list\n  &__item\n    &--pickup\n    &__name\n    &__description\n```\n\n```html\n<ul class="product-list">\n  <li class="product-list__item">\n    <h3 class="product-list__item__name">Product #01</h3>\n    <p class="product-list__item__description">Lorem ipsum dolor sit amet.</p>\n  </li>\n  <li class="product-list__item product-list__item--pickup">\n    <h3 class="product-list__item__name">Product #02 - Pickup!</h3>\n    <p class="product-list__item__description">Lorem ipsum dolor sit amet.</p>\n  </li>\n</ul>\n```\n\n## RSCSS\n\n* Component: BEMでのBlock\n  - クラス名に必ず`-`を含む**複数単語**で構成する\n* Element: BEMでのElement\n  - クラス名に`-`を**含まない**\n  - 複数単語の場合でも`-`や`_`で連結しない\n  - **Componentからの親子関係で指定する**\n  - ネストは必ず１つ\n* Variant: BEMでのModifier\n  - クラス名が必ず`-`で始まる\n\n```sass\n.product-list\n  & > .item\n  & > .item.-pickup\n  & > .item > .name\n  & > .item > .description\n```\n\n```html\n<ul class="product-list">\n  <li class="item">\n    <h3 class="name">Product #01</h3>\n    <p class="description">Lorem ipsum dolor sit amet.</p>\n  </li>\n  <li class="item -pickup">\n    <h3 class="name">Product #02 - Pickup!</h3>\n    <p class="description">Lorem ipsum dolor sit amet.</p>\n  </li>\n</ul>\n```\n\n# BEMにはないRSCSSの規則\n\n## レイアウト\n\nレイアウトに関するプロパティ（`position`、`margin`、`width`など）はコンポーネントに含めず、更に親のコンポーネントクラスを定義してそこで指定するようにします。\n\n```sass\n.article-list\n  &\n    +clearfix\n\n  & > .article-card\n    width: 33.3%\n    float: left\n```\n\n> [Layout](https://rscss.io/layouts.html)\n\n## ヘルパークラス\n\n`!important`を付与し、最優先でスタイルを外付けしたいときに使用するヘルパークラスを定義できます。\nヘルパークラスは必ず`_`で始めます。\n\n```sass\n._unmargin\n  margin: 0 !important\n\n._hidden-sp\n  @media ($sp)\n    display: none !important\n```\n\n> [Helpers](https://rscss.io/helpers.html)\n\n## コンポーネントのネスト\n\nコンポーネントをネストする必要があるときは以下の２つのガイドラインを参考に簡単かつ疎結合に定義するようにしてください。\n\n### Variantを使う\n\nコンポーネントをネストさせた際に、子のクラスをコンポーネントで指定するとそのコンポーネント名と密結合なクラスとなっていまします。\n\n```sass\n.article-header\n  & > .vote-box > .up\n    // よくない\n```\n\n代わりに、Variantで指定するようにしてください。そうすればコンポーネント名の変更や利用場面の自由度があがります。\n\n```html\n<div class="article-header">\n  <div class="vote-box -highlight">\n    <div class="up"> ... </div>\n  </div>\n</div>\n```\n\n```sass\n.article-header\n  & > .-highlight > .up\n    // ...\n```\n\n### プリプロセッサの`@extend`を活用する\n\nコンポーネントをネストさせることでクラス名が複雑になることがあります。\n\n```html\n<div class="search-form">\n  <input class="input" type="text" />\n  <button class="search-button -red -large">Search</button>\n</div>\n```\n\n代わりに、Elementと定義した上で`@extend`を使用すれば簡潔に表現できます。\n\n```html\n<div class="search-form">\n  <input class="input" type="text" />\n  <button class="submit">Search</button>\n</div>\n```\n\n```sass\n.search-form\n  & > .submit\n    @extend .search-button\n    @extend .search-button.-red\n    @extend .search-button.-large\n```\n\n# クラス名のチェック\n\nStylelintで`stylelint-rscss`というルールセットが利用できます。\nこのルールセットでは「コンポーネントに`-`が含まれていない」とか「親子として指定してよい上限」などといったルールに違反した記述をチェックすることができます。\n\n> [`stylelint-rscss`](https://github.com/rstacruz/stylelint-rscss)\n\n# リンク\n\n* [RSCSS (Official Document)](https://rscss.io)\n* [日本語ドキュメント](https://qiita.com/kk6/items/760efba180ec526903db)\n',coediting:a,comments_count:0,created_at:"2019-07-26T13:57:37+09:00",group:p,id:"3e537f530ca94ce6fb3a",likes_count:2,private:a,reactions_count:0,tags:[{name:"bem",versions:[]},{name:"rscss",versions:[]}],title:"[BEM to RSCSS] Quick Migration Guide",updated_at:"2019-07-26T15:39:39+09:00",url:"https://qiita.com/simochee/items/3e537f530ca94ce6fb3a",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="作ったもの" class="fragment"></span><a href="#%E4%BD%9C%E3%81%A3%E3%81%9F%E3%82%82%E3%81%AE"><i class="fa fa-link"></i></a>作ったもの</h1>\n\n<p>Vueで値を監視して変更があったらハンドラを発火させる<code>Watch</code>ですが、パスの指定が文字列なので存在しないパスを指定しても誰も怒ってくれません。</p>\n\n<p>そこで、<code>vue-property-decorator</code>の<code>@Watch</code>デコレータ向けにデータへのパスを安全に指定できるライブラリ<code>vuekey</code>を作りました。</p>\n\n<blockquote>\n<p><a href="https://www.npmjs.com/package/@lollipop-onl/vuekey" rel="nofollow noopener" target="_blank">@lollipop-onl/vuekey</a></p>\n</blockquote>\n\n<p>この記事では、簡単に使い方と内部実装についてご紹介します。</p>\n\n<h1>\n<span id="使い方" class="fragment"></span><a href="#%E4%BD%BF%E3%81%84%E6%96%B9"><i class="fa fa-link"></i></a>使い方</h1>\n\n<h2>\n<span id="インストール" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>インストール</h2>\n\n<p>まずは、<a href="https://www.npmjs.com/package/@lollipop-onl/vuekey" rel="nofollow noopener" target="_blank"><code>@lollipop-onl/vuekey</code></a>をインストールしてください。</p>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre><span class="nv">$ </span>npm i <span class="nt">--save</span> @lollipop-onl/vuekey\n<span class="c"># or </span>\n<span class="nv">$ </span>yarn add @lollipop-onl/vuekey\n</pre></div></div>\n\n<h2>\n<span id="vueファイル内でセットアップ" class="fragment"></span><a href="#vue%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E5%86%85%E3%81%A7%E3%82%BB%E3%83%83%E3%83%88%E3%82%A2%E3%83%83%E3%83%97"><i class="fa fa-link"></i></a>Vueファイル内でセットアップ</h2>\n\n<p><code>vuekey</code>では<code>setupVuekey</code>という関数を提供しています。</p>\n\n<p>この関数のGenericとしてVueクラスを渡すと、そのクラス内で有効なパラメータへのパスを検証することができます。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">setupVuekey</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@lollipop-onl/vuekey</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// vuekeyのセットアップ</span>\n<span class="kd">const</span> <span class="nx">vuekey</span> <span class="o">=</span> <span class="nx">setupVuekey</span><span class="o">&lt;</span><span class="nx">SampleComponent</span><span class="o">&gt;</span><span class="p">();</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{}</span>\n</pre></div></div>\n\n<h2>\n<span id="vuekeyでパスを指定" class="fragment"></span><a href="#vuekey%E3%81%A7%E3%83%91%E3%82%B9%E3%82%92%E6%8C%87%E5%AE%9A"><i class="fa fa-link"></i></a><code>vuekey</code>でパスを指定</h2>\n\n<p><code>vuekey(&lt;key&gt;, &lt;key&gt;, ...)</code>とパラメータのキーを指定していきます。最大10個ネストしたパラメータまでを検証できます。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Watch</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">setupVuekey</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@lollipop-onl/vuekey</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// vuekeyのセットアップ</span>\n<span class="kd">const</span> <span class="nx">vuekey</span> <span class="o">=</span> <span class="nx">setupVuekey</span><span class="o">&lt;</span><span class="nx">SampleComponent</span><span class="o">&gt;</span><span class="p">();</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nl">profile</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n    <span class="nx">age</span><span class="p">?:</span> <span class="nx">number</span><span class="p">;</span>\n    <span class="nl">works</span><span class="p">:</span> <span class="nx">IWark</span><span class="p">[];</span>\n    <span class="nl">updatedAt</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>\n  <span class="p">};</span>\n\n  <span class="c1">// プロフィールが変更されたらタイムスタンプを更新する</span>\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="nx">vuekey</span><span class="p">(</span><span class="dl">\'</span><span class="s1">profile</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">name</span><span class="dl">\'</span><span class="p">),</span> <span class="p">{</span> <span class="na">immediate</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="nx">vuekey</span><span class="p">(</span><span class="dl">\'</span><span class="s1">profile</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">age</span><span class="dl">\'</span><span class="p">))</span>\n  <span class="nx">onChangeProfile</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">$set</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">profile</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">updatedAt</span><span class="dl">\'</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">());</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>これで、存在しないパラメータキーを指定しようとしたらエラーとなります。</p>\n\n<h2>\n<span id="vmsetもタイプセーフにする" class="fragment"></span><a href="#vmset%E3%82%82%E3%82%BF%E3%82%A4%E3%83%97%E3%82%BB%E3%83%BC%E3%83%95%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a><code>vm.$set</code>もタイプセーフにする</h2>\n\n<p><code>this.$set</code>はオブジェクトや配列の要素をリアクティブに変更するためのビルトインメソッドですが、第2引数、第3引数は方に縛られていません。</p>\n\n<p>ここも存在するキー、代入可能な型かどうかを検証させる機能を<code>vuekey</code>に持たせています。</p>\n\n<p>先程のプロフィールのタイムスタンプを更新する例は以下のように変更できます。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Watch</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">setupVuekey</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@lollipop-onl/vuekey</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// vuekeyのセットアップ</span>\n<span class="kd">const</span> <span class="nx">vuekey</span> <span class="o">=</span> <span class="nx">setupVuekey</span><span class="o">&lt;</span><span class="nx">SampleComponent</span><span class="o">&gt;</span><span class="p">();</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nl">profile</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n    <span class="nx">age</span><span class="p">?:</span> <span class="nx">number</span><span class="p">;</span>\n    <span class="nl">works</span><span class="p">:</span> <span class="nx">IWark</span><span class="p">[];</span>\n    <span class="nl">updatedAt</span><span class="p">:</span> <span class="nx">number</span><span class="p">;</span>\n  <span class="p">};</span>\n\n  <span class="c1">// プロフィールが変更されたらタイムスタンプを更新する</span>\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="nx">vuekey</span><span class="p">(</span><span class="dl">\'</span><span class="s1">profile</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">name</span><span class="dl">\'</span><span class="p">),</span> <span class="p">{</span> <span class="na">immediate</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="nx">vuekey</span><span class="p">(</span><span class="dl">\'</span><span class="s1">profile</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">age</span><span class="dl">\'</span><span class="p">))</span>\n  <span class="nx">onChangeProfile</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">$set</span><span class="p">(...</span><span class="nx">vuekey</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">profile</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">updatedAt</span><span class="dl">\'</span><span class="p">,</span> <span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()));</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>これで、<code>this.profile</code>の型定義に存在しないプロパティの指定や、不正な型の代入を防ぐことができます。</p>\n\n<p>Vueで文字列だからとおざなりになりがちなところですが、型安全にして平和にいきましょう！</p>\n\n<h1>\n<span id="実装のこと" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85%E3%81%AE%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>実装のこと</h1>\n\n<p>ここからは、<code>vuekey</code>を作るにあたって困った点を備忘録として残します。<br>\n同じ轍を踏む人が一人でも減りますように...</p>\n\n<blockquote>\n<p><a href="https://gitlab.com/lollipop.onl/vuekey/blob/master/index.ts" rel="nofollow noopener" target="_blank">ソースコード</a></p>\n</blockquote>\n\n<h2>\n<span id="前の引数で指定したプロパティの持つキーのみを続く引数で指定させる" class="fragment"></span><a href="#%E5%89%8D%E3%81%AE%E5%BC%95%E6%95%B0%E3%81%A7%E6%8C%87%E5%AE%9A%E3%81%97%E3%81%9F%E3%83%97%E3%83%AD%E3%83%91%E3%83%86%E3%82%A3%E3%81%AE%E6%8C%81%E3%81%A4%E3%82%AD%E3%83%BC%E3%81%AE%E3%81%BF%E3%82%92%E7%B6%9A%E3%81%8F%E5%BC%95%E6%95%B0%E3%81%A7%E6%8C%87%E5%AE%9A%E3%81%95%E3%81%9B%E3%82%8B"><i class="fa fa-link"></i></a>前の引数で指定したプロパティの持つキーのみを続く引数で指定させる</h2>\n\n<p><code>vuekey</code>では、第1引数で指定したパラメータのキーを第2引数の型とするような機能が必要でした。</p>\n\n<p>当初は</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// vuekey&lt;V extends Vue&gt;は省略しています</span>\n\n<span class="kd">function</span> <span class="nx">vuekey</span><span class="o">&lt;</span><span class="nx">V</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">t1</span><span class="p">?:</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">,</span> <span class="nx">t2</span><span class="p">?:</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">[</span><span class="k">typeof</span> <span class="nx">t1</span><span class="p">],</span> <span class="nx">t3</span><span class="p">:</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">[</span><span class="k">typeof</span> <span class="nx">t1</span><span class="p">][</span><span class="k">typeof</span> <span class="nx">t2</span><span class="p">],</span> <span class="p">...)</span>\n</pre></div></div>\n\n<p>のように、前の引数の型を後半でも参照するようにしていました。</p>\n\n<p>しかし、この実装では前半の型は確定しなかったため没になりました。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">function</span> <span class="nx">vuekey</span><span class="o">&lt;</span><span class="nx">V</span><span class="o">&gt;</span><span class="p">(</span><span class="nx">t1</span><span class="p">?:</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">,</span> <span class="nx">t2</span><span class="p">?:</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">[</span><span class="k">typeof</span> <span class="nx">t1</span><span class="p">]</span> <span class="c1">// typeof t1が確定していないのでV[typeof t1]がneverになった</span>\n</pre></div></div>\n\n<p>そこで、インターフェースのジェネリックで内部状態（？）として型を指定するようにしました。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kr">interface</span> <span class="nx">Vuekey</span><span class="o">&lt;</span><span class="nx">V</span> <span class="kd">extends</span> <span class="nx">Vue</span><span class="o">&gt;</span> <span class="p">{</span>\n  <span class="o">&lt;</span>\n    <span class="nx">T1</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">,</span>\n    <span class="nx">T2</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">[</span><span class="nx">T1</span><span class="p">],</span>\n    <span class="nx">T3</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">V</span><span class="p">[</span><span class="nx">T1</span><span class="p">][</span><span class="nx">T2</span><span class="p">]</span>\n  <span class="o">&gt;</span><span class="p">(</span><span class="nx">t1</span><span class="p">?:</span> <span class="nx">T1</span><span class="p">,</span> <span class="nx">t2</span><span class="p">?:</span> <span class="nx">T2</span><span class="p">,</span> <span class="nx">t3</span><span class="p">?:</span> <span class="nx">T3</span><span class="p">):</span> <span class="nx">string</span><span class="p">;</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<p>こうすることで、<code>T2</code>での<code>T1</code>は実際に指定された定数値を参照することができました。</p>\n\n<h2>\n<span id="nullableなオブジェクトでのkeyof" class="fragment"></span><a href="#nullable%E3%81%AA%E3%82%AA%E3%83%96%E3%82%B8%E3%82%A7%E3%82%AF%E3%83%88%E3%81%A7%E3%81%AEkeyof"><i class="fa fa-link"></i></a>Nullableなオブジェクトでの<code>keyof</code>\n</h2>\n\n<p>任意のクラスメンバーは<code>| undefined</code>となりますが、このような値に対して<code>keyof</code>すると<code>never</code>が返されてしまいます。</p>\n\n<p>任意のパラメータを除去するには<code>Required</code>というビルトインの型を使用します。</p>\n\n<p>さて、任意のパラメータがネストする場合はどうすればよいでしょうか？おそらく<code>DeepRequired</code>みたいな型を作れば良いと思います。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">DeepRequired</span><span class="o">&lt;</span><span class="nx">T</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">T</span> <span class="kd">extends</span> <span class="nx">object</span>\n  <span class="p">?</span> <span class="p">{</span> <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="nx">keyof</span> <span class="nx">T</span><span class="p">]</span><span class="o">-</span><span class="p">?:</span> <span class="nx">DeepRequired</span><span class="o">&lt;</span><span class="nx">T</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span> <span class="p">}</span>\n  <span class="p">:</span> <span class="nx">T</span><span class="p">;</span>\n</pre></div></div>\n\n<p>ただし、<code>vuekey</code>の場合は事情が違います。<code>vuekey</code>では、<code>T</code>にあたる型の親のパラメータが任意である可能性があり、<code>DeepRequired</code>は利用できませんでした。</p>\n\n<p>そこですべての型を<code>Required</code>でラップするという手段で実装を行っています。</p>\n\n<blockquote>\n<p><a href="https://gitlab.com/lollipop.onl/vuekey/blob/master/index.ts#L28" rel="nofollow noopener" target="_blank">該当箇所</a></p>\n</blockquote>\n\n<p>もっと良い方法があればコメントで教えていただきたいです！</p>\n',body:"# 作ったもの\n\nVueで値を監視して変更があったらハンドラを発火させる`Watch`ですが、パスの指定が文字列なので存在しないパスを指定しても誰も怒ってくれません。\n\nそこで、`vue-property-decorator`の`@Watch`デコレータ向けにデータへのパスを安全に指定できるライブラリ`vuekey`を作りました。\n\n> [@lollipop-onl/vuekey](https://www.npmjs.com/package/@lollipop-onl/vuekey)\n\nこの記事では、簡単に使い方と内部実装についてご紹介します。\n\n# 使い方\n\n## インストール\n\nまずは、[`@lollipop-onl/vuekey`](https://www.npmjs.com/package/@lollipop-onl/vuekey)をインストールしてください。\n\n```sh\n$ npm i --save @lollipop-onl/vuekey\n# or \n$ yarn add @lollipop-onl/vuekey\n```\n\n## Vueファイル内でセットアップ\n\n`vuekey`では`setupVuekey`という関数を提供しています。\n\nこの関数のGenericとしてVueクラスを渡すと、そのクラス内で有効なパラメータへのパスを検証することができます。\n\n```ts\nimport { Component, Vue } from 'vue-property-decorator';\nimport { setupVuekey } from '@lollipop-onl/vuekey';\n\n// vuekeyのセットアップ\nconst vuekey = setupVuekey<SampleComponent>();\n\n@Component\nexport default class SampleComponent extends Vue {}\n```\n\n## `vuekey`でパスを指定\n\n`vuekey(<key>, <key>, ...)`とパラメータのキーを指定していきます。最大10個ネストしたパラメータまでを検証できます。\n\n```ts\nimport { Component, Watch, Vue } from 'vue-property-decorator';\nimport { setupVuekey } from '@lollipop-onl/vuekey';\n\n// vuekeyのセットアップ\nconst vuekey = setupVuekey<SampleComponent>();\n\n@Component\nexport default class SampleComponent extends Vue {\n  profile: {\n    name: string;\n    age?: number;\n    works: IWark[];\n    updatedAt: number;\n  };\n\n  // プロフィールが変更されたらタイムスタンプを更新する\n  @Watch(vuekey('profile', 'name'), { immediate: true })\n  @Watch(vuekey('profile', 'age'))\n  onChangeProfile() {\n    this.$set(this.profile, 'updatedAt', Date.now());\n  }\n}\n```\n\nこれで、存在しないパラメータキーを指定しようとしたらエラーとなります。\n\n## `vm.$set`もタイプセーフにする\n\n`this.$set`はオブジェクトや配列の要素をリアクティブに変更するためのビルトインメソッドですが、第2引数、第3引数は方に縛られていません。\n\nここも存在するキー、代入可能な型かどうかを検証させる機能を`vuekey`に持たせています。\n\n先程のプロフィールのタイムスタンプを更新する例は以下のように変更できます。\n\n```ts\nimport { Component, Watch, Vue } from 'vue-property-decorator';\nimport { setupVuekey } from '@lollipop-onl/vuekey';\n\n// vuekeyのセットアップ\nconst vuekey = setupVuekey<SampleComponent>();\n\n@Component\nexport default class SampleComponent extends Vue {\n  profile: {\n    name: string;\n    age?: number;\n    works: IWark[];\n    updatedAt: number;\n  };\n\n  // プロフィールが変更されたらタイムスタンプを更新する\n  @Watch(vuekey('profile', 'name'), { immediate: true })\n  @Watch(vuekey('profile', 'age'))\n  onChangeProfile() {\n    this.$set(...vuekey(this.profile, 'updatedAt', Date.now()));\n  }\n}\n```\n\nこれで、`this.profile`の型定義に存在しないプロパティの指定や、不正な型の代入を防ぐことができます。\n\nVueで文字列だからとおざなりになりがちなところですが、型安全にして平和にいきましょう！\n\n# 実装のこと\n\nここからは、`vuekey`を作るにあたって困った点を備忘録として残します。\n同じ轍を踏む人が一人でも減りますように...\n\n> [ソースコード](https://gitlab.com/lollipop.onl/vuekey/blob/master/index.ts)\n\n## 前の引数で指定したプロパティの持つキーのみを続く引数で指定させる\n\n`vuekey`では、第1引数で指定したパラメータのキーを第2引数の型とするような機能が必要でした。\n\n当初は\n\n```ts\n// vuekey<V extends Vue>は省略しています\n\nfunction vuekey<V>(t1?: keyof V, t2?: keyof V[typeof t1], t3: keyof V[typeof t1][typeof t2], ...)\n```\n\nのように、前の引数の型を後半でも参照するようにしていました。\n\nしかし、この実装では前半の型は確定しなかったため没になりました。\n\n```ts\nfunction vuekey<V>(t1?: keyof V, t2?: keyof V[typeof t1] // typeof t1が確定していないのでV[typeof t1]がneverになった\n```\n\nそこで、インターフェースのジェネリックで内部状態（？）として型を指定するようにしました。\n\n```ts\ninterface Vuekey<V extends Vue> {\n  <\n    T1 extends keyof V,\n    T2 extends keyof V[T1],\n    T3 extends keyof V[T1][T2]\n  >(t1?: T1, t2?: T2, t3?: T3): string;\n}\n```\n\nこうすることで、`T2`での`T1`は実際に指定された定数値を参照することができました。\n\n## Nullableなオブジェクトでの`keyof`\n\n任意のクラスメンバーは` | undefined`となりますが、このような値に対して`keyof`すると`never`が返されてしまいます。\n\n任意のパラメータを除去するには`Required`というビルトインの型を使用します。\n\nさて、任意のパラメータがネストする場合はどうすればよいでしょうか？おそらく`DeepRequired`みたいな型を作れば良いと思います。\n\n```ts\ntype DeepRequired<T> = T extends object\n  ? { [K in keyof T]-?: DeepRequired<T[K]> }\n  : T;\n```\n\nただし、`vuekey`の場合は事情が違います。`vuekey`では、`T`にあたる型の親のパラメータが任意である可能性があり、`DeepRequired`は利用できませんでした。\n\nそこですべての型を`Required`でラップするという手段で実装を行っています。\n\n> [該当箇所](https://gitlab.com/lollipop.onl/vuekey/blob/master/index.ts#L28)\n\nもっと良い方法があればコメントで教えていただきたいです！\n",coediting:a,comments_count:0,created_at:k,group:p,id:"a8057324e1d557cc7ffd",likes_count:0,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:g,versions:[]},{name:E,versions:[]}],title:"VueでWatch対象のパスを安全に指定できるライブラリ vuekey を作った",updated_at:k,url:"https://qiita.com/simochee/items/a8057324e1d557cc7ffd",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>この記事はVueを勉強している段階からTypeScriptでクラスベースのVueアプリを作りたい！という方へ向けて例を交えながら<a href="https://github.com/kaorun343/vue-property-decorator" rel="nofollow noopener" target="_blank"><code>vue-property-decorator</code></a>の機能を<strong>基本</strong>と<strong>応用</strong>、<strong>上級</strong>の３セクションに分けて説明していきます。</p>\n\n<p>基本では、Vueでアプリを作る上で必須となる機能を、応用では用意されている便利なデコレータを、上級では普通の開発ではほぼ使わない機能について説明します。<br>\nとりあえずは基本のみ理解しておけば困ることはないでしょう。</p>\n\n<h2>\n<span id="動作確認バージョン" class="fragment"></span><a href="#%E5%8B%95%E4%BD%9C%E7%A2%BA%E8%AA%8D%E3%83%90%E3%83%BC%E3%82%B8%E3%83%A7%E3%83%B3"><i class="fa fa-link"></i></a>動作確認バージョン</h2>\n\n<p><a href="https://github.com/kaorun343/vue-property-decorator/tree/v8.3.0" rel="nofollow noopener" target="_blank"><code>vue-property-decorator v8.3.0</code></a></p>\n\n<h2>\n<span id="基本" class="fragment"></span><a href="#%E5%9F%BA%E6%9C%AC"><i class="fa fa-link"></i></a>基本</h2>\n\n<h3>\n<span id="コンポーネントの定義" class="fragment"></span><a href="#%E3%82%B3%E3%83%B3%E3%83%9D%E3%83%BC%E3%83%8D%E3%83%B3%E3%83%88%E3%81%AE%E5%AE%9A%E7%BE%A9"><i class="fa fa-link"></i></a>コンポーネントの定義</h3>\n\n<p><code>@Component</code>は続けて定義しているクラスをVueが認識できる形式に変換しています。</p>\n\n<p>以下の２つは同じ意味です。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="na">name</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">SampleComponent</span><span class="dl">\'</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>この時、<code>vue-property-decorator</code>の<code>Vue</code>クラスを継承することを忘れないように気をつけてください。</p>\n\n<h3>\n<span id="data" class="fragment"></span><a href="#data"><i class="fa fa-link"></i></a>Data</h3>\n\n<p>Dataはクラスのメンバーとして定義するだけで利用できます。</p>\n\n<p>以下のサンプルでは名前と年齢をDataに持たせています。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>\n<span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="p">{</span>\n      <span class="na">name</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="na">age</span><span class="p">:</span> <span class="mi">21</span>\n    <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">name</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">;</span>\n  <span class="nx">age</span> <span class="o">=</span> <span class="mi">21</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>Dataをテンプレート内で使用するときはプレーンなVueと同じように参照できます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="c">&lt;!-- simochee (21) --&gt;</span>\n  <span class="nt">&lt;p&gt;</span><span class="si">{{</span><span class="nx">name</span><span class="si">}}</span> (<span class="si">{{</span><span class="nx">age</span><span class="si">}}</span>)<span class="nt">&lt;/p&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="computed" class="fragment"></span><a href="#computed"><i class="fa fa-link"></i></a>Computed</h3>\n\n<p>算出プロパティ（Computed）はクラスのGetterとして定義することで利用できます。</p>\n\n<p>以下のサンプルではDataに定義されたスコアを３倍する算出プロパティを定義しています。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="p">{</span>\n      <span class="na">score</span><span class="p">:</span> <span class="mi">55</span>\n    <span class="p">}</span>\n  <span class="p">},</span>\n  <span class="na">computed</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">triple</span><span class="p">()</span> <span class="p">{</span>\n      <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>\n    <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">score</span> <span class="o">=</span> <span class="mi">55</span><span class="p">;</span>\n\n  <span class="kd">get</span> <span class="nx">triple</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">score</span> <span class="o">*</span> <span class="mi">3</span><span class="p">;</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>Computedをテンプレート内で使用するときはプレーンなVueと同じように参照できます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="c">&lt;!-- Triple score: 163! --&gt;</span>\n  <span class="nt">&lt;p&gt;</span>Triple score: <span class="si">{{</span><span class="nx">triple</span><span class="si">}}</span>!<span class="nt">&lt;/p&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="メソッド" class="fragment"></span><a href="#%E3%83%A1%E3%82%BD%E3%83%83%E3%83%89"><i class="fa fa-link"></i></a>メソッド</h3>\n\n<p>メソッドはクラスのメソッドとして定義するだけで利用することができます。</p>\n\n<p>以下の例では、ボタンが押されたときに<code>onClickButton</code>メソッドを呼び出しています。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;button</span> <span class="err">@</span><span class="na">click=</span><span class="s">"onClickButton"</span><span class="nt">&gt;</span>Click Me!<span class="nt">&lt;/button&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>このようなテンプレートがあったときの<code>onClickButton</code>は以下のように定義できます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">methods</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">onClickButton</span><span class="p">()</span> <span class="p">{</span>\n      <span class="c1">// ボタンが押されたときの処理</span>\n    <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">onClickButton</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// ボタンが押されたときの処理</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>Reactのようにメソッドに<code>this</code>をバインドする必要はありません。</p>\n\n<h3>\n<span id="ライフサイクルフック" class="fragment"></span><a href="#%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>ライフサイクルフック</h3>\n\n<p><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF" rel="nofollow noopener" target="_blank">ライフサイクルフック</a>は、クラスにライフサイクルの名前でメソッドを定義するだけで利用できます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// コンポーネントがマウントされたときの処理</span>\n  <span class="p">},</span>\n  <span class="nx">beforeDestroy</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// コンポーネントが破棄される直前の処理</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// コンポーネントがマウントされたときの処理</span>\n  <span class="p">}</span>\n\n  <span class="nx">beforeDestroy</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// コンポーネントが破棄される直前の処理</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p><code>vue-property-decorator</code>ではライフサイクルフックとメソッドが同じ領域で定義されるため、ライフサイクルの名前でメソッドを定義しないように注意が必要です。</p>\n\n<h3>\n<span id="component" class="fragment"></span><a href="#component"><i class="fa fa-link"></i></a><code>@Component</code>\n</h3>\n\n<p><code>@Component</code>は引数としてVueのオブジェクトを指定することができます。</p>\n\n<p>以降で各種デコレータを紹介しますが、そこで定義できない<code>components</code>や<code>filters</code>、<code>mixins</code>などのプロパティは<code>@Component</code>の引数として指定します。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">components</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">AppButton</span><span class="p">,</span>\n    <span class="nx">ProductList</span>\n  <span class="p">},</span>\n  <span class="nx">directives</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">resize</span>\n  <span class="p">},</span>\n  <span class="nx">filters</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">dateFormat</span>\n  <span class="p">},</span>\n  <span class="nx">mixins</span><span class="p">:</span> <span class="p">[</span>\n    <span class="nx">PageMixin</span>\n  <span class="p">]</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>\n  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">AppButton</span><span class="p">,</span>\n    <span class="nx">ProductList</span>\n  <span class="p">},</span>\n  <span class="na">directives</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">resize</span>\n  <span class="p">},</span>\n  <span class="na">filters</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">dateFormat</span>\n  <span class="p">},</span>\n  <span class="na">mixins</span><span class="p">:</span> <span class="p">[</span>\n    <span class="nx">PageMixin</span>\n  <span class="p">]</span>\n<span class="p">})</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>他にも、以下のドキュメントで紹介されているプロパティを指定できます。</p>\n\n<ul>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%87%E3%83%BC%E3%82%BF" rel="nofollow noopener" target="_blank">オプション / データ</a></li>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-DOM" rel="nofollow noopener" target="_blank">オプション / DOM</a></li>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF" rel="nofollow noopener" target="_blank">オプション / ライフサイクルフック</a></li>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88" rel="nofollow noopener" target="_blank">オプション / アセット</a></li>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E6%A7%8B%E6%88%90" rel="nofollow noopener" target="_blank">オプション / 構成</a></li>\n<li><a href="https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%81%9D%E3%81%AE%E4%BB%96" rel="nofollow noopener" target="_blank">オプション / その他</a></li>\n</ul>\n\n<h3>\n<span id="prop" class="fragment"></span><a href="#prop"><i class="fa fa-link"></i></a><code>@Prop</code>\n</h3>\n\n<p><code>@Prop</code>は続けて定義したメンバーを<code>props</code>として使用できるようにします。</p>\n\n<p>親コンポーネントからは定義したメンバー名で<code>props</code>を指定できます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">props</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">userName</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nl">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>\n      <span class="nx">required</span><span class="p">:</span> <span class="kc">true</span>\n    <span class="p">},</span>\n    <span class="nx">isVisible</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nl">type</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span>\n      <span class="k">default</span><span class="p">:</span> <span class="kc">false</span>\n    <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="nx">userName</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Boolean</span><span class="p">,</span> <span class="na">defualt</span><span class="p">:</span> <span class="kc">false</span> <span class="p">})</span>\n  <span class="nx">isVisible</span><span class="p">:</span> <span class="nx">boolean</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p><code>@Prop</code>の引数には<code>props</code>で指定可能なオプションがすべて指定できます。</p>\n\n<ul>\n<li><a href="https://jp.vuejs.org/v2/api/#props" rel="nofollow noopener" target="_blank">props</a></li>\n</ul>\n\n<h3>\n<span id="watch" class="fragment"></span><a href="#watch"><i class="fa fa-link"></i></a><code>@Watch</code>\n</h3>\n\n<p><code>@Watch</code>は第１引数に監視したい値へのパスを、第２引数にウォッチャのオプションを指定できます。</p>\n\n<p>以下のサンプルでは単一のDataとObjectのプロパティの値を監視するメソッドを定義しています。</p>\n\n<p>なお、<code>immediate: true</code>はコンポーネント初期化時にも処理を実行するかを指定するオプションです。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>\n    <span class="nl">isLoading</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>\n    <span class="nx">profile</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nl">name</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="nx">age</span><span class="p">:</span> <span class="mi">21</span>\n    <span class="p">}</span>\n  <span class="p">},</span>\n  <span class="nx">watch</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">isLoading</span><span class="p">()</span> <span class="p">{</span>\n      <span class="c1">// ローディング状態が切り替わったときの処理</span>\n    <span class="p">},</span>\n    <span class="dl">\'</span><span class="s1">profile.age</span><span class="dl">\'</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nl">handler</span><span class="p">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>\n        <span class="c1">// プロフィールの年齢が変更されたときの処理</span>\n      <span class="p">},</span>\n      <span class="nx">immediate</span><span class="p">:</span> <span class="kc">true</span>\n    <span class="p">}</span> \n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Watch</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">isLoading</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>\n  <span class="nx">profile</span> <span class="o">=</span> <span class="p">{</span>\n    <span class="na">name</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="na">age</span><span class="p">:</span> <span class="mi">21</span>\n  <span class="p">};</span>\n\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">isLoading</span><span class="dl">\'</span><span class="p">)</span>\n  <span class="nx">onChangeLoadingStatus</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// ローディング状態が切り替わったときの処理</span>\n  <span class="p">}</span>\n\n  <span class="p">@</span><span class="nd">Watch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">profile.age</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="na">immediate</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="nx">onChangeProfileAge</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// プロフィールの年齢が変更されたときの処理</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>Vueの仕様からも分かる通り、<code>@Watch</code>は同じパスに対して複数回指定することはできません。<br>\n複数回指定された場合は後勝ちとなるため、先に定義したウォッチャは実行されません。</p>\n\n<h2>\n<span id="応用" class="fragment"></span><a href="#%E5%BF%9C%E7%94%A8"><i class="fa fa-link"></i></a>応用</h2>\n\n<h3>\n<span id="syncprop" class="fragment"></span><a href="#syncprop"><i class="fa fa-link"></i></a><code>@SyncProp</code>\n</h3>\n\n<p>Vue.jsでは<code>props</code>を指定する際に<code>.sync</code>修飾子を付与することで、子コンポーネントから親コンポーネントの値を変更することができるようになります。</p>\n\n<p>仕組みとしては、<code>@update:&lt;Prop名&gt;</code>というイベントを受け取ったらDataに代入するという処理を暗黙的に行っています。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>// 親コンポーネント\n<span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="c">&lt;!-- 以下の２つは同じ意味 --&gt;</span>\n  <span class="nt">&lt;ChildComponent</span>\n<span class="err">　</span>  <span class="na">:childValue.sync=</span><span class="s">"value"</span>\n  <span class="nt">/&gt;</span>\n  <span class="nt">&lt;ChildComponent</span>\n    <span class="na">:childValue=</span><span class="s">"value"</span>\n    <span class="err">@</span><span class="na">update:childValue=</span><span class="s">"value = $event"</span>\n  <span class="nt">/&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>このとき、子コンポーネント以降で<code>.sync</code>プロパティをバケツリレーする際に便利なのが<code>@PropSync</code>デコレータです。</p>\n\n<p>このデコレータを使用しない場合は、以下のように書かなければいけませんでした。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>// 子コンポーネント\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span> <span class="p">})</span>\n  <span class="nx">childValue</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n\n  <span class="c1">// value を変更したいときに呼び出す</span>\n  <span class="nx">updateValue</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="dl">\'</span><span class="s1">update:childValue</span><span class="dl">\'</span><span class="p">,</span> <span class="nx">newValue</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>これが、<code>@PropSync</code>で定義した場合はメンバーへ値を代入するだけで同等の処理を実現することができます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">PropSync</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">PropSync</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span> <span class="p">})</span>\n  <span class="nx">childValue</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n\n  <span class="c1">// value を変更したいときに呼び出す</span>\n  <span class="nx">updateValue</span><span class="p">(</span><span class="nx">newValue</span><span class="p">)</span> <span class="p">{</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">childValue</span> <span class="o">=</span> <span class="nx">newValue</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>代入するだけで値の変更を通知できるため、さらに<code>.sync</code>で孫コンポーネントへ値を渡す場合なども、とてもシンプルに書くことができます。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;SunComponent</span>\n    <span class="na">:sunValue.sync=</span><span class="s">"childValue"</span>\n  <span class="nt">/&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="emit" class="fragment"></span><a href="#emit"><i class="fa fa-link"></i></a><code>@Emit</code>\n</h3>\n\n<p>Vueではコンポーネント間での値を双方向にやり取りすることができます。</p>\n\n<p>親から子への値渡しはPropを指定することで行い、子から親への値渡しはイベントを通知することによってアクションや値を受け渡せるようになっています。</p>\n\n<p>このとき、子から親へ値を渡すときのイベントを発行するのが<code>$emit</code>メソッドです。</p>\n\n<p>以下のサンプルでは子コンポーネントで送信処理が行われたこと<code>submit</code>イベントとして親コンポーネントへ通知し、受け取った値を元に親コンポーネント側でリクエストを送信しています。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>// 子コンポーネント\n<span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;form</span> <span class="err">@</span><span class="na">submit=</span><span class="s">"onSubmit"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;input</span> <span class="na">v-model=</span><span class="s">"value"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>\n  <span class="nt">&lt;/submit&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ChildComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">value</span> <span class="o">=</span> <span class="dl">\'\'</span><span class="p">;</span>\n\n  <span class="c1">// 値を送信する処理</span>\n  <span class="nx">onSubmit</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="dl">\'</span><span class="s1">submit</span><span class="dl">\'</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>// 親コンポーネント\n<span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;ChildComponent</span>\n    <span class="err">@</span><span class="na">submit=</span><span class="s">"onReceiveSubmit"</span>\n  <span class="nt">/&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">ChildComponent</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./ChildComponent.vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>\n  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">ChildComponent</span>\n  <span class="p">}</span>\n<span class="p">})</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ParentComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="k">async</span> <span class="nx">onReceiveSubmit</span><span class="p">(</span><span class="na">newValue</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>\n    <span class="c1">// $emitでの第２引数を受け取ることができる</span>\n    <span class="k">await</span> <span class="k">this</span><span class="p">.</span><span class="nx">$request</span><span class="p">.</span><span class="nx">post</span><span class="p">(</span><span class="nx">newValue</span><span class="p">);</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p><code>@Emit</code>では<code>$emit</code>の処理を事前に定義することができます。</p>\n\n<p>イベント名は<code>@Emit</code>の第１引数に明示的に指定するか、省略した場合は続けて定義しているメソッド名が利用されます。</p>\n\n<p>また、メソッドで値を返却すれば<code>$emit</code>でその値を送ることもできます。</p>\n\n<p>上記のサンプルの子コンポーネントを<code>@Emit</code>で書き換えると以下のようになります。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;form</span> <span class="err">@</span><span class="na">submit=</span><span class="s">"submit"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;input</span> <span class="na">v-model=</span><span class="s">"value"</span><span class="nt">&gt;</span>\n    <span class="nt">&lt;button</span> <span class="na">type=</span><span class="s">"submit"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>\n  <span class="nt">&lt;/submit&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Emit</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ChildComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="nx">value</span> <span class="o">=</span> <span class="dl">\'\'</span><span class="p">;</span>\n\n  <span class="c1">// 値を送信する処理</span>\n  <span class="c1">// イベント名を指定しない場合でも () は省略できない</span>\n  <span class="p">@</span><span class="nd">Emit</span><span class="p">()</span>\n  <span class="nx">submit</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>この他に、<code>@Emit</code>を非同期メソッドへ設定することもできます。</p>\n\n<p>なお、キャメルケースでイベント名、メソッド名を指定した場合、親コンポーネントで受け取る際にはケバブケースへ変換されますので注意が必要です。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre>// 子コンポーネント\n@Emit()\nsubmitForm() {}\n\n// 親コンポーネント\n<span class="nt">&lt;ChildComponent</span>\n  <span class="err">@</span><span class="na">submit-form=</span><span class="s">"onSubmit"</span>\n  <span class="err">@</span><span class="na">submitForm</span><span class="err">"</span><span class="na">onSubmit</span><span class="err">"</span> <span class="err">//</span> <span class="err">発火しない</span>\n<span class="nt">/&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="ref" class="fragment"></span><a href="#ref"><i class="fa fa-link"></i></a><code>@Ref</code>\n</h3>\n\n<p><code>@Ref</code>は<code>$refs</code>で参照できる要素、コンポーネントの型を定義します。<br>\n事前に定義しておくことでタイポや変更へ対応しやすくなります。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">template</span><span class="nt">&gt;</span>\n  <span class="nt">&lt;ChildComponent</span> <span class="na">ref=</span><span class="s">"childComponent"</span> <span class="nt">/&gt;</span>\n  <span class="nt">&lt;button</span> <span class="na">ref=</span><span class="s">"submitButton"</span><span class="nt">&gt;</span>Submit<span class="nt">&lt;/button&gt;</span>\n<span class="nt">&lt;/</span><span class="k">template</span><span class="nt">&gt;</span>\n\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n<span class="k">import</span> <span class="nx">ChildComponent</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@/component/ChildComponent.vue</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span><span class="p">({</span>\n  <span class="na">components</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">ChildComponent</span>\n  <span class="p">}</span>\n<span class="p">});</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Ref</span><span class="p">()</span> <span class="na">childComponent</span><span class="p">:</span> <span class="nx">ChildComponent</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Ref</span><span class="p">()</span> <span class="na">submitButton</span><span class="p">:</span> <span class="nx">HTMLButtonElement</span><span class="p">;</span>\n\n  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// 子コンポーネントのメソッドを実行する</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">childComponent</span><span class="p">.</span><span class="nx">updateValue</span><span class="p">();</span>\n\n    <span class="c1">// ボタンをフォーカスする</span>\n    <span class="k">this</span><span class="p">.</span><span class="nx">submitButton</span><span class="p">.</span><span class="nx">focus</span><span class="p">();</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h2>\n<span id="上級" class="fragment"></span><a href="#%E4%B8%8A%E7%B4%9A"><i class="fa fa-link"></i></a>上級</h2>\n\n<p>以降は上級者向けのため、あまり詳しく記載しません。必要であれば公式ドキュメントなどを参照してください。</p>\n\n<h3>\n<span id="model" class="fragment"></span><a href="#model"><i class="fa fa-link"></i></a><code>@Model</code>\n</h3>\n\n<p>VueのModelを定義します。VueではModelを指定する際にPropも定義しそちらに型情報などを記載しなければいけませんでしたが、デコレータでは<code>@Model</code>に併せて定義できます。</p>\n\n<blockquote>\n<p><a href="https://jp.vuejs.org/v2/api/#model" rel="nofollow noopener" target="_blank">Vue.js公式ドキュメント#model</a></p>\n</blockquote>\n\n<p>以下の２つは同じ意味です。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">props</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">value</span><span class="p">:</span> <span class="p">{</span>\n      <span class="nl">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span>\n      <span class="nx">required</span><span class="p">:</span> <span class="kc">true</span>\n    <span class="p">}</span>\n  <span class="p">},</span>\n  <span class="nx">model</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">prop</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">value</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="nx">event</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">update</span><span class="dl">\'</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Model</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Model</span><span class="p">(</span><span class="dl">\'</span><span class="s1">update</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="nx">value</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>このとき、暗黙的に<code>value</code>がPropとして定義されるため<code>value</code>という<code>data</code>や<code>methods</code>は定義できません。</p>\n\n<h3>\n<span id="provide--inject" class="fragment"></span><a href="#provide--inject"><i class="fa fa-link"></i></a><code>@Provide</code> / <code>@Inject</code>\n</h3>\n\n<p>Vueでは親で<code>provide</code>として定義した値をその子要素（親子でなくても良い）から<code>inject</code>で参照することができます。</p>\n\n<blockquote>\n<p><a href="https://jp.vuejs.org/v2/api/#provide-inject" rel="nofollow noopener" target="_blank">Vue.js公式ドキュメント#inject/provide</a></p>\n</blockquote>\n\n<p>以下の２つは同じ意味です。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="c">&lt;!-- Parent.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">provide</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">foo</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">foo</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="nx">bar</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">bar</span><span class="dl">\'</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n\n<span class="c">&lt;!-- Child.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span><span class="nt">&gt;</span>\n<span class="k">export</span> <span class="nx">deafult</span> <span class="p">{</span>\n  <span class="nl">inject</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nl">foo</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">foo</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="nx">bar</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">bar</span><span class="dl">\'</span><span class="p">,</span>\n    <span class="nx">optional</span><span class="p">:</span> <span class="p">{</span> <span class="nl">from</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">optional</span><span class="dl">\'</span><span class="p">,</span> <span class="k">default</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">default</span><span class="dl">\'</span> <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="c">&lt;!-- Parent.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Provide</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ParentComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Provide</span><span class="p">()</span> <span class="nx">foo</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">foo</span><span class="dl">\'</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Provide</span><span class="p">(</span><span class="dl">\'</span><span class="s1">bar</span><span class="dl">\'</span><span class="p">)</span> <span class="nx">baz</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">bar</span><span class="dl">\'</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n\n<span class="c">&lt;!-- Child.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Inject</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ChildComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Inject</span><span class="p">()</span> <span class="nx">foo</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="dl">\'</span><span class="s1">bar</span><span class="dl">\'</span><span class="p">)</span> <span class="nx">bar</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Inject</span><span class="p">({</span> <span class="na">from</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">optional</span><span class="dl">\'</span><span class="p">,</span> <span class="na">default</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">default</span><span class="dl">\'</span> <span class="p">})</span> <span class="nx">optional</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Inject</span><span class="p">(</span><span class="nx">symbol</span><span class="p">)</span> <span class="nx">baz</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="providereactive--provideinject" class="fragment"></span><a href="#providereactive--provideinject"><i class="fa fa-link"></i></a><code>@ProvideReactive</code> / <code>@ProvideInject</code>\n</h3>\n\n<p><code>@Provide</code> / <code>@Inject</code>の拡張です。親コンポーネントから<code>@ProvideReactive</code>として提供された値の変更を子コンポーネントでキャッチできるようになります。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="c">&lt;!-- Parent.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">ProvideReactive</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ParentComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">ProvideReactive</span><span class="p">()</span> <span class="nx">foo</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">foo</span><span class="dl">\'</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n\n<span class="c">&lt;!-- Child.vue --&gt;</span>\n<span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">InjectReactive</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">ChildComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">InjectReactive</span><span class="p">()</span> <span class="nx">foo</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<h3>\n<span id="readonlyとについて" class="fragment"></span><a href="#readonly%E3%81%A8%E3%81%AB%E3%81%A4%E3%81%84%E3%81%A6"><i class="fa fa-link"></i></a><code>readonly</code>と<code>!</code>、<code>?</code>について</h3>\n\n<p><code>vue-property-decorator</code>のサンプルコードでは<code>readonly</code>や<code>prop!: String</code>のような<code>!</code>が登場しています。</p>\n\n<p>これらはいずれもTypeScriptの機能です。</p>\n\n<p><code>readonly</code>修飾子は、メンバー変数を書き込み専用とするためのものです。<br>\nVueではProp、Modelへの直接の代入はエラーとなります。</p>\n\n<p>誤った代入を事前に防ぐために<code>@Prop</code>および<code>@Model</code>で定義したメンバー変数へは<code>readonly</code>修飾子を付与することをおすすめします。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">,</span> <span class="nx">PropSync</span><span class="p">,</span> <span class="nx">Watch</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span> <span class="p">})</span> <span class="nx">readonly</span> <span class="nx">name</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">Model</span><span class="p">(</span><span class="dl">\'</span><span class="s1">update</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Object</span> <span class="p">})</span> <span class="nx">readonly</span> <span class="nx">profile</span><span class="p">:</span> <span class="nx">IProfile</span><span class="p">;</span>\n  <span class="p">@</span><span class="nd">PropSync</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span> <span class="p">})</span> <span class="nx">value</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span> <span class="c1">// 代入可能</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>また、デコレータで定義されたすべてのメンバー変数についている<code>!</code>は <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html#non-null-assertion-operator" rel="nofollow noopener" target="_blank">NonNullAssertionオペレータ</a> と呼ばれる機能です。<br>\n<code>!</code>がついたプロパティがNull/Undefinedではないことを明示します。</p>\n\n<p>ただし、<code>!</code>は<code>required: true</code>またはデフォルト値が設定されているプロパティにのみ指定することをおすすめします。<br>\n逆に、必須項目でなくデフォルト値も指定されていない場合は、<code>?</code>を指定することをおすすめします。</p>\n\n<p>この<code>?</code>はプロパティが任意項目であり、<code>undefined</code>の可能性があることを明示します。</p>\n\n<div class="code-frame" data-lang="vue"><div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">Component</span><span class="p">,</span> <span class="nx">Prop</span><span class="p">,</span> <span class="nx">Vue</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">vue-property-decorator</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="p">@</span><span class="nd">Component</span>\n<span class="k">export</span> <span class="k">default</span> <span class="kd">class</span> <span class="nx">SampleComponent</span> <span class="kd">extends</span> <span class="nx">Vue</span> <span class="p">{</span>\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">String</span><span class="p">,</span> <span class="na">required</span><span class="p">:</span> <span class="kc">true</span> <span class="p">})</span>\n  <span class="nx">readonly</span> <span class="nx">name</span><span class="o">!</span><span class="p">:</span> <span class="nx">string</span><span class="p">;</span>\n\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Array</span><span class="p">,</span> <span class="na">default</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">[]</span> <span class="p">})</span>\n  <span class="nx">readonly</span> <span class="nx">items</span><span class="o">!</span><span class="p">:</span> <span class="nx">string</span><span class="p">[];</span>\n\n  <span class="p">@</span><span class="nd">Prop</span><span class="p">({</span> <span class="na">type</span><span class="p">:</span> <span class="nb">Object</span> <span class="p">});</span>\n  <span class="nx">readonly</span> <span class="nx">profile</span><span class="p">?:</span> <span class="nx">IProfile</span><span class="p">;</span>\n\n  <span class="nx">mounted</span><span class="p">()</span> <span class="p">{</span>\n    <span class="c1">// undefinedの可能性のあるオブジェクトのプロパティを</span>\n    <span class="c1">// 参照しようとしたのでタイプエラーになる</span>\n    <span class="nx">profile</span><span class="p">.</span><span class="nx">age</span><span class="p">;</span>\n  <span class="p">}</span>\n<span class="p">}</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div></div>\n\n<p>より強固に型安全にしたい場合はこれらに気をつけて開発するようにしてみてください。</p>\n',body:"この記事はVueを勉強している段階からTypeScriptでクラスベースのVueアプリを作りたい！という方へ向けて例を交えながら[`vue-property-decorator`](https://github.com/kaorun343/vue-property-decorator)の機能を**基本**と**応用**、**上級**の３セクションに分けて説明していきます。\n\n基本では、Vueでアプリを作る上で必須となる機能を、応用では用意されている便利なデコレータを、上級では普通の開発ではほぼ使わない機能について説明します。\nとりあえずは基本のみ理解しておけば困ることはないでしょう。\n\n## 動作確認バージョン\n\n[`vue-property-decorator v8.3.0`](https://github.com/kaorun343/vue-property-decorator/tree/v8.3.0)\n\n## 基本\n\n### コンポーネントの定義\n\n`@Component`は続けて定義しているクラスをVueが認識できる形式に変換しています。\n\n以下の２つは同じ意味です。\n\n```vue\n<script>\nexport default {\n  name: 'SampleComponent'\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {}\n<\/script>\n```\n\nこの時、`vue-property-decorator`の`Vue`クラスを継承することを忘れないように気をつけてください。\n\n### Data\n\nDataはクラスのメンバーとして定義するだけで利用できます。\n\n以下のサンプルでは名前と年齢をDataに持たせています。\n\n```vue\n\n<script>\nexport default {\n  data() {\n    return {\n      name: 'simochee',\n      age: 21\n    }\n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  name = 'simochee';\n  age = 21;\n}\n<\/script>\n```\n\nDataをテンプレート内で使用するときはプレーンなVueと同じように参照できます。\n\n```vue\n<template>\n  \x3c!-- simochee (21) --\x3e\n  <p>{{name}} ({{age}})</p>\n</template>\n```\n\n### Computed\n\n算出プロパティ（Computed）はクラスのGetterとして定義することで利用できます。\n\n以下のサンプルではDataに定義されたスコアを３倍する算出プロパティを定義しています。\n\n```vue\n<script>\nexport default {\n  data() {\n    return {\n      score: 55\n    }\n  },\n  computed: {\n    triple() {\n      return this.score * 3;\n    }\n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  score = 55;\n\n  get triple() {\n    return this.score * 3;\n  }\n}\n<\/script>\n```\n\nComputedをテンプレート内で使用するときはプレーンなVueと同じように参照できます。\n\n```vue\n<template>\n  \x3c!-- Triple score: 163! --\x3e\n  <p>Triple score: {{triple}}!</p>\n</template>\n```\n\n### メソッド\n\nメソッドはクラスのメソッドとして定義するだけで利用することができます。\n\n以下の例では、ボタンが押されたときに`onClickButton`メソッドを呼び出しています。\n\n```vue\n<template>\n  <button @click=\"onClickButton\">Click Me!</button>\n</template>\n```\n\nこのようなテンプレートがあったときの`onClickButton`は以下のように定義できます。\n\n```vue\n<script>\nexport deafult {\n  methods: {\n    onClickButton() {\n      // ボタンが押されたときの処理\n    }\n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  onClickButton() {\n    // ボタンが押されたときの処理\n  }\n}\n<\/script>\n```\n\nReactのようにメソッドに`this`をバインドする必要はありません。\n\n### ライフサイクルフック\n\n[ライフサイクルフック](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF)は、クラスにライフサイクルの名前でメソッドを定義するだけで利用できます。\n\n```vue\n<script>\nexport default {\n  mounted() {\n    // コンポーネントがマウントされたときの処理\n  },\n  beforeDestroy() {\n    // コンポーネントが破棄される直前の処理\n  }\n}\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  mounted() {\n    // コンポーネントがマウントされたときの処理\n  }\n\n  beforeDestroy() {\n    // コンポーネントが破棄される直前の処理\n  }\n}\n<\/script>\n```\n\n`vue-property-decorator`ではライフサイクルフックとメソッドが同じ領域で定義されるため、ライフサイクルの名前でメソッドを定義しないように注意が必要です。\n\n### `@Component`\n\n`@Component`は引数としてVueのオブジェクトを指定することができます。\n\n以降で各種デコレータを紹介しますが、そこで定義できない`components`や`filters`、`mixins`などのプロパティは`@Component`の引数として指定します。\n\n```vue\n<script>\nexport deafult {\n  components: {\n    AppButton,\n    ProductList\n  },\n  directives: {\n    resize\n  },\n  filters: {\n    dateFormat\n  },\n  mixins: [\n    PageMixin\n  ]\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component({\n  components: {\n    AppButton,\n    ProductList\n  },\n  directives: {\n    resize\n  },\n  filters: {\n    dateFormat\n  },\n  mixins: [\n    PageMixin\n  ]\n})\nexport default class SampleComponent extends Vue {\n}\n<\/script>\n```\n\n他にも、以下のドキュメントで紹介されているプロパティを指定できます。\n\n* [オプション / データ](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%87%E3%83%BC%E3%82%BF)\n* [オプション / DOM](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-DOM)\n* [オプション / ライフサイクルフック](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%83%A9%E3%82%A4%E3%83%95%E3%82%B5%E3%82%A4%E3%82%AF%E3%83%AB%E3%83%95%E3%83%83%E3%82%AF)\n* [オプション / アセット](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%82%A2%E3%82%BB%E3%83%83%E3%83%88)\n* [オプション / 構成](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E6%A7%8B%E6%88%90)\n* [オプション / その他](https://jp.vuejs.org/v2/api/#%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3-%E3%81%9D%E3%81%AE%E4%BB%96)\n\n### `@Prop`\n\n`@Prop`は続けて定義したメンバーを`props`として使用できるようにします。\n\n親コンポーネントからは定義したメンバー名で`props`を指定できます。\n\n```vue\n<script>\nexport deafult {\n  props: {\n    userName: {\n      type: String,\n      required: true\n    },\n    isVisible: {\n      type: Boolean,\n      default: false\n    }\n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Prop, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @Prop({ type: String, required: true })\n  userName: string;\n\n  @Prop({ type: Boolean, defualt: false })\n  isVisible: boolean;\n}\n<\/script>\n```\n\n`@Prop`の引数には`props`で指定可能なオプションがすべて指定できます。\n\n* [props](https://jp.vuejs.org/v2/api/#props)\n\n### `@Watch`\n\n`@Watch`は第１引数に監視したい値へのパスを、第２引数にウォッチャのオプションを指定できます。\n\n以下のサンプルでは単一のDataとObjectのプロパティの値を監視するメソッドを定義しています。\n\nなお、`immediate: true`はコンポーネント初期化時にも処理を実行するかを指定するオプションです。\n\n```vue\n<script>\nexport deafult {\n  data() {\n    isLoading: false,\n    profile: {\n      name: 'simochee',\n      age: 21\n    }\n  },\n  watch: {\n    isLoading() {\n      // ローディング状態が切り替わったときの処理\n    },\n    'profile.age': {\n      handler: function() {\n        // プロフィールの年齢が変更されたときの処理\n      },\n      immediate: true\n    } \n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Watch, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  isLoading = false;\n  profile = {\n    name: 'simochee',\n    age: 21\n  };\n\n  @Watch('isLoading')\n  onChangeLoadingStatus() {\n    // ローディング状態が切り替わったときの処理\n  }\n\n  @Watch('profile.age', { immediate: true })\n  onChangeProfileAge() {\n    // プロフィールの年齢が変更されたときの処理\n  }\n}\n<\/script>\n```\n\nVueの仕様からも分かる通り、`@Watch`は同じパスに対して複数回指定することはできません。\n複数回指定された場合は後勝ちとなるため、先に定義したウォッチャは実行されません。\n\n## 応用\n\n### `@SyncProp`\n\nVue.jsでは`props`を指定する際に`.sync`修飾子を付与することで、子コンポーネントから親コンポーネントの値を変更することができるようになります。\n\n仕組みとしては、`@update:<Prop名>`というイベントを受け取ったらDataに代入するという処理を暗黙的に行っています。\n\n```vue\n// 親コンポーネント\n<template>\n  \x3c!-- 以下の２つは同じ意味 --\x3e\n  <ChildComponent\n　  :childValue.sync=\"value\"\n  />\n  <ChildComponent\n    :childValue=\"value\"\n    @update:childValue=\"value = $event\"\n  />\n</template>\n```\n\nこのとき、子コンポーネント以降で`.sync`プロパティをバケツリレーする際に便利なのが`@PropSync`デコレータです。\n\nこのデコレータを使用しない場合は、以下のように書かなければいけませんでした。\n\n```vue\n// 子コンポーネント\n<script lang=\"ts\">\nimport { Component, Prop, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @Prop({ type: String })\n  childValue: string;\n\n  // value を変更したいときに呼び出す\n  updateValue(newValue) {\n    this.$emit('update:childValue', newValue);\n  }\n}\n<\/script>\n```\n\nこれが、`@PropSync`で定義した場合はメンバーへ値を代入するだけで同等の処理を実現することができます。\n\n```vue\n<script lang=\"ts\">\nimport { Component, PropSync, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @PropSync({ type: String })\n  childValue: string;\n\n  // value を変更したいときに呼び出す\n  updateValue(newValue) {\n    this.childValue = newValue\n  }\n}\n<\/script>\n```\n\n代入するだけで値の変更を通知できるため、さらに`.sync`で孫コンポーネントへ値を渡す場合なども、とてもシンプルに書くことができます。\n\n```vue\n<template>\n  <SunComponent\n    :sunValue.sync=\"childValue\"\n  />\n</template>\n```\n\n### `@Emit`\n\nVueではコンポーネント間での値を双方向にやり取りすることができます。\n\n親から子への値渡しはPropを指定することで行い、子から親への値渡しはイベントを通知することによってアクションや値を受け渡せるようになっています。\n\nこのとき、子から親へ値を渡すときのイベントを発行するのが`$emit`メソッドです。\n\n以下のサンプルでは子コンポーネントで送信処理が行われたこと`submit`イベントとして親コンポーネントへ通知し、受け取った値を元に親コンポーネント側でリクエストを送信しています。\n\n```vue\n// 子コンポーネント\n<template>\n  <form @submit=\"onSubmit\">\n    <input v-model=\"value\">\n    <button type=\"submit\">Submit</button>\n  </submit>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ChildComponent extends Vue {\n  value = '';\n\n  // 値を送信する処理\n  onSubmit() {\n    this.$emit('submit', this.value);\n  }\n}\n<\/script>\n```\n\n```vue\n// 親コンポーネント\n<template>\n  <ChildComponent\n    @submit=\"onReceiveSubmit\"\n  />\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\nimport ChildComponent from './ChildComponent.vue';\n\n@Component({\n  components: {\n    ChildComponent\n  }\n})\nexport default class ParentComponent extends Vue {\n  async onReceiveSubmit(newValue: string) {\n    // $emitでの第２引数を受け取ることができる\n    await this.$request.post(newValue);\n  }\n}\n<\/script>\n```\n\n`@Emit`では`$emit`の処理を事前に定義することができます。\n\nイベント名は`@Emit`の第１引数に明示的に指定するか、省略した場合は続けて定義しているメソッド名が利用されます。\n\nまた、メソッドで値を返却すれば`$emit`でその値を送ることもできます。\n\n上記のサンプルの子コンポーネントを`@Emit`で書き換えると以下のようになります。\n\n```vue\n<template>\n  <form @submit=\"submit\">\n    <input v-model=\"value\">\n    <button type=\"submit\">Submit</button>\n  </submit>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Emit, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ChildComponent extends Vue {\n  value = '';\n\n  // 値を送信する処理\n  // イベント名を指定しない場合でも () は省略できない\n  @Emit()\n  submit() {\n    return this.value;\n  }\n}\n<\/script>\n```\n\nこの他に、`@Emit`を非同期メソッドへ設定することもできます。\n\nなお、キャメルケースでイベント名、メソッド名を指定した場合、親コンポーネントで受け取る際にはケバブケースへ変換されますので注意が必要です。\n\n```vue\n// 子コンポーネント\n@Emit()\nsubmitForm() {}\n\n// 親コンポーネント\n<ChildComponent\n  @submit-form=\"onSubmit\"\n  @submitForm\"onSubmit\" // 発火しない\n/>\n```\n\n### `@Ref`\n\n`@Ref`は`$refs`で参照できる要素、コンポーネントの型を定義します。\n事前に定義しておくことでタイポや変更へ対応しやすくなります。\n\n```vue\n<template>\n  <ChildComponent ref=\"childComponent\" />\n  <button ref=\"submitButton\">Submit</button>\n</template>\n\n<script lang=\"ts\">\nimport { Component, Vue } from 'vue-property-decorator';\nimport ChildComponent from '@/component/ChildComponent.vue';\n\n@Component({\n  components: {\n    ChildComponent\n  }\n});\nexport default class SampleComponent extends Vue {\n  @Ref() childComponent: ChildComponent;\n  @Ref() submitButton: HTMLButtonElement;\n\n  mounted() {\n    // 子コンポーネントのメソッドを実行する\n    this.childComponent.updateValue();\n\n    // ボタンをフォーカスする\n    this.submitButton.focus();\n  }\n}\n<\/script>\n```\n\n## 上級\n\n以降は上級者向けのため、あまり詳しく記載しません。必要であれば公式ドキュメントなどを参照してください。\n\n### `@Model`\n\nVueのModelを定義します。VueではModelを指定する際にPropも定義しそちらに型情報などを記載しなければいけませんでしたが、デコレータでは`@Model`に併せて定義できます。\n\n> [Vue.js公式ドキュメント#model](https://jp.vuejs.org/v2/api/#model)\n\n以下の２つは同じ意味です。\n\n```vue\n<script>\nexport deafult {\n  props: {\n    value: {\n      type: String,\n      required: true\n    }\n  },\n  model: {\n    prop: 'value',\n    event: 'update'\n  }\n};\n<\/script>\n```\n\n```vue\n<script lang=\"ts\">\nimport { Component, Model, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @Model('update', { type: String, required: true })\n  value: string;\n}\n<\/script>\n```\n\nこのとき、暗黙的に`value`がPropとして定義されるため`value`という`data`や`methods`は定義できません。\n\n### `@Provide` / `@Inject`\n\nVueでは親で`provide`として定義した値をその子要素（親子でなくても良い）から`inject`で参照することができます。\n\n> [Vue.js公式ドキュメント#inject/provide](https://jp.vuejs.org/v2/api/#provide-inject)\n\n以下の２つは同じ意味です。\n\n```vue\n\x3c!-- Parent.vue --\x3e\n<script>\nexport deafult {\n  provide: {\n    foo: 'foo',\n    bar: 'bar'\n  }\n};\n<\/script>\n\n\x3c!-- Child.vue --\x3e\n<script>\nexport deafult {\n  inject: {\n    foo: 'foo',\n    bar: 'bar',\n    optional: { from: 'optional', default: 'default' }\n  }\n};\n<\/script>\n```\n\n```vue\n\x3c!-- Parent.vue --\x3e\n<script lang=\"ts\">\nimport { Component, Provide, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ParentComponent extends Vue {\n  @Provide() foo = 'foo';\n  @Provide('bar') baz = 'bar';\n}\n<\/script>\n\n\x3c!-- Child.vue --\x3e\n<script lang=\"ts\">\nimport { Component, Inject, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ChildComponent extends Vue {\n  @Inject() foo: string;\n  @Inject('bar') bar: string;\n  @Inject({ from: 'optional', default: 'default' }) optional: string;\n  @Inject(symbol) baz: string;\n}\n<\/script>\n```\n\n### `@ProvideReactive` / `@ProvideInject`\n\n`@Provide` / `@Inject`の拡張です。親コンポーネントから`@ProvideReactive`として提供された値の変更を子コンポーネントでキャッチできるようになります。\n\n```vue\n\x3c!-- Parent.vue --\x3e\n<script lang=\"ts\">\nimport { Component, ProvideReactive, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ParentComponent extends Vue {\n  @ProvideReactive() foo = 'foo';\n}\n<\/script>\n\n\x3c!-- Child.vue --\x3e\n<script lang=\"ts\">\nimport { Component, InjectReactive, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class ChildComponent extends Vue {\n  @InjectReactive() foo: string;\n}\n<\/script>\n```\n\n### `readonly`と`!`、`?`について\n\n`vue-property-decorator`のサンプルコードでは`readonly`や`prop!: String`のような`!`が登場しています。\n\nこれらはいずれもTypeScriptの機能です。\n\n`readonly`修飾子は、メンバー変数を書き込み専用とするためのものです。\nVueではProp、Modelへの直接の代入はエラーとなります。\n\n誤った代入を事前に防ぐために`@Prop`および`@Model`で定義したメンバー変数へは`readonly`修飾子を付与することをおすすめします。\n\n```vue\n<script lang=\"ts\">\nimport { Component, Prop, PropSync, Watch, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @Prop({ type: String }) readonly name: string;\n  @Model('update', { type: Object }) readonly profile: IProfile;\n  @PropSync({ type: String }) value: string; // 代入可能\n}\n<\/script>\n```\n\nまた、デコレータで定義されたすべてのメンバー変数についている`!`は [NonNullAssertionオペレータ](https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-0.html#non-null-assertion-operator) と呼ばれる機能です。\n`!`がついたプロパティがNull/Undefinedではないことを明示します。\n\nただし、`!`は`required: true`またはデフォルト値が設定されているプロパティにのみ指定することをおすすめします。\n逆に、必須項目でなくデフォルト値も指定されていない場合は、`?`を指定することをおすすめします。\n\nこの`?`はプロパティが任意項目であり、`undefined`の可能性があることを明示します。\n\n```vue\n<script lang=\"ts\">\nimport { Component, Prop, Vue } from 'vue-property-decorator';\n\n@Component\nexport default class SampleComponent extends Vue {\n  @Prop({ type: String, required: true })\n  readonly name!: string;\n\n  @Prop({ type: Array, default: () => [] })\n  readonly items!: string[];\n\n  @Prop({ type: Object });\n  readonly profile?: IProfile;\n\n  mounted() {\n    // undefinedの可能性のあるオブジェクトのプロパティを\n    // 参照しようとしたのでタイプエラーになる\n    profile.age;\n  }\n}\n<\/script>\n```\n\nより強固に型安全にしたい場合はこれらに気をつけて開発するようにしてみてください。\n",coediting:a,comments_count:0,created_at:"2019-06-27T19:55:13+09:00",group:p,id:"e5b77af4aa36bd0f32e5",likes_count:53,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:g,versions:[]},{name:"vue-class-component",versions:[]},{name:E,versions:[]}],title:"はじめてのvue-property-decorator",updated_at:"2019-10-23T01:57:17+09:00",url:"https://qiita.com/simochee/items/e5b77af4aa36bd0f32e5",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>TypeScriptって魔法ではなく「手法」さえ覚えれば自作するのも夢じゃない。</p>\n\n<blockquote>\n<p>気合の入った成果物： <a href="https://www.npmjs.com/package/@lollipop-onl/vuex-typesafe-helper" rel="nofollow noopener" target="_blank">@lollipop-onl/vuex-typesafe-helper</a></p>\n</blockquote>\n\n<p>（微妙に実装不備アリ）</p>\n\n<h1>\n<span id="demo" class="fragment"></span><a href="#demo"><i class="fa fa-link"></i></a>Demo</h1>\n\n<p>TypeScript Playgroundで動作を確認できます。</p>\n\n<p><a href="http://www.typescriptlang.org/play/#src=const%20actions%20%3D%20%7B%0D%0A%20%20%20%20async%20login(%7B%20commit%20%7D%2C%20payload%3A%20%7B%20id%3A%20string%2C%20password%3A%20string%20%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%2C%0D%0A%20%20%20%20async%20joinRoom(%7B%20commit%20%7D%2C%20payload%3A%20%7B%20roomId%3A%20string%20%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%2C%0D%0A%20%20%20%20async%20leaveRoom(%7B%20commit%20%7D%2C%20payload%3A%20%7B%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%0D%0A%7D%3B%0D%0A%0D%0Atype%20BaseStoreModule%20%3D%20Record%3Cstring%2C%20(...args%3A%20any%5B%5D)%20%3D%3E%20any%3E%3B%0D%0Atype%20Payload%3CF%20extends%20(...args%3A%20any)%20%3D%3E%20any%3E%20%3D%20F%20extends%20(ctx%2C%20payload%3A%20infer%20P)%20%3D%3E%20any%0D%0A%20%20%3F%20P%0D%0A%20%20%3A%20never%3B%0D%0Atype%20DefineActions%3CActions%20extends%20BaseStoreModule%3E%20%3D%20%7B%0D%0A%20%20%3CK%20extends%20keyof%20Actions%3E(type%3A%20K%2C%20payload%3A%20Payload%3CActions%5BK%5D%3E)%3A%20ReturnType%3CActions%5BK%5D%3E%3B%0D%0A%7D%3B%0D%0A%0D%0Atype%20Dispatch%20%3D%20DefineActions%3Ctypeof%20actions%3E%3B%0D%0A%0D%0Adeclare%20var%20dispatch%3A%20Dispatch%3B%0D%0A%0D%0Adispatch(\'login\'%2C%20%7B%20id%3A%20\'simochee\'%2C%20password%3A%20\'abcd1234\'%20%7D)%3B%0D%0Adispatch(\'logout\'%2C%20%7B%7D)%3B%0D%0Adispatch(\'joinRoom\'%2C%20%7B%20roomId%3A%20100%20%7D)%3B%0D%0A" rel="nofollow noopener" target="_blank">Demo</a></p>\n\n<h1>\n<span id="開発環境" class="fragment"></span><a href="#%E9%96%8B%E7%99%BA%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>開発環境</h1>\n\n<p>IDE (VS Code)</p>\n\n<h1>\n<span id="デバッグ方法" class="fragment"></span><a href="#%E3%83%87%E3%83%90%E3%83%83%E3%82%B0%E6%96%B9%E6%B3%95"><i class="fa fa-link"></i></a>デバッグ方法</h1>\n\n<p>IDEでの型推論</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">declare</span> <span class="kd">var</span> <span class="nx">dispatch</span><span class="p">:</span> <span class="nx">Dispatch</span><span class="p">;</span>\n\n<span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">login</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">abcd1234</span><span class="dl">\'</span> <span class="p">});</span>\n</pre></div></div>\n\n<h1>\n<span id="vuexのactionをタイプセーフにする" class="fragment"></span><a href="#vuex%E3%81%AEaction%E3%82%92%E3%82%BF%E3%82%A4%E3%83%97%E3%82%BB%E3%83%BC%E3%83%95%E3%81%AB%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>VuexのActionをタイプセーフにする</h1>\n\n<h2>\n<span id="やりたいこと" class="fragment"></span><a href="#%E3%82%84%E3%82%8A%E3%81%9F%E3%81%84%E3%81%93%E3%81%A8"><i class="fa fa-link"></i></a>やりたいこと</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// store/chat.ts</span>\n<span class="kd">const</span> <span class="nx">actions</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="nx">login</span><span class="p">({</span> <span class="nx">commit</span> <span class="p">},</span> <span class="na">payload</span><span class="p">:</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="nx">string</span> <span class="p">}):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">boolean</span><span class="o">&gt;</span> <span class="p">{},</span>\n  <span class="nx">joinRoom</span><span class="p">({</span> <span class="nx">commit</span> <span class="p">},</span> <span class="na">payload</span><span class="p">:</span> <span class="p">{</span> <span class="na">roomId</span><span class="p">:</span> <span class="nx">string</span> <span class="p">}):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span> <span class="p">{},</span>\n  <span class="nx">leaveRoom</span><span class="p">({</span> <span class="nx">commit</span> <span class="p">},</span> <span class="na">payload</span><span class="p">:</span> <span class="p">{}):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span>\n<span class="p">};</span>\n\n<span class="nx">type</span> <span class="nx">Dispatch</span> <span class="o">=</span> <span class="nx">DefineAction</span><span class="o">&lt;</span><span class="k">typeof</span> <span class="nx">actions</span><span class="p">,</span> <span class="p">{</span>\n  <span class="dl">\'</span><span class="s1">chat/login</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">login</span><span class="dl">\'</span><span class="p">,</span>\n  <span class="dl">\'</span><span class="s1">chat/joinRoom</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">joinRoom</span><span class="dl">\'</span><span class="p">,</span>\n  <span class="dl">\'</span><span class="s1">chat/leaveRoom</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">leaveRoom</span><span class="dl">\'</span>\n<span class="p">}</span><span class="o">&gt;</span><span class="p">;</span>\n</pre></div></div>\n\n<p>と定義したものを</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">chat/login</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="na">id</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">simochee</span><span class="dl">\'</span><span class="p">,</span> <span class="na">password</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">abcd1234</span><span class="dl">\'</span> <span class="p">});</span> <span class="c1">// returns Promise&lt;boolean&gt;</span>\n<span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">chat/joinRoom</span><span class="dl">\'</span><span class="p">,</span> <span class="p">{</span> <span class="p">});</span> <span class="c1">// payload error!</span>\n<span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">chat/leave</span><span class="dl">\'</span><span class="p">);</span> <span class="c1">// action name type error!</span>\n</pre></div></div>\n\n<p>みたく使えるよう正しいアクション名にマッピングするような<code>DefineActions</code>の定義を行う。</p>\n\n<h2>\n<span id="実装方針" class="fragment"></span><a href="#%E5%AE%9F%E8%A3%85%E6%96%B9%E9%87%9D"><i class="fa fa-link"></i></a>実装方針</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">Dispatch</span><span class="o">=</span> <span class="nx">DefineAction</span><span class="o">&lt;</span><span class="k">typeof</span> <span class="nx">actions</span><span class="p">,</span> <span class="p">{</span>\n  <span class="dl">\'</span><span class="s1">login</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">chat/login</span><span class="dl">\'</span><span class="p">,</span>\n  <span class="dl">\'</span><span class="s1">joinRoom</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">chat/joinRoom</span><span class="dl">\'</span><span class="p">,</span>\n  <span class="dl">\'</span><span class="s1">leaveRoom</span><span class="dl">\'</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">chat/leaveRoom</span><span class="dl">\'</span>\n<span class="p">};</span>\n</pre></div></div>\n\n<p>ジェネリクスでアクションオブジェクトの型とマッピングするイベント名のペアを渡す。</p>\n\n<h5>\n<span id="ジェネリック" class="fragment"></span><a href="#%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF"><i class="fa fa-link"></i></a>ジェネリック</h5>\n\n<p>関数の型（超適当）</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// 基本的には &lt;&gt; の中に名前を入れていく</span>\n<span class="nx">type</span> <span class="nx">PickValue</span><span class="o">&lt;</span><span class="nx">Obj</span><span class="p">,</span> <span class="nx">Key</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">[</span><span class="nx">Key</span><span class="p">];</span>\n<span class="c1">// extends を使うとジェネリックの型を指定できる</span>\n<span class="nx">type</span> <span class="nx">PickValue</span><span class="o">&lt;</span><span class="nx">Obj</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">Key</span> <span class="kd">extends</span> <span class="nx">string</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">[</span><span class="nx">Key</span><span class="p">];</span>\n<span class="c1">// = を使うと初期値を設定できる。ただし、型は確定しない</span>\n<span class="c1">// 初期値が設定されている場合のみ、ジェネリックの指定を省略できる</span>\n<span class="nx">type</span> <span class="nx">PickValue</span><span class="o">&lt;</span><span class="nx">Obj</span> <span class="kd">extends</span> <span class="nx">object</span><span class="p">,</span> <span class="nx">Key</span> <span class="o">=</span> <span class="dl">\'</span><span class="s1">default</span><span class="dl">\'</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">Obj</span><span class="p">[</span><span class="nx">Key</span><span class="p">];</span>\n</pre></div></div>\n\n<h5>\n<span id="typeof" class="fragment"></span><a href="#typeof"><i class="fa fa-link"></i></a>typeof</h5>\n\n<p>JavaScriptの世界の値を型の世界の値に変換する。<br>\nただし、JavaScriptでの<code>typeof</code>とはちょっと挙動が違う。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">obj1</span> <span class="o">=</span> <span class="p">{</span> <span class="na">hello</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">world</span><span class="dl">\'</span> <span class="p">};</span>\n<span class="kd">const</span> <span class="nx">obj2</span><span class="p">:</span> <span class="nx">object</span> <span class="o">=</span> <span class="p">{</span> <span class="na">hello</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">world</span><span class="dl">\'</span> <span class="p">};</span>\n\n<span class="kd">const</span> <span class="nx">objType2</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">obj1</span><span class="p">;</span> <span class="c1">// Object</span>\n<span class="kd">const</span> <span class="nx">objType2</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">obj2</span><span class="p">;</span> <span class="c1">// Object</span>\n\n<span class="nx">type</span> <span class="nx">ObjType1</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">;</span> <span class="c1">// { \'hello\': \'world\' };</span>\n <span class="nx">type</span> <span class="nx">ObjType2</span> <span class="o">=</span> <span class="k">typeof</span> <span class="nx">obj</span><span class="p">;</span> <span class="c1">// object</span>\n</pre></div></div>\n\n<h2>\n<span id="step-1-ベースの型を作る" class="fragment"></span><a href="#step-1-%E3%83%99%E3%83%BC%E3%82%B9%E3%81%AE%E5%9E%8B%E3%82%92%E4%BD%9C%E3%82%8B"><i class="fa fa-link"></i></a>Step 1. ベースの型を作る</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">login</span><span class="p">(</span><span class="nx">context</span><span class="p">,</span> <span class="nx">payload</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="err">↓</span>\n<span class="nx">dispatch</span><span class="p">(</span><span class="dl">\'</span><span class="s1">login</span><span class="dl">\'</span><span class="p">,</span> <span class="nx">payload</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="k">void</span><span class="o">&gt;</span><span class="p">;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">BaseStoreModule</span> <span class="o">=</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">[])</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="p">)</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="nx">type</span> <span class="nx">DefineActions</span><span class="o">&lt;</span><span class="nx">Actions</span> <span class="kd">extends</span> <span class="nx">BaseStoreModule</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{};</span>\n</pre></div></div>\n\n<h5>\n<span id="record" class="fragment"></span><a href="#record"><i class="fa fa-link"></i></a>Record</h5>\n\n<p>オブジェクトのキーと値の型を定義する。<code>{ [key: string]: string }</code>と<code>Record&lt;string, string&gt;</code>は同義。</p>\n\n<h2>\n<span id="step-2-アクション名をdispatchにマッピングする" class="fragment"></span><a href="#step-2-%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%90%8D%E3%82%92dispatch%E3%81%AB%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Step 2. アクション名をdispatchにマッピングする</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">DefineActions</span><span class="o">&lt;</span><span class="nx">Actions</span> <span class="kd">extends</span> <span class="nx">BaseStoreModule</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">Actions</span><span class="o">&gt;</span><span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="nx">K</span><span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="p">};</span>\n</pre></div></div>\n\n<h5>\n<span id="keyof-a" class="fragment"></span><a href="#keyof-a"><i class="fa fa-link"></i></a>keyof A</h5>\n\n<p>オブジェクトAのキーを取り出す。<br>\n上記の場合、<code>type: K</code>は<code>keyof Actions</code>を継承しているので<code>login</code>、<code>joinRoom</code>または<code>leaveRoom</code>のいずれかとなる。</p>\n\n<h5>\n<span id="returntype" class="fragment"></span><a href="#returntype"><i class="fa fa-link"></i></a>ReturnType</h5>\n\n<p>関数の返り値を返す。</p>\n\n<h2>\n<span id="step-3-アクションからペイロードを取り出す" class="fragment"></span><a href="#step-3-%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%81%8B%E3%82%89%E3%83%9A%E3%82%A4%E3%83%AD%E3%83%BC%E3%83%89%E3%82%92%E5%8F%96%E3%82%8A%E5%87%BA%E3%81%99"><i class="fa fa-link"></i></a>Step 3. アクションからペイロードを取り出す</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="k">export</span> <span class="nx">type</span> <span class="nx">Payload</span><span class="o">&lt;</span><span class="nx">F</span> <span class="kd">extends</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">F</span> <span class="kd">extends</span> <span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="nx">payload</span><span class="p">:</span> <span class="nx">infer</span> <span class="nx">P</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span>\n  <span class="p">?</span> <span class="nx">P</span>\n  <span class="p">:</span> <span class="nx">never</span><span class="p">;</span>\n</pre></div></div>\n\n<h5>\n<span id="a-extends-b--c--d" class="fragment"></span><a href="#a-extends-b--c--d"><i class="fa fa-link"></i></a>A extends B ? C : D</h5>\n\n<p>型の三項演算子。</p>\n\n<h5>\n<span id="infer-p" class="fragment"></span><a href="#infer-p"><i class="fa fa-link"></i></a>infer P</h5>\n\n<p>暫定的な型を使い回せるようにする。ただし、extendsの条件部に仕込む必要があり、型は二項目でのみ参照できる。</p>\n\n<h2>\n<span id="step-4-payloadをdispatchの引数として指定する" class="fragment"></span><a href="#step-4-payload%E3%82%92dispatch%E3%81%AE%E5%BC%95%E6%95%B0%E3%81%A8%E3%81%97%E3%81%A6%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Step 4. PayloadをDispatchの引数として指定する</h2>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">DefineActions</span><span class="o">&lt;</span><span class="nx">Actions</span> <span class="kd">extends</span> <span class="nx">BaseStoreModule</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">Actions</span><span class="o">&gt;</span><span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">Payload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="p">};</span>\n</pre></div></div>\n\n<h2>\n<span id="step-5-namespace付きのアクション名にマッピングする" class="fragment"></span><a href="#step-5-namespace%E4%BB%98%E3%81%8D%E3%81%AE%E3%82%A2%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E5%90%8D%E3%81%AB%E3%83%9E%E3%83%83%E3%83%94%E3%83%B3%E3%82%B0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Step 5. Namespace付きのアクション名にマッピングする</h2>\n\n<p>いまのところ、<code>dispatch(\'login\', payload)</code>となっているので、<code>dispatch(\'chat/login\', payload)</code>となるようにアクション名をマッピングする。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">MapActions</span><span class="o">&lt;</span><span class="nx">A</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">any</span><span class="o">&gt;</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{</span>\n\n<span class="p">};</span>\n</pre></div></div>\n\n<h5>\n<span id="k-in-keyof-p-" class="fragment"></span><a href="#k-in-keyof-p-"><i class="fa fa-link"></i></a>[K in keyof P]: ...</h5>\n\n<p><code>P</code>のキーでマッピングを行う。<code>Array.map</code>的な。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// ObjのすべてのプロパティをString型にする</span>\n<span class="nx">type</span> <span class="nx">Obj</span> <span class="o">=</span> <span class="p">{</span> <span class="na">hello</span><span class="p">:</span> <span class="nx">string</span><span class="p">,</span> <span class="na">world</span><span class="p">:</span> <span class="nx">number</span> <span class="p">};</span>\n<span class="nx">type</span> <span class="nx">StrObj</span> <span class="o">=</span> <span class="p">{</span>\n\n<span class="p">};</span>\n</pre></div></div>\n\n<h2>\n<span id="step-x-payloadの未指定に対応する" class="fragment"></span><a href="#step-x-payload%E3%81%AE%E6%9C%AA%E6%8C%87%E5%AE%9A%E3%81%AB%E5%AF%BE%E5%BF%9C%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Step X. Payloadの未指定に対応する</h2>\n\n<p>Payloadを省略可能にしようとするととたんに実装がめんどくさくなる。</p>\n\n<h3>\n<span id="before" class="fragment"></span><a href="#before"><i class="fa fa-link"></i></a>Before</h3>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// ペイロードがあるプロパティのキーを取り出す</span>\n<span class="nx">type</span> <span class="nx">DefineActions</span><span class="o">&lt;</span><span class="nx">Actions</span> <span class="kd">extends</span> <span class="nx">BaseStoreModule</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">keyof</span> <span class="nx">Actions</span><span class="o">&gt;</span><span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">Payload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="p">};</span>\n</pre></div></div>\n\n<h3>\n<span id="after" class="fragment"></span><a href="#after"><i class="fa fa-link"></i></a>After</h3>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// オブジェクトの値を返す型</span>\n<span class="nx">type</span> <span class="nx">Values</span><span class="o">&lt;</span><span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">any</span><span class="p">,</span> <span class="nx">any</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="p">{</span> <span class="p">[</span><span class="na">key</span><span class="p">:</span> <span class="nx">any</span><span class="p">]:</span> <span class="nx">infer</span> <span class="nx">V</span> <span class="p">}</span> <span class="p">?</span> <span class="nx">V</span> <span class="p">:</span> <span class="nx">never</span><span class="p">;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// ペイロードのあるプロパティのキーを取り出す</span>\n<span class="nx">type</span> <span class="nx">PickKeyWithPayload</span><span class="o">&lt;</span><span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="o">&gt;</span>\n  <span class="p">?</span> <span class="nx">Values</span><span class="o">&lt;</span><span class="p">{</span>\n      <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="nx">keyof</span> <span class="nx">P</span><span class="p">]:</span> <span class="nx">P</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span> <span class="kd">extends</span> <span class="p">(</span><span class="na">context</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span> <span class="p">?</span> <span class="kc">undefined</span> <span class="p">:</span> <span class="nx">K</span>\n    <span class="p">}</span><span class="o">&gt;</span>\n  <span class="p">:</span> <span class="nx">never</span><span class="p">;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// ペイロードがない or オプショナルなプロパティのキーを取り出す</span>\n<span class="nx">type</span> <span class="nx">PickKeyWithoutPayload</span><span class="o">&lt;</span><span class="nx">P</span><span class="o">&gt;</span> <span class="o">=</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="o">&gt;</span>\n  <span class="p">?</span> <span class="nx">Values</span><span class="o">&lt;</span><span class="p">{</span>\n      <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="nx">keyof</span> <span class="nx">P</span><span class="p">]:</span> <span class="nx">P</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span> <span class="kd">extends</span> <span class="p">(</span><span class="na">context</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span> <span class="p">?</span> <span class="nx">K</span> <span class="p">:</span> <span class="kc">undefined</span>\n    <span class="p">}</span><span class="o">&gt;</span>\n  <span class="p">:</span> <span class="nx">never</span><span class="p">;</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="nx">type</span> <span class="nx">DefineActions</span><span class="o">&lt;</span><span class="nx">Actions</span> <span class="kd">extends</span> <span class="nx">BaseStoreModule</span><span class="p">,</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="nx">string</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="p">{</span>\n  <span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">PickKeyWithPayload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="na">payload</span><span class="p">:</span> <span class="nx">Payload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>\n  <span class="o">&lt;</span><span class="nx">K</span> <span class="kd">extends</span> <span class="nx">PickKeyWithoutPayload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="o">&gt;&gt;</span><span class="p">(</span><span class="na">type</span><span class="p">:</span> <span class="nx">K</span><span class="p">,</span> <span class="nx">payload</span><span class="p">?:</span> <span class="nx">Payload</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">):</span> <span class="nx">ReturnType</span><span class="o">&lt;</span><span class="nx">Actions</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="p">};</span>\n</pre></div></div>\n\n<p><code>PickKeyWithPayload</code>の<code>{ [K in keyof P]: P[K] extends (context: any) =&gt; any ? undefined : K }</code>の部分では、Payloadが存在しない可能性が<strong>ない</strong>メソッド（逆説的ですが）がある場合のみキーと同じ値が値となってオブジェクトを返します。</p>\n\n<div class="code-frame" data-lang="ts"><div class="highlight"><pre><span class="c1">// Valuesしない版</span>\n<span class="nx">type</span> <span class="nx">PickKeyWithPayload</span><span class="o">&lt;</span><span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span><span class="o">&gt;&gt;</span> <span class="o">=</span> <span class="nx">P</span> <span class="kd">extends</span> <span class="nx">Record</span><span class="o">&lt;</span><span class="nx">string</span><span class="p">,</span> <span class="p">(...</span><span class="nx">args</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span><span class="o">&gt;</span>\n  <span class="p">?</span> <span class="p">{</span>\n      <span class="p">[</span><span class="nx">K</span> <span class="k">in</span> <span class="nx">keyof</span> <span class="nx">P</span><span class="p">]:</span> <span class="nx">P</span><span class="p">[</span><span class="nx">K</span><span class="p">]</span> <span class="kd">extends</span> <span class="p">(</span><span class="na">context</span><span class="p">:</span> <span class="nx">any</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">any</span> <span class="p">?</span> <span class="kc">undefined</span> <span class="p">:</span> <span class="nx">K</span>\n    <span class="p">}</span>\n  <span class="p">:</span> <span class="nx">never</span><span class="p">;</span>\n\n<span class="nx">type</span> <span class="nx">KeyObj</span> <span class="o">=</span> <span class="nx">PickKeyWithPayload</span><span class="o">&lt;</span><span class="k">typeof</span> <span class="nx">actions</span><span class="o">&gt;</span><span class="p">;</span>\n<span class="c1">// { login: "login", joinRoom: undefined, leaveRoom: undefined }</span>\n\n<span class="nx">type</span> <span class="nx">Keys</span> <span class="o">=</span> <span class="nx">Values</span><span class="o">&lt;</span><span class="nx">KeyObj</span><span class="o">&gt;</span><span class="p">;</span> <span class="c1">// "login"</span>\n</pre></div></div>\n\n<p><code>PickKeyWithoutPayload</code>も挙動としては同様で、Payloadが存在しない可能性があるメソッドのキーのみをピックアップしています。</p>\n\n<p>もっとスマートなやり方あったら教えてほしい。</p>\n',body:"TypeScriptって魔法ではなく「手法」さえ覚えれば自作するのも夢じゃない。\n\n> 気合の入った成果物： [@lollipop-onl/vuex-typesafe-helper](https://www.npmjs.com/package/@lollipop-onl/vuex-typesafe-helper)\n\n（微妙に実装不備アリ）\n\n# Demo\n\nTypeScript Playgroundで動作を確認できます。\n\n[Demo](http://www.typescriptlang.org/play/#src=const%20actions%20%3D%20%7B%0D%0A%20%20%20%20async%20login(%7B%20commit%20%7D%2C%20payload%3A%20%7B%20id%3A%20string%2C%20password%3A%20string%20%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%2C%0D%0A%20%20%20%20async%20joinRoom(%7B%20commit%20%7D%2C%20payload%3A%20%7B%20roomId%3A%20string%20%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%2C%0D%0A%20%20%20%20async%20leaveRoom(%7B%20commit%20%7D%2C%20payload%3A%20%7B%7D)%3A%20Promise%3Cvoid%3E%20%7B%20%7D%0D%0A%7D%3B%0D%0A%0D%0Atype%20BaseStoreModule%20%3D%20Record%3Cstring%2C%20(...args%3A%20any%5B%5D)%20%3D%3E%20any%3E%3B%0D%0Atype%20Payload%3CF%20extends%20(...args%3A%20any)%20%3D%3E%20any%3E%20%3D%20F%20extends%20(ctx%2C%20payload%3A%20infer%20P)%20%3D%3E%20any%0D%0A%20%20%3F%20P%0D%0A%20%20%3A%20never%3B%0D%0Atype%20DefineActions%3CActions%20extends%20BaseStoreModule%3E%20%3D%20%7B%0D%0A%20%20%3CK%20extends%20keyof%20Actions%3E(type%3A%20K%2C%20payload%3A%20Payload%3CActions%5BK%5D%3E)%3A%20ReturnType%3CActions%5BK%5D%3E%3B%0D%0A%7D%3B%0D%0A%0D%0Atype%20Dispatch%20%3D%20DefineActions%3Ctypeof%20actions%3E%3B%0D%0A%0D%0Adeclare%20var%20dispatch%3A%20Dispatch%3B%0D%0A%0D%0Adispatch('login'%2C%20%7B%20id%3A%20'simochee'%2C%20password%3A%20'abcd1234'%20%7D)%3B%0D%0Adispatch('logout'%2C%20%7B%7D)%3B%0D%0Adispatch('joinRoom'%2C%20%7B%20roomId%3A%20100%20%7D)%3B%0D%0A)\n\n# 開発環境\n\nIDE (VS Code)\n\n# デバッグ方法\n\nIDEでの型推論\n\n```ts\ndeclare var dispatch: Dispatch;\n\ndispatch('login', { id: 'simochee', password: 'abcd1234' });\n```\n\n# VuexのActionをタイプセーフにする\n\n## やりたいこと\n\n```ts\n// store/chat.ts\nconst actions = {\n  login({ commit }, payload: { id: string, password: string }): Promise<boolean> {},\n  joinRoom({ commit }, payload: { roomId: string }): Promise<void> {},\n  leaveRoom({ commit }, payload: {}): Promise<void>\n};\n\ntype Dispatch = DefineAction<typeof actions, {\n  'chat/login': 'login',\n  'chat/joinRoom': 'joinRoom',\n  'chat/leaveRoom': 'leaveRoom'\n}>;\n```\n\nと定義したものを\n\n```ts\ndispatch('chat/login', { id: 'simochee', password: 'abcd1234' }); // returns Promise<boolean>\ndispatch('chat/joinRoom', { }); // payload error!\ndispatch('chat/leave'); // action name type error!\n```\n\nみたく使えるよう正しいアクション名にマッピングするような`DefineActions`の定義を行う。\n\n## 実装方針\n\n```ts\ntype Dispatch= DefineAction<typeof actions, {\n  'login': 'chat/login',\n  'joinRoom': 'chat/joinRoom',\n  'leaveRoom': 'chat/leaveRoom'\n};\n```\n\nジェネリクスでアクションオブジェクトの型とマッピングするイベント名のペアを渡す。\n\n##### ジェネリック\n\n関数の型（超適当）\n\n```ts\n// 基本的には <> の中に名前を入れていく\ntype PickValue<Obj, Key> = Obj[Key];\n// extends を使うとジェネリックの型を指定できる\ntype PickValue<Obj extends object, Key extends string> = Obj[Key];\n// = を使うと初期値を設定できる。ただし、型は確定しない\n// 初期値が設定されている場合のみ、ジェネリックの指定を省略できる\ntype PickValue<Obj extends object, Key = 'default'> = Obj[Key];\n```\n\n##### typeof\n\nJavaScriptの世界の値を型の世界の値に変換する。\nただし、JavaScriptでの`typeof`とはちょっと挙動が違う。\n\n```ts\nconst obj1 = { hello: 'world' };\nconst obj2: object = { hello: 'world' };\n\nconst objType2 = typeof obj1; // Object\nconst objType2 = typeof obj2; // Object\n\ntype ObjType1 = typeof obj; // { 'hello': 'world' };\n type ObjType2 = typeof obj; // object\n```\n\n## Step 1. ベースの型を作る\n\n```ts\nlogin(context, payload): Promise<void>;\n↓\ndispatch('login', payload): Promise<void>;\n```\n\n```ts\ntype BaseStoreModule = Record<string, (...args: any[]) => any)>;\ntype DefineActions<Actions extends BaseStoreModule, P extends Record<string, string>> = {};\n```\n\n##### Record\n\nオブジェクトのキーと値の型を定義する。`{ [key: string]: string }`と`Record<string, string>`は同義。\n\n## Step 2. アクション名をdispatchにマッピングする\n\n```ts\ntype DefineActions<Actions extends BaseStoreModule, P extends Record<string, string>> = {\n  <K extends keyof Actions>(type: K): ReturnType<Actions[K]>;\n};\n```\n\n##### keyof A\n\nオブジェクトAのキーを取り出す。\n上記の場合、`type: K`は`keyof Actions`を継承しているので`login`、`joinRoom`または`leaveRoom`のいずれかとなる。\n\n##### ReturnType\n\n関数の返り値を返す。\n\n## Step 3. アクションからペイロードを取り出す\n\n```ts\nexport type Payload<F extends (...args: any) => any> = F extends (ctx, payload: infer P) => any\n  ? P\n  : never;\n```\n\n##### A extends B ? C : D\n\n型の三項演算子。\n\n##### infer P\n\n暫定的な型を使い回せるようにする。ただし、extendsの条件部に仕込む必要があり、型は二項目でのみ参照できる。\n\n## Step 4. PayloadをDispatchの引数として指定する\n\n```ts\ntype DefineActions<Actions extends BaseStoreModule, P extends Record<string, string>> = {\n  <K extends keyof Actions>(type: K, payload: Payload<Actions[K]>): ReturnType<Actions[K]>;\n};\n```\n\n## Step 5. Namespace付きのアクション名にマッピングする\n\nいまのところ、`dispatch('login', payload)`となっているので、`dispatch('chat/login', payload)`となるようにアクション名をマッピングする。\n\n```ts\ntype MapActions<A extends Record<string, any>, P extends Record<string, string>> = {\n  [K in keyof A]: A[P[K]];\n};\n```\n\n##### [K in keyof P]: ...\n\n`P`のキーでマッピングを行う。`Array.map`的な。\n\n```ts\n// ObjのすべてのプロパティをString型にする\ntype Obj = { hello: string, world: number };\ntype StrObj = {\n  [K in keyof Obj]: string;\n};\n```\n\n## Step X. Payloadの未指定に対応する\n\nPayloadを省略可能にしようとするととたんに実装がめんどくさくなる。\n\n### Before\n\n```ts\n// ペイロードがあるプロパティのキーを取り出す\ntype DefineActions<Actions extends BaseStoreModule, P extends Record<string, string>> = {\n  <K extends keyof Actions>(type: K, payload: Payload<Actions[K]>): ReturnType<Actions[K]>;\n};\n```\n\n### After\n\n```ts\n// オブジェクトの値を返す型\ntype Values<P extends Record<any, any>> = P extends { [key: any]: infer V } ? V : never;\n```\n\n```ts\n// ペイロードのあるプロパティのキーを取り出す\ntype PickKeyWithPayload<P extends Record<string, (...args: any)>> = P extends Record<string, (...args: any) => any>\n  ? Values<{\n      [K in keyof P]: P[K] extends (context: any) => any ? undefined : K\n    }>\n  : never;\n```\n\n```ts\n// ペイロードがない or オプショナルなプロパティのキーを取り出す\ntype PickKeyWithoutPayload<P> = P extends Record<string, (...args: any) => any>\n  ? Values<{\n      [K in keyof P]: P[K] extends (context: any) => any ? K : undefined\n    }>\n  : never;\n```\n\n```ts\ntype DefineActions<Actions extends BaseStoreModule, P extends Record<string, string>> = {\n  <K extends PickKeyWithPayload<Actions>>(type: K, payload: Payload<Actions[K]>): ReturnType<Actions[K]>;\n  <K extends PickKeyWithoutPayload<Actions>>(type: K, payload?: Payload<Actions[K]>): ReturnType<Actions[K]>;\n};\n```\n\n`PickKeyWithPayload`の`{ [K in keyof P]: P[K] extends (context: any) => any ? undefined : K }`の部分では、Payloadが存在しない可能性が**ない**メソッド（逆説的ですが）がある場合のみキーと同じ値が値となってオブジェクトを返します。\n\n```ts\n// Valuesしない版\ntype PickKeyWithPayload<P extends Record<string, (...args: any)>> = P extends Record<string, (...args: any) => any>\n  ? {\n      [K in keyof P]: P[K] extends (context: any) => any ? undefined : K\n    }\n  : never;\n\ntype KeyObj = PickKeyWithPayload<typeof actions>;\n// { login: \"login\", joinRoom: undefined, leaveRoom: undefined }\n\ntype Keys = Values<KeyObj>; // \"login\"\n```\n\n`PickKeyWithoutPayload`も挙動としては同様で、Payloadが存在しない可能性があるメソッドのキーのみをピックアップしています。\n\nもっとスマートなやり方あったら教えてほしい。\n",coediting:a,comments_count:0,created_at:"2019-06-02T22:18:23+09:00",group:p,id:"fa667a33c118766ee55a",likes_count:10,private:a,reactions_count:0,tags:[{name:f,versions:[]},{name:"Vuex",versions:[]}],title:"TypeScriptでVuexの型ユーティリティを作ろう",updated_at:"2019-06-05T13:31:59+09:00",url:"https://qiita.com/simochee/items/fa667a33c118766ee55a",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h2>\n<span id="事象" class="fragment"></span><a href="#%E4%BA%8B%E8%B1%A1"><i class="fa fa-link"></i></a>事象</h2>\n\n<p>2019年3月21日、Nuxt.jsのv2.5.0がリリースされました 🎊🎊🎊</p>\n\n<p><a href="https://twitter.com/nuxt_js/status/1108728812945227776" class="autolink" rel="nofollow noopener" target="_blank">https://twitter.com/nuxt_js/status/1108728812945227776</a></p>\n\n<p>うっきうきでバージョンアップしたら</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre> ERROR  in ./.nuxt/client.js                                                                                                                                  friendly-errors 12:09:02\n\nModule build failed (from ./node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js):                                                               friendly-errors 12:09:02\nError: [BABEL] /path/to/project/.nuxt/client.js: Invalid Option: corejs is not a valid top-level option.\n        Maybe you meant to use \'targets\'? (While processing: "/path/to/project/node_modules/@nuxt/babel-preset-app/src/index.js$0")\n    at validateTopLevelOptions (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/normalize-options.js:49:13)\n    at normalizeOptions (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/normalize-options.js:160:3)\n    at _default (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/index.js:168:37)\n    at /path/to/project/node_modules/@babel/helper-plugin-utils/lib/index.js:19:12\n    at loadDescriptor (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:165:14)\n    at cachedFunction (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/caching.js:33:19)\n    at loadPresetDescriptor (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:235:63)\n    at config.presets.reduce (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:77:21)\n    at Array.reduce (&lt;anonymous&gt;)\n    at recurseDescriptors (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:74:38)\n    at recurseDescriptors (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:94:27)\n    at loadFullConfig (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:108:6)\n    at process.nextTick (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/transform.js:28:33)\n    at process._tickCallback (internal/process/next_tick.js:61:11)\n                                                                                                                                                              friendly-errors 12:09:02\n @ multi eventsource-polyfill webpack-hot-middleware/client?reload=true&amp;timeout=30000&amp;ansiColors=&amp;overlayStyles=&amp;name=client&amp;path=/__webpack_hmr/client ./.nuxt/client.js\n                                                                                                                                                              friendly-errors 12:09:02\n</pre></div></div>\n\n<p>なんかすごい怒られた。</p>\n\n<h2>\n<span id="対処" class="fragment"></span><a href="#%E5%AF%BE%E5%87%A6"><i class="fa fa-link"></i></a>対処</h2>\n\n<p>公式では <strong><code>yarn.lock</code>, <code>package-lock.json</code>を削除してからバージョン上げてね</strong> って書いてあったので諸々削除してやったけど効果なし。</p>\n\n<p>どうも、<code>node_modules</code>を削除してほんとにクリーンインストールしないといけないっぽかった。</p>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre><span class="nv">$ </span><span class="nb">rm</span> <span class="nt">-r</span> node_modules\n<span class="nv">$ </span>npm <span class="nb">install</span>\n</pre></div></div>\n\n<p>全消し＆インストールできちんと起動するようになった。めでたし。</p>\n\n<h2>\n<span id="メモ裏" class="fragment"></span><a href="#%E3%83%A1%E3%83%A2%E8%A3%8F"><i class="fa fa-link"></i></a>メモ裏</h2>\n\n<p>Nuxtのバージョンが上がるごとにクリーンインストールはちょいとリスキーすぎでは...</p>\n',body:"## 事象\n\n2019年3月21日、Nuxt.jsのv2.5.0がリリースされました 🎊🎊🎊\n\nhttps://twitter.com/nuxt_js/status/1108728812945227776\n\nうっきうきでバージョンアップしたら\n\n```\n ERROR  in ./.nuxt/client.js                                                                                                                                  friendly-errors 12:09:02\n\nModule build failed (from ./node_modules/@nuxt/webpack/node_modules/babel-loader/lib/index.js):                                                               friendly-errors 12:09:02\nError: [BABEL] /path/to/project/.nuxt/client.js: Invalid Option: corejs is not a valid top-level option.\n        Maybe you meant to use 'targets'? (While processing: \"/path/to/project/node_modules/@nuxt/babel-preset-app/src/index.js$0\")\n    at validateTopLevelOptions (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/normalize-options.js:49:13)\n    at normalizeOptions (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/normalize-options.js:160:3)\n    at _default (/path/to/project/node_modules/@nuxt/babel-preset-app/node_modules/@babel/preset-env/lib/index.js:168:37)\n    at /path/to/project/node_modules/@babel/helper-plugin-utils/lib/index.js:19:12\n    at loadDescriptor (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:165:14)\n    at cachedFunction (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/caching.js:33:19)\n    at loadPresetDescriptor (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:235:63)\n    at config.presets.reduce (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:77:21)\n    at Array.reduce (<anonymous>)\n    at recurseDescriptors (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:74:38)\n    at recurseDescriptors (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:94:27)\n    at loadFullConfig (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/config/full.js:108:6)\n    at process.nextTick (/path/to/project/node_modules/@nuxt/webpack/node_modules/@babel/core/lib/transform.js:28:33)\n    at process._tickCallback (internal/process/next_tick.js:61:11)\n                                                                                                                                                              friendly-errors 12:09:02\n @ multi eventsource-polyfill webpack-hot-middleware/client?reload=true&timeout=30000&ansiColors=&overlayStyles=&name=client&path=/__webpack_hmr/client ./.nuxt/client.js\n                                                                                                                                                              friendly-errors 12:09:02\n```\n\nなんかすごい怒られた。\n\n## 対処\n\n公式では **`yarn.lock`, `package-lock.json`を削除してからバージョン上げてね** って書いてあったので諸々削除してやったけど効果なし。\n\nどうも、`node_modules`を削除してほんとにクリーンインストールしないといけないっぽかった。\n\n```sh\n$ rm -r node_modules\n$ npm install\n```\n\n全消し＆インストールできちんと起動するようになった。めでたし。\n\n## メモ裏\n\nNuxtのバージョンが上がるごとにクリーンインストールはちょいとリスキーすぎでは...\n",coediting:a,comments_count:0,created_at:"2019-03-22T12:24:55+09:00",group:p,id:"388f9ed631c533401b4f",likes_count:1,private:a,reactions_count:0,tags:[{name:"core-js",versions:[]},{name:h,versions:[]}],title:"Nuxt 2.5.0 にバージョンアップしたら core-js のエラーが出るようになった",updated_at:"2019-03-22T15:08:05+09:00",url:"https://qiita.com/simochee/items/388f9ed631c533401b4f",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>５年ぶりにWindowsのパソコンを購入したMac使いが、Windowsの操作感をMacに寄せようとしたときの備忘録です。<br>\nいつまでもWindows使いづらいからMacのほうが良いなんて言ってちゃいけない。</p>\n\n<h1>\n<span id="google-imeのインストール" class="fragment"></span><a href="#google-ime%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Google IMEのインストール</h1>\n\n<p>Macでも使っているからという理由でIMEを <a href="https://www.google.co.jp/ime/" rel="nofollow noopener" target="_blank">Google IME</a> に変更します。</p>\n\n<h1>\n<span id="キーボード設定の変更" class="fragment"></span><a href="#%E3%82%AD%E3%83%BC%E3%83%9C%E3%83%BC%E3%83%89%E8%A8%AD%E5%AE%9A%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>キーボード設定の変更</h1>\n\n<p>現在使っているのはPCに付属している一般的なキーボードでCommandも英数・かなキーもありません。<br>\n完璧を目指すならMagic Keyboardを買うのが手っ取り早いですが、キー配置を変更することで不便さはかなり解消できました。</p>\n\n<h2>\n<span id="変換無変換を英数かなキーへ割当" class="fragment"></span><a href="#%E5%A4%89%E6%8F%9B%E7%84%A1%E5%A4%89%E6%8F%9B%E3%82%92%E8%8B%B1%E6%95%B0%E3%81%8B%E3%81%AA%E3%82%AD%E3%83%BC%E3%81%B8%E5%89%B2%E5%BD%93"><i class="fa fa-link"></i></a>変換・無変換を英数・かなキーへ割当</h2>\n\n<p>Google IMEのプロパティを開いてキー設定の変更から編集をクリックします。</p>\n\n<p>キー設定のうち、入力キーが<code>Muhenkan</code>に<code>IMEを無効化</code>を、<code>Henkan</code>に<code>IMEを有効化</code>を割り当てます。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fabad9273-a1c7-d3c8-6bab-d90c7783d7c0.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=3c259c9377e29e781eed2be9bd6f495f" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fabad9273-a1c7-d3c8-6bab-d90c7783d7c0.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=3c259c9377e29e781eed2be9bd6f495f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/abad9273-a1c7-d3c8-6bab-d90c7783d7c0.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fabad9273-a1c7-d3c8-6bab-d90c7783d7c0.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=5d56cfa5768031e97011d88b12307867 1x" loading="lazy"></a></p>\n\n<p>これで、Macの日本語配列のようにスペースの左側のキーで英数入力、右側のキーでかな入力に切り替えることができるようになりました。</p>\n\n<h2>\n<span id="メタ系キーの配置切り替え" class="fragment"></span><a href="#%E3%83%A1%E3%82%BF%E7%B3%BB%E3%82%AD%E3%83%BC%E3%81%AE%E9%85%8D%E7%BD%AE%E5%88%87%E3%82%8A%E6%9B%BF%E3%81%88"><i class="fa fa-link"></i></a>メタ系キーの配置切り替え</h2>\n\n<p>CommandキーやOptionキーなどメタ系のキーを入れ替えます。</p>\n\n<p>まず、キー配置をカスタマイズできる <a href="https://www.vector.co.jp/soft/winnt/util/se228667.html" rel="nofollow noopener" target="_blank">SeySwap for XP</a> をダウンロードします。<br>\nインストールは必要ありません。</p>\n\n<p>ダウンロードしたZipに含まれるKeySwap.exeを<strong>管理者権限で</strong>実行してください。</p>\n\n<p>KeySwapが起動したら、以下のようにキー設定を変更してください。</p>\n\n<p>それぞれ、セルをフォーカスしてキーを押すとそのキーを設定することができます。<br>\n（Caps Lockは必要に応じてWinキーなりCtrlキーなりに設定してください）</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F3a2da1c9-a46d-1ccb-b9ae-3010a43b62b5.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=e2c386e70ea3f288a5d2546fa0ca18d5" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F3a2da1c9-a46d-1ccb-b9ae-3010a43b62b5.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=e2c386e70ea3f288a5d2546fa0ca18d5" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/3a2da1c9-a46d-1ccb-b9ae-3010a43b62b5.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F3a2da1c9-a46d-1ccb-b9ae-3010a43b62b5.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=0a7aad7ca8a34bc2ce1f5ab193453e22 1x" loading="lazy"></a></p>\n\n<p>諸々設定が終わったら、左上の<strong>終了</strong>をクリックして設定を保存します。</p>\n\n<p>以上で、Windowsのキー配列を（多少）Macに近づけることができました。</p>\n\n<h1>\n<span id="spotlight" class="fragment"></span><a href="#spotlight"><i class="fa fa-link"></i></a>Spotlight</h1>\n\n<p>個人的にSpotlightなりAlfredのようなアプリは必須です。</p>\n\n<p>ここでは <a href="https://github.com/hainproject/hain" rel="nofollow noopener" target="_blank">Hain</a> をインストールしました。<br>\n<a href="https://github.com/hainproject/hain/releases" rel="nofollow noopener" target="_blank">GitHubのリリース</a> から<strong>Latest Release</strong>のバージョンをダウンロードしインストールしましょう。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fcd5cab5b-49e1-2fe4-aea8-1dcb8d7d189c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=9334ec9236e3ecabcfad61295f5ecbf7" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fcd5cab5b-49e1-2fe4-aea8-1dcb8d7d189c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=9334ec9236e3ecabcfad61295f5ecbf7" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/cd5cab5b-49e1-2fe4-aea8-1dcb8d7d189c.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fcd5cab5b-49e1-2fe4-aea8-1dcb8d7d189c.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=201a69c596ec472ece8032338abf7128 1x" loading="lazy"></a></p>\n\n<p>Hainの機能については <a href="https://forest.watch.impress.co.jp/docs/review/759307.html" rel="nofollow noopener" target="_blank">窓の杜さんのレビュー記事</a> が詳しいです。</p>\n\n<h2>\n<span id="ショートカットの変更" class="fragment"></span><a href="#%E3%82%B7%E3%83%A7%E3%83%BC%E3%83%88%E3%82%AB%E3%83%83%E3%83%88%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>ショートカットの変更</h2>\n\n<p>Hainを表示するショートカットはデフォルトで <code>Alt+Space</code> となっています。<br>\n一つ前のセクションでキーボード配置を変更した場合はここを <code>Ctrl+Space</code> に変更しましょう。</p>\n\n<p>Hainで <code>/hain</code> と入力して <strong>Open Preferences</strong> から設定を開きます。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fdf65f02f-7983-a7e6-f9ad-a6e9df223cc3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=9f511ac18531c7334d118f730ffc874b" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fdf65f02f-7983-a7e6-f9ad-a6e9df223cc3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=9f511ac18531c7334d118f730ffc874b" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/df65f02f-7983-a7e6-f9ad-a6e9df223cc3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fdf65f02f-7983-a7e6-f9ad-a6e9df223cc3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=0bbf1fc84dac3494c2d3e100baa63b31 1x" loading="lazy"></a></p>\n\n<p>設定のうち、 <strong>Open-Close Toggle Shortcut</strong> の設定を <code>ctrl+space</code> に変更します。<br>\n設定ウィンドウを閉じると設定が反映されます。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fbcf59aac-0b44-32f3-78aa-995f80497051.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=6cdfe479fa275ea733917950aee4fc85" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fbcf59aac-0b44-32f3-78aa-995f80497051.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=6cdfe479fa275ea733917950aee4fc85" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/bcf59aac-0b44-32f3-78aa-995f80497051.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fbcf59aac-0b44-32f3-78aa-995f80497051.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=06d3bcebc004f2e779606b0680c7ce34 1x" loading="lazy"></a></p>\n\n<h1>\n<span id="mission-control" class="fragment"></span><a href="#mission-control"><i class="fa fa-link"></i></a>Mission Control</h1>\n\n<p>Macでは欠かせないMission Controlは、Windows 10から搭載されたタスクビューである程度代替ができます。</p>\n\n<p>タスクビューはスタートメニュー、コルタナと並んでタスクバーの左側にあるアイコンをクリックするか <code>Win+Tab</code> で表示できます。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6e012fd2-c815-83e4-3e78-7db94ab74823.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=335e127d2783732204aec6cc4b992549" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6e012fd2-c815-83e4-3e78-7db94ab74823.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=335e127d2783732204aec6cc4b992549" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/6e012fd2-c815-83e4-3e78-7db94ab74823.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6e012fd2-c815-83e4-3e78-7db94ab74823.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=8074a5a4cd24c45323c1a2dee39c10bb 1x" loading="lazy"></a></p>\n\n<p>タスクビューでは現在表示しているウィンドウや仮想デスクトップの一覧、スケジュールなどが表示されます。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F5a727fc5-6739-4c9c-623f-7ed7676220d3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=4eacef19720f48c193447bb1931740a5" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F5a727fc5-6739-4c9c-623f-7ed7676220d3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=4eacef19720f48c193447bb1931740a5" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/5a727fc5-6739-4c9c-623f-7ed7676220d3.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F5a727fc5-6739-4c9c-623f-7ed7676220d3.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=b1b5280c332e9b610b4c95b1a8d6f0e7 1x" loading="lazy"></a></p>\n\n<h1>\n<span id="関連リンク" class="fragment"></span><a href="#%E9%96%A2%E9%80%A3%E3%83%AA%E3%83%B3%E3%82%AF"><i class="fa fa-link"></i></a>関連リンク</h1>\n\n<ul>\n<li><a href="https://www.google.co.jp/ime/" rel="nofollow noopener" target="_blank">Google IME</a></li>\n<li><a href="https://www.vector.co.jp/soft/winnt/util/se228667.html" rel="nofollow noopener" target="_blank">SeySwap for XP</a></li>\n<li><a href="https://github.com/hainproject/hain" rel="nofollow noopener" target="_blank">Hain</a></li>\n</ul>\n',body:"５年ぶりにWindowsのパソコンを購入したMac使いが、Windowsの操作感をMacに寄せようとしたときの備忘録です。\nいつまでもWindows使いづらいからMacのほうが良いなんて言ってちゃいけない。\n\n# Google IMEのインストール\n\nMacでも使っているからという理由でIMEを [Google IME](https://www.google.co.jp/ime/) に変更します。\n\n# キーボード設定の変更\n\n現在使っているのはPCに付属している一般的なキーボードでCommandも英数・かなキーもありません。\n完璧を目指すならMagic Keyboardを買うのが手っ取り早いですが、キー配置を変更することで不便さはかなり解消できました。\n\n## 変換・無変換を英数・かなキーへ割当\n\nGoogle IMEのプロパティを開いてキー設定の変更から編集をクリックします。\n\nキー設定のうち、入力キーが`Muhenkan`に`IMEを無効化`を、`Henkan`に`IMEを有効化`を割り当てます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/abad9273-a1c7-d3c8-6bab-d90c7783d7c0.png)\n\nこれで、Macの日本語配列のようにスペースの左側のキーで英数入力、右側のキーでかな入力に切り替えることができるようになりました。\n\n## メタ系キーの配置切り替え\n\nCommandキーやOptionキーなどメタ系のキーを入れ替えます。\n\nまず、キー配置をカスタマイズできる [SeySwap for XP](https://www.vector.co.jp/soft/winnt/util/se228667.html) をダウンロードします。\nインストールは必要ありません。\n\nダウンロードしたZipに含まれるKeySwap.exeを**管理者権限で**実行してください。\n\nKeySwapが起動したら、以下のようにキー設定を変更してください。\n\nそれぞれ、セルをフォーカスしてキーを押すとそのキーを設定することができます。\n（Caps Lockは必要に応じてWinキーなりCtrlキーなりに設定してください）\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/3a2da1c9-a46d-1ccb-b9ae-3010a43b62b5.png)\n\n諸々設定が終わったら、左上の**終了**をクリックして設定を保存します。\n\n以上で、Windowsのキー配列を（多少）Macに近づけることができました。\n\n# Spotlight\n\n個人的にSpotlightなりAlfredのようなアプリは必須です。\n\nここでは [Hain](https://github.com/hainproject/hain) をインストールしました。\n[GitHubのリリース](https://github.com/hainproject/hain/releases) から**Latest Release**のバージョンをダウンロードしインストールしましょう。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/cd5cab5b-49e1-2fe4-aea8-1dcb8d7d189c.png)\n\nHainの機能については [窓の杜さんのレビュー記事](https://forest.watch.impress.co.jp/docs/review/759307.html) が詳しいです。\n\n## ショートカットの変更\n\nHainを表示するショートカットはデフォルトで `Alt+Space` となっています。\n一つ前のセクションでキーボード配置を変更した場合はここを `Ctrl+Space` に変更しましょう。\n\nHainで `/hain` と入力して **Open Preferences** から設定を開きます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/df65f02f-7983-a7e6-f9ad-a6e9df223cc3.png)\n\n設定のうち、 **Open-Close Toggle Shortcut** の設定を `ctrl+space` に変更します。\n設定ウィンドウを閉じると設定が反映されます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/bcf59aac-0b44-32f3-78aa-995f80497051.png)\n\n# Mission Control\n\nMacでは欠かせないMission Controlは、Windows 10から搭載されたタスクビューである程度代替ができます。\n\nタスクビューはスタートメニュー、コルタナと並んでタスクバーの左側にあるアイコンをクリックするか `Win+Tab` で表示できます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/6e012fd2-c815-83e4-3e78-7db94ab74823.png)\n\nタスクビューでは現在表示しているウィンドウや仮想デスクトップの一覧、スケジュールなどが表示されます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/5a727fc5-6739-4c9c-623f-7ed7676220d3.png)\n\n# 関連リンク\n\n* [Google IME](https://www.google.co.jp/ime/)\n* [SeySwap for XP](https://www.vector.co.jp/soft/winnt/util/se228667.html)\n* [Hain](https://github.com/hainproject/hain)\n",coediting:a,comments_count:0,created_at:"2019-01-12T14:09:31+09:00",group:p,id:"9ea5b1dfc0b6a9638a4c",likes_count:0,private:a,reactions_count:0,tags:[{name:"Mac",versions:[]},{name:"Windows",versions:[]},{name:"初期設定",versions:[]}],title:"Mac使いがWindows PCを買ったときの初期設定（備忘録）",updated_at:"2019-01-12T14:34:23+09:00",url:"https://qiita.com/simochee/items/9ea5b1dfc0b6a9638a4c",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>この記事は <a href="https://qiita.com/advent-calendar/2018/typescript">TypeScript Advent Calendar 2018</a> の13日目です。</p>\n\n<h1>\n<span id="20181215追記" class="fragment"></span><a href="#20181215%E8%BF%BD%E8%A8%98"><i class="fa fa-link"></i></a>2018/12/15追記</h1>\n\n<p>次のバージョンでTypeScriptのビルドオプションが追加されるようです。</p>\n\n<blockquote>\n<p><a href="https://github.com/nuxt/nuxt.js/pull/4557" rel="nofollow noopener" target="_blank">feat: TypeScript support via <code>build</code> option</a></p>\n</blockquote>\n\n<h1>\n<span id="nuxt--typescript" class="fragment"></span><a href="#nuxt--typescript"><i class="fa fa-link"></i></a>Nuxt × TypeScript</h1>\n\n<p>はじめまして。Advent Calendar初参戦の <a href="/simochee" class="user-mention js-hovercard" title="simochee" data-hovercard-target-type="user" data-hovercard-target-name="simochee">@simochee</a> （しもちぃ）と申します。</p>\n\n<p>Nuxt、最近流行っていますね。<br>\nそんなNuxtをTypeScriptで使おうと公式コミュニティのテンプレートを見に行ったら、もう半年以上更新されておらず若干不安になります。<br>\n（というか未だにNuxt 1.3.0だし）</p>\n\n<p>ということで、NuxtでTypeScriptを使うための（個人的な）おすすめ環境をご紹介します。</p>\n\n<p>なお、この記事ではNuxt 2.xでの使用を想定しています。</p>\n\n<h1>\n<span id="requirements" class="fragment"></span><a href="#requirements"><i class="fa fa-link"></i></a>Requirements</h1>\n\n<p>以下のツールが動作するような環境を目指します。</p>\n\n<ul>\n<li>TypeScript</li>\n<li>TSLint</li>\n<li>(ｵﾏｹ)Storybook</li>\n</ul>\n\n<h1>\n<span id="dependences" class="fragment"></span><a href="#dependences"><i class="fa fa-link"></i></a>Dependences</h1>\n\n<p>依存するパッケージの一覧です。</p>\n\n<ul>\n<li>TypeScript\n\n<ul>\n<li><code>typescript</code></li>\n<li><code>ts-loader</code></li>\n<li><code>fork-ts-checker-webpack-plugin</code></li>\n</ul>\n</li>\n<li>TSLint\n\n<ul>\n<li><code>tslint</code></li>\n<li><code>vue-tslint-loader</code></li>\n</ul>\n</li>\n</ul>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre><span class="c"># dependencies</span>\n<span class="nv">$ </span>yarn add typescript\n</pre></div></div>\n\n<div class="code-frame" data-lang="sh"><div class="highlight"><pre><span class="c"># devDependencies</span>\n<span class="nv">$ </span>yarn add <span class="nt">-D</span> ts-loader fork-ts-checker-webpack-plugin tslint vue-tslint-loader\n</pre></div></div>\n\n<h1>\n<span id="nuxtconfigjs" class="fragment"></span><a href="#nuxtconfigjs"><i class="fa fa-link"></i></a><code>nuxt.config.js</code>\n</h1>\n\n<p><code>nuxt.config.js</code>は<code>build.extend</code>と<code>build.plugins</code>、<code>extensions</code>を書き足します。</p>\n\n<div class="code-frame" data-lang="js">\n<div class="code-lang"><span class="bold">nuxt.config.js（抜粋）</span></div>\n<div class="highlight"><pre><span class="kd">const</span> <span class="nx">ForkTsChecker</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">\'</span><span class="s1">fork-ts-checker-webpack-plugin</span><span class="dl">\'</span><span class="p">);</span>\n\n<span class="p">...</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="p">{</span>\n  <span class="na">build</span><span class="p">:</span> <span class="p">{</span>\n    <span class="nx">extend</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="p">{</span> <span class="nx">isDev</span> <span class="p">})</span> <span class="p">{</span>\n      <span class="c1">// ts-loaderの設定</span>\n      <span class="kd">const</span> <span class="nx">tsLoader</span> <span class="o">=</span> <span class="p">{</span>\n        <span class="na">loader</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">ts-loader</span><span class="dl">\'</span><span class="p">,</span>\n        <span class="na">options</span><span class="p">:</span> <span class="p">{</span>\n          <span class="c1">// .vueファイルもTypeScriptとして認識させる</span>\n          <span class="na">appendTsSuffixTo</span><span class="p">:</span> <span class="p">[</span><span class="sr">/</span><span class="se">\\.</span><span class="sr">vue$/</span><span class="p">],</span>\n          <span class="na">transpileOnly</span><span class="p">:</span> <span class="kc">true</span>\n        <span class="p">},</span>\n        <span class="na">exclude</span><span class="p">:</span> <span class="p">[</span><span class="sr">/vendor/</span><span class="p">,</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">nuxt/</span><span class="p">]</span>\n      <span class="p">};</span>\n\n      <span class="c1">// Loaderを追加</span>\n      <span class="nx">config</span><span class="p">.</span><span class="nx">module</span><span class="p">.</span><span class="nx">rules</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">tsx</span><span class="se">?</span><span class="sr">$/</span><span class="p">,</span> <span class="p">...</span><span class="nx">tsLoader</span> <span class="p">});</span>\n      <span class="nx">config</span><span class="p">.</span><span class="nx">resolve</span><span class="p">.</span><span class="nx">extensions</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="dl">\'</span><span class="s1">.ts</span><span class="dl">\'</span><span class="p">);</span>\n      <span class="nx">config</span><span class="p">.</span><span class="nx">module</span><span class="p">.</span><span class="nx">rules</span><span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">rule</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n        <span class="k">if</span> <span class="p">(</span><span class="nx">rule</span><span class="p">.</span><span class="nx">loader</span> <span class="o">===</span> <span class="dl">\'</span><span class="s1">vue-loader</span><span class="dl">\'</span><span class="p">)</span> <span class="nx">rule</span><span class="p">.</span><span class="nx">options</span><span class="p">.</span><span class="nx">loaders</span> <span class="o">=</span> <span class="p">{</span> <span class="na">ts</span><span class="p">:</span> <span class="nx">tsLoader</span> <span class="p">};</span>\n        <span class="k">return</span> <span class="nx">rule</span><span class="p">;</span>\n      <span class="p">});</span>\n\n      <span class="c1">// TSLint</span>\n      <span class="nx">config</span><span class="p">.</span><span class="nx">module</span><span class="p">.</span><span class="nx">rules</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span>\n        <span class="na">enforce</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">pre</span><span class="dl">\'</span><span class="p">,</span>\n        <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\\.(</span><span class="sr">tsx</span><span class="se">?</span><span class="sr">|vue</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span>\n        <span class="na">exclude</span><span class="p">:</span> <span class="sr">/</span><span class="se">(</span><span class="sr">node_modules|</span><span class="se">\\.</span><span class="sr">nuxt</span><span class="se">)</span><span class="sr">/</span><span class="p">,</span>\n        <span class="na">use</span><span class="p">:</span> <span class="p">[</span>\n          <span class="p">{</span>\n            <span class="c1">// vue-tslint-loaderでLintさせる</span>\n            <span class="na">loader</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">vue-tslint-loader</span><span class="dl">\'</span><span class="p">,</span>\n            <span class="na">options</span><span class="p">:</span> <span class="p">{</span>\n              <span class="na">configFile</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">tslint.yml</span><span class="dl">\'</span><span class="p">,</span>\n              <span class="c1">// 本番ビルド時にエラーが発生したら落ちるようにする</span>\n              <span class="na">emitErrors</span><span class="p">:</span> <span class="o">!</span><span class="nx">isDev</span>\n            <span class="p">}</span>\n          <span class="p">}</span>\n        <span class="p">]</span>\n      <span class="p">});</span>\n    <span class="p">},</span>\n    <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>\n      <span class="c1">// 型チェックはForkTsCheckerに任せる</span>\n      <span class="k">new</span> <span class="nx">ForkTsChecker</span><span class="p">({</span>\n        <span class="na">vue</span><span class="p">:</span> <span class="kc">true</span>\n      <span class="p">}),</span>\n    <span class="p">]</span>\n  <span class="p">},</span>\n  <span class="p">...</span>\n  <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="dl">\'</span><span class="s1">js</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">ts</span><span class="dl">\'</span><span class="p">],</span>\n  <span class="p">...</span>\n<span class="p">}</span>\n</pre></div>\n</div>\n\n<p>これで、VueファイルでTypeScriptを使う準備が整いました。</p>\n\n<h1>\n<span id="vueファイル" class="fragment"></span><a href="#vue%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB"><i class="fa fa-link"></i></a>Vueファイル</h1>\n\n<p>TypeScriptを使ってページコンポーネントを書いてみましょう。</p>\n\n<p>とは言っても、<code>&lt;script&gt;</code>に<code>lang="ts"</code>を付ければ普通にTypeScriptを書けます。</p>\n\n<div class="code-frame" data-lang="vue">\n<div class="code-lang"><span class="bold">sample.vue（抜粋）</span></div>\n<div class="highlight"><pre><span class="nt">&lt;</span><span class="k">script</span> <span class="na">lang=</span><span class="s">"ts"</span><span class="nt">&gt;</span>\n<span class="k">import</span> <span class="p">{</span> <span class="nx">SampleObj</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">./interfaces.d.ts</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="nx">defualt</span> <span class="p">{</span>\n  <span class="nx">data</span><span class="p">()</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="p">{</span>\n      <span class="na">sample</span><span class="p">:</span> <span class="p">{}</span> <span class="k">as</span> <span class="nx">SampleObj</span>\n    <span class="p">}</span>\n  <span class="p">}</span>\n<span class="p">};</span>\n<span class="nt">&lt;/</span><span class="k">script</span><span class="nt">&gt;</span>\n</pre></div>\n</div>\n\n<h2>\n<span id="vue-property-decorator" class="fragment"></span><a href="#vue-property-decorator"><i class="fa fa-link"></i></a><code>vue-property-decorator</code>\n</h2>\n\n<p>せっかくなので、Decoratorを使ってVueをClassベースに書くことができるライブラリ、<code>vue-property-decorator</code>を使ってみましょう。</p>\n\n<h1>\n<span id="ｵﾏｹstorybook" class="fragment"></span><a href="#%EF%BD%B5%EF%BE%8F%EF%BD%B9storybook"><i class="fa fa-link"></i></a>(ｵﾏｹ)Storybook</h1>\n\n<p>ついでに、StorybookでNuxt(Vue)とTypeScriptが使える環境もご紹介します。</p>\n\n<h2>\n<span id="dependences-1" class="fragment"></span><a href="#dependences-1"><i class="fa fa-link"></i></a>Dependences</h2>\n\n<ul>\n<li><code>@storybook/vue</code></li>\n<li><code>webpack-merge</code></li>\n<li><code>ts-loader</code></li>\n<li><code>vue-style-loader</code></li>\n<li><code>css-loader</code></li>\n<li><code>postcss-loader</code></li>\n</ul>\n\n<h2>\n<span id="configjs" class="fragment"></span><a href="#configjs"><i class="fa fa-link"></i></a><code>config.js</code>\n</h2>\n\n<p><code>config.js</code>では、Nuxtのプラグインとグローバルなスタイル（<code>nuxt.config.js</code>の<code>css</code>プロパティ）を読み込んであげましょう。</p>\n\n<div class="code-frame" data-lang="js">\n<div class="code-lang"><span class="bold">config.js（抜粋）</span></div>\n<div class="highlight"><pre><span class="c1">// グローバルのCSSを追加</span>\n<span class="k">import</span> <span class="dl">\'</span><span class="s1">@/assets/styles/main.sass</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="c1">// Nuxtのプラグインを追加</span>\n<span class="kd">const</span> <span class="nx">plugins</span> <span class="o">=</span> <span class="nx">require</span><span class="p">.</span><span class="nx">context</span><span class="p">(</span><span class="dl">\'</span><span class="s1">../plugins</span><span class="dl">\'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">ts$/</span><span class="p">);</span>\n<span class="nx">plugins</span><span class="p">.</span><span class="nx">keys</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">plugins</span><span class="p">);</span>\n\n<span class="c1">// Storyを追加</span>\n<span class="kd">const</span> <span class="nx">req</span> <span class="o">=</span> <span class="nx">require</span><span class="p">.</span><span class="nx">context</span><span class="p">(</span><span class="dl">\'</span><span class="s1">../stories</span><span class="dl">\'</span><span class="p">,</span> <span class="kc">true</span><span class="p">,</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">stor</span><span class="se">(</span><span class="sr">y|ies</span><span class="se">)\\.</span><span class="sr">tsx</span><span class="se">?</span><span class="sr">$/</span><span class="p">);</span>\n\n<span class="kd">function</span> <span class="nx">loadStories</span><span class="p">()</span> <span class="p">{</span>\n  <span class="nx">req</span><span class="p">.</span><span class="nx">keys</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">filename</span> <span class="o">=&gt;</span> <span class="nx">req</span><span class="p">(</span><span class="nx">filename</span><span class="p">));</span>\n<span class="p">}</span>\n\n<span class="nx">configure</span><span class="p">(</span><span class="nx">loadStories</span><span class="p">,</span> <span class="nx">module</span><span class="p">);</span>\n</pre></div>\n</div>\n\n<h2>\n<span id="webpackconfigjs" class="fragment"></span><a href="#webpackconfigjs"><i class="fa fa-link"></i></a><code>webpack.config.js</code>\n</h2>\n\n<div class="code-frame" data-lang="js">\n<div class="code-lang"><span class="bold">webpack.config.js</span></div>\n<div class="highlight"><pre><span class="kd">const</span> <span class="nx">merge</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">\'</span><span class="s1">webpack-merge</span><span class="dl">\'</span><span class="p">);</span>\n\n<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">(</span><span class="nx">storybookBaseConfig</span><span class="p">,</span> <span class="nx">configType</span><span class="p">,</span> <span class="nx">config</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>\n  <span class="k">return</span> <span class="nx">merge</span><span class="p">(</span><span class="nx">config</span><span class="p">,</span> <span class="p">{</span>\n    <span class="na">module</span><span class="p">:</span> <span class="p">{</span>\n      <span class="na">rules</span><span class="p">:</span> <span class="p">[</span>\n        <span class="p">{</span>\n          <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">tsx</span><span class="se">?</span><span class="sr">$/</span><span class="p">,</span>\n          <span class="na">loader</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">ts-loader</span><span class="dl">\'</span><span class="p">,</span>\n          <span class="na">options</span><span class="p">:</span> <span class="p">{</span>\n            <span class="na">appendTsSuffixTo</span><span class="p">:</span> <span class="p">[</span><span class="sr">/</span><span class="se">\\.</span><span class="sr">vue$/</span><span class="p">]</span>\n          <span class="p">}</span>\n        <span class="p">},</span>\n        <span class="p">{</span>\n          <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\\.</span><span class="sr">sass$/</span><span class="p">,</span>\n          <span class="na">use</span><span class="p">:</span> <span class="p">[</span>\n            <span class="dl">\'</span><span class="s1">vue-style-loader</span><span class="dl">\'</span><span class="p">,</span>\n            <span class="dl">\'</span><span class="s1">css-loader</span><span class="dl">\'</span><span class="p">,</span>\n            <span class="p">{</span>\n              <span class="na">loader</span><span class="p">:</span> <span class="dl">\'</span><span class="s1">postcss-loader</span><span class="dl">\'</span><span class="p">,</span>\n              <span class="na">options</span><span class="p">:</span> <span class="p">{</span>\n                <span class="c1">// postcssのプラグインを追加</span>\n              <span class="p">}</span>\n            <span class="p">}</span>\n          <span class="p">]</span>\n        <span class="p">}</span>\n      <span class="p">]</span>\n    <span class="p">},</span>\n\n    <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>\n      <span class="na">alias</span><span class="p">:</span> <span class="p">{</span>\n        <span class="dl">\'</span><span class="s1">@</span><span class="dl">\'</span><span class="p">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">../src</span><span class="dl">\'</span><span class="p">)</span>\n      <span class="p">},</span>\n      <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="dl">\'</span><span class="s1">.js</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">.ts</span><span class="dl">\'</span><span class="p">]</span>\n    <span class="p">}</span>\n  <span class="p">});</span>\n<span class="p">};</span>\n</pre></div>\n</div>\n\n<p>以上で、<code>./stories/**/*.stor(y|ies).tsx?</code>にマッチするStoryが読み込まれます。</p>\n',body:"この記事は [TypeScript Advent Calendar 2018](https://qiita.com/advent-calendar/2018/typescript) の13日目です。\n\n# 2018/12/15追記\n\n次のバージョンでTypeScriptのビルドオプションが追加されるようです。\n\n> [feat: TypeScript support via `build` option](https://github.com/nuxt/nuxt.js/pull/4557)\n\n# Nuxt × TypeScript\n\nはじめまして。Advent Calendar初参戦の @simochee （しもちぃ）と申します。\n\nNuxt、最近流行っていますね。\nそんなNuxtをTypeScriptで使おうと公式コミュニティのテンプレートを見に行ったら、もう半年以上更新されておらず若干不安になります。\n（というか未だにNuxt 1.3.0だし）\n\nということで、NuxtでTypeScriptを使うための（個人的な）おすすめ環境をご紹介します。\n\nなお、この記事ではNuxt 2.xでの使用を想定しています。\n\n# Requirements\n\n以下のツールが動作するような環境を目指します。\n\n* TypeScript\n* TSLint\n* (ｵﾏｹ)Storybook\n\n# Dependences\n\n依存するパッケージの一覧です。\n\n* TypeScript\n  - `typescript`\n  - `ts-loader`\n  - `fork-ts-checker-webpack-plugin`\n* TSLint\n  - `tslint`\n  - `vue-tslint-loader`\n\n```sh\n# dependencies\n$ yarn add typescript\n```\n\n```sh\n# devDependencies\n$ yarn add -D ts-loader fork-ts-checker-webpack-plugin tslint vue-tslint-loader\n```\n\n# `nuxt.config.js`\n\n`nuxt.config.js`は`build.extend`と`build.plugins`、`extensions`を書き足します。\n\n```js:nuxt.config.js（抜粋）\nconst ForkTsChecker = require('fork-ts-checker-webpack-plugin');\n\n...\n\nexport default {\n  build: {\n    extend(config, { isDev }) {\n      // ts-loaderの設定\n      const tsLoader = {\n        loader: 'ts-loader',\n        options: {\n          // .vueファイルもTypeScriptとして認識させる\n          appendTsSuffixTo: [/\\.vue$/],\n          transpileOnly: true\n        },\n        exclude: [/vendor/, /\\.nuxt/]\n      };\n\n      // Loaderを追加\n      config.module.rules.push({ test: /\\.tsx?$/, ...tsLoader });\n      config.resolve.extensions.push('.ts');\n      config.module.rules.map((rule) => {\n        if (rule.loader === 'vue-loader') rule.options.loaders = { ts: tsLoader };\n        return rule;\n      });\n\n      // TSLint\n      config.module.rules.push({\n        enforce: 'pre',\n        test: /\\.(tsx?|vue)$/,\n        exclude: /(node_modules|\\.nuxt)/,\n        use: [\n          {\n            // vue-tslint-loaderでLintさせる\n            loader: 'vue-tslint-loader',\n            options: {\n              configFile: 'tslint.yml',\n              // 本番ビルド時にエラーが発生したら落ちるようにする\n              emitErrors: !isDev\n            }\n          }\n        ]\n      });\n    },\n    plugins: [\n      // 型チェックはForkTsCheckerに任せる\n      new ForkTsChecker({\n        vue: true\n      }),\n    ]\n  },\n  ...\n  extensions: ['js', 'ts'],\n  ...\n}\n```\n\nこれで、VueファイルでTypeScriptを使う準備が整いました。\n\n# Vueファイル\n\nTypeScriptを使ってページコンポーネントを書いてみましょう。\n\nとは言っても、`<script>`に`lang=\"ts\"`を付ければ普通にTypeScriptを書けます。\n\n```vue:sample.vue（抜粋）\n<script lang=\"ts\">\nimport { SampleObj } from './interfaces.d.ts';\n\nexport defualt {\n  data() {\n    return {\n      sample: {} as SampleObj\n    }\n  }\n};\n<\/script>\n```\n\n## `vue-property-decorator`\n\nせっかくなので、Decoratorを使ってVueをClassベースに書くことができるライブラリ、`vue-property-decorator`を使ってみましょう。\n\n\n\n# (ｵﾏｹ)Storybook\n\nついでに、StorybookでNuxt(Vue)とTypeScriptが使える環境もご紹介します。\n\n## Dependences\n\n* `@storybook/vue`\n* `webpack-merge`\n* `ts-loader`\n* `vue-style-loader`\n* `css-loader`\n* `postcss-loader`\n\n## `config.js`\n\n`config.js`では、Nuxtのプラグインとグローバルなスタイル（`nuxt.config.js`の`css`プロパティ）を読み込んであげましょう。\n\n```js:config.js（抜粋）\n// グローバルのCSSを追加\nimport '@/assets/styles/main.sass';\n\n// Nuxtのプラグインを追加\nconst plugins = require.context('../plugins', true, /\\.ts$/);\nplugins.keys().forEach(plugins);\n\n// Storyを追加\nconst req = require.context('../stories', true, /\\.stor(y|ies)\\.tsx?$/);\n\nfunction loadStories() {\n  req.keys().forEach(filename => req(filename));\n}\n\nconfigure(loadStories, module);\n```\n\n## `webpack.config.js`\n\n```js:webpack.config.js\nconst merge = require('webpack-merge');\n\nmodule.exports = (storybookBaseConfig, configType, config) => {\n  return merge(config, {\n    module: {\n      rules: [\n        {\n          test: /\\.tsx?$/,\n          loader: 'ts-loader',\n          options: {\n            appendTsSuffixTo: [/\\.vue$/]\n          }\n        },\n        {\n          test: /\\.sass$/,\n          use: [\n            'vue-style-loader',\n            'css-loader',\n            {\n              loader: 'postcss-loader',\n              options: {\n                // postcssのプラグインを追加\n              }\n            }\n          ]\n        }\n      ]\n    },\n\n    resolve: {\n      alias: {\n        '@': path.resolve(__dirname, '../src')\n      },\n      extensions: ['.js', '.ts']\n    }\n  });\n};\n```\n\n以上で、`./stories/**/*.stor(y|ies).tsx?`にマッチするStoryが読み込まれます。\n",coediting:a,comments_count:0,created_at:"2018-12-12T22:53:16+09:00",group:p,id:"5f295e7cf5e8aeaedbbf",likes_count:7,private:a,reactions_count:0,tags:[{name:"AdventCalendar",versions:[]},{name:f,versions:[]},{name:g,versions:[]},{name:h,versions:[]},{name:"storybook",versions:[]}],title:"ぼくのかんがえたさいきょうのNuxt×TypeScript環境",updated_at:"2018-12-15T10:32:32+09:00",url:"https://qiita.com/simochee/items/5f295e7cf5e8aeaedbbf",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<blockquote>\n<p><strong>10/31追記</strong></p>\n\n<p><code>node-sass-glob-importer</code>を使用すると記載していましたが、<code>nuxt-sass-resources-loader</code>のみで同等のことが可能だったため書き直しました。</p>\n</blockquote>\n\n<h1>\n<span id="sassの変数やmixinsを使う" class="fragment"></span><a href="#sass%E3%81%AE%E5%A4%89%E6%95%B0%E3%82%84mixins%E3%82%92%E4%BD%BF%E3%81%86"><i class="fa fa-link"></i></a>Sassの変数やMixinsを使う</h1>\n\n<p>Nuxt.jsでは <code>nuxt-sass-resources-loader</code> を使うことで、変数やMixinsなどを各コンポーネントで使えるようになります。</p>\n\n<blockquote>\n<p><a href="https://github.com/anteriovieira/nuxt-sass-resources-loader" rel="nofollow noopener" target="_blank">nuxt-sass-resources-loader</a></p>\n</blockquote>\n\n<div class="code-frame" data-lang="js"><div class="highlight"><pre><span class="p">{</span>\n  <span class="nl">modules</span><span class="p">:</span> <span class="p">[</span>\n    <span class="p">[</span><span class="dl">\'</span><span class="s1">node-sass-resources-loader</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">@/assets/styles/resources.sass</span><span class="dl">\'</span><span class="p">]</span>\n  <span class="p">]</span>\n<span class="p">}</span>\n</pre></div></div>\n\n<div class="code-frame" data-lang="sass">\n<div class="code-lang"><span class="bold">@/assets/styles/resources.sass</span></div>\n<div class="highlight"><pre><span class="nf">=button</span><span class="p">(</span><span class="nv">$width</span><span class="o">:</span> <span class="nb">auto</span><span class="o">,</span> <span class="nv">$height</span><span class="o">:</span> <span class="nb">auto</span><span class="p">)</span>\n  <span class="nl">width</span><span class="p">:</span> <span class="nv">$width</span>\n  <span class="nl">height</span><span class="p">:</span> <span class="nv">$height</span>\n  <span class="nl">color</span><span class="p">:</span> <span class="mh">#333</span>\n  <span class="nl">border</span><span class="p">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="mh">#ccc</span>\n\n  <span class="k">&amp;</span><span class="nd">:disabled</span>\n    <span class="nl">background</span><span class="p">:</span> <span class="mh">#ccc</span>\n</pre></div>\n</div>\n\n<div class="code-frame" data-lang="vue">\n<div class="code-lang"><span class="bold">@/pages/login.vue</span></div>\n<div class="highlight"><pre><span class="nt">&lt;</span><span class="k">style</span> <span class="na">lang=</span><span class="s">"sass"</span> <span class="na">scoped</span><span class="nt">&gt;</span>\n<span class="nc">.submit</span>\n  <span class="nd">+button</span><span class="p">(</span><span class="m">320px</span><span class="o">,</span> <span class="m">60px</span><span class="p">)</span>\n<span class="nt">&lt;/</span><span class="k">style</span><span class="nt">&gt;</span>\n</pre></div>\n</div>\n\n<h1>\n<span id="globを使ってファイルを指定する" class="fragment"></span><a href="#glob%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Globを使ってファイルを指定する</h1>\n\n<p><code>nuxt-sass-resources-loader</code>ではGlobを使ってファイルを指定することもできます。</p>\n\n<div class="code-frame" data-lang="js">\n<div class="code-lang"><span class="bold">nuxt.config.js</span></div>\n<div class="highlight"><pre><span class="p">{</span>\n  <span class="nl">modules</span><span class="p">:</span> <span class="p">[</span>\n    <span class="p">[</span><span class="dl">\'</span><span class="s1">nuxt-sass-resources-loader</span><span class="dl">\'</span><span class="p">,</span> <span class="dl">\'</span><span class="s1">@/assets/styles/resources/**/*.sass</span><span class="dl">\'</span><span class="p">]</span>\n  <span class="p">]</span>\n<span class="p">}</span>\n</pre></div>\n</div>\n\n<p>これで、<code>styles/resources</code>以下のすべてのSassファイルを使用できるようになります。</p>\n\n<h1>\n<span id="読み込む順序を指定する" class="fragment"></span><a href="#%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%82%80%E9%A0%86%E5%BA%8F%E3%82%92%E6%8C%87%E5%AE%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>読み込む順序を指定する</h1>\n\n<p>変数など、読み込む順番を気にしなければならない場合は、配列で指定します。</p>\n\n<div class="code-frame" data-lang="js">\n<div class="code-lang"><span class="bold">nuxt.config.js</span></div>\n<div class="highlight"><pre><span class="p">{</span>\n  <span class="nl">modules</span><span class="p">:</span> <span class="p">[</span>\n    <span class="p">[</span><span class="dl">\'</span><span class="s1">nuxt-sass-resources-loader</span><span class="dl">\'</span><span class="p">,</span> <span class="p">[</span>\n      <span class="dl">\'</span><span class="s1">@/assets/styles/variables/**/*.sass</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="dl">\'</span><span class="s1">@/assets/styles/utilities/**/*.sass</span><span class="dl">\'</span><span class="p">,</span>\n      <span class="dl">\'</span><span class="s1">@/assets/styles/components/**/*.sass</span><span class="dl">\'</span>\n    <span class="p">]</span>\n  <span class="p">]</span>\n<span class="p">}</span>\n</pre></div>\n</div>\n\n<h1>\n<span id="links" class="fragment"></span><a href="#links"><i class="fa fa-link"></i></a>Links</h1>\n\n<ul>\n<li><a href="https://github.com/anteriovieira/nuxt-sass-resources-loader" rel="nofollow noopener" target="_blank">nuxt-sass-resources-loader</a></li>\n</ul>\n',body:"> **10/31追記**\n>\n> `node-sass-glob-importer`を使用すると記載していましたが、`nuxt-sass-resources-loader`のみで同等のことが可能だったため書き直しました。\n\n# Sassの変数やMixinsを使う\n\nNuxt.jsでは `nuxt-sass-resources-loader` を使うことで、変数やMixinsなどを各コンポーネントで使えるようになります。\n\n> [nuxt-sass-resources-loader](https://github.com/anteriovieira/nuxt-sass-resources-loader)\n\n```js\n{\n  modules: [\n    ['node-sass-resources-loader', '@/assets/styles/resources.sass']\n  ]\n}\n```\n\n```sass:@/assets/styles/resources.sass\n=button($width: auto, $height: auto)\n  width: $width\n  height: $height\n  color: #333\n  border: 1px solid #ccc\n\n  &:disabled\n    background: #ccc\n```\n\n```vue:@/pages/login.vue\n<style lang=\"sass\" scoped>\n.submit\n  +button(320px, 60px)\n</style>\n```\n\n# Globを使ってファイルを指定する\n\n`nuxt-sass-resources-loader`ではGlobを使ってファイルを指定することもできます。\n\n```js:nuxt.config.js\n{\n  modules: [\n    ['nuxt-sass-resources-loader', '@/assets/styles/resources/**/*.sass']\n  ]\n}\n```\n\nこれで、`styles/resources`以下のすべてのSassファイルを使用できるようになります。\n\n# 読み込む順序を指定する\n\n変数など、読み込む順番を気にしなければならない場合は、配列で指定します。\n\n```js:nuxt.config.js\n{\n  modules: [\n    ['nuxt-sass-resources-loader', [\n      '@/assets/styles/variables/**/*.sass',\n      '@/assets/styles/utilities/**/*.sass',\n      '@/assets/styles/components/**/*.sass'\n    ]\n  ]\n}\n```\n\n# Links\n\n* [nuxt-sass-resources-loader](https://github.com/anteriovieira/nuxt-sass-resources-loader)\n",coediting:a,comments_count:1,created_at:"2018-10-23T00:47:44+09:00",group:p,id:"ac026ba9113dc19d2ff4",likes_count:7,private:a,reactions_count:0,tags:[{name:"Sass",versions:[]},{name:"webpack",versions:[]},{name:h,versions:[]}],title:"Nuxt.jsでSassの変数やMixinsを管理する（resources-loader）",updated_at:"2018-10-31T20:12:21+09:00",url:"https://qiita.com/simochee/items/ac026ba9113dc19d2ff4",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>9/26（火）に<strong>Parcel v1.10.0</strong>がリリースされました。</p>\n\n<blockquote class="twitter-tweet">\n<p>Parcel v1.10.0 is out! 🚀<br><br>🐠 <a href="https://twitter.com/babeljs?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">@babeljs</a> 7 support<br>🌊 Automatic <a href="https://twitter.com/flowtype?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">@flowtype</a><br>🌳 <a href="https://twitter.com/elmlang?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">@elmlang</a> out of the box<br>👔 Inline script and style extraction<br>🏷 HTML bundle loader <br>🔗 JSON LD<br>🗺 Load existing source maps<br>💪 Many bug fixes and improvements!<br><br>📝 Read more: <a href="https://t.co/hcmQC5XZUt" rel="nofollow noopener" target="_blank">https://t.co/hcmQC5XZUt</a></p>— Parcel (@parceljs) <a href="https://twitter.com/parceljs/status/1044621197013475328?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">2018年9月25日</a>\n</blockquote>\n\n<script async src="https://platform.twitter.com/widgets.js"><\/script>\n\n<blockquote>\n<p>元記事） <a href="https://medium.com/@devongovett/parcel-v1-10-0-babel-7-flow-elm-and-more-c20736553573" rel="nofollow noopener" target="_blank">📦 Parcel v1.10.0 — Babel 7, Flow, Elm, and more! 🚀</a></p>\n</blockquote>\n\n<p>関連記事）<a href="http://simoothie-cafe.hatenablog.com/entry/2018/05/06/123752" rel="nofollow noopener" target="_blank">Parcel v1.5.0 〜 v1.8.0で追加された機能</a><br>\n関連記事）<a href="https://qiita.com/simochee/items/14a178786524cfc507fb" id="reference-5b270b4ddcc117550fa1">Parcel v1.9.0 がリリースされました 🎉</a></p>\n\n<h1>\n<span id="新機能" class="fragment"></span><a href="#%E6%96%B0%E6%A9%9F%E8%83%BD"><i class="fa fa-link"></i></a>新機能</h1>\n\n<p>v1.10.0で追加された主な機能は次のとおりです。</p>\n\n<ul>\n<li>Babel7に対応</li>\n<li>Flow Typeの自動検知</li>\n<li>Elm言語のサポート</li>\n<li>インラインスクリプトとスタイルのサポート</li>\n<li>HTMLをJavaScriptでimportできるようになった\n\n<ul>\n<li><code>import(\'./page.html\')</code></li>\n</ul>\n</li>\n<li>JSON LDのサポート\n\n<ul>\n<li><a href="https://qiita.com/ikeyasu/items/29b4e12c4c54d415e67a" id="reference-a14f68fdd1aec14855d1">JSON-LD</a></li>\n</ul>\n</li>\n<li>既存のソースマップを読み込めるようになった\n\n<ul>\n<li>ライブラリなどのソースマップも読み込めるようになったようです</li>\n</ul>\n</li>\n<li>TypeScript 3.0に対応</li>\n<li>SugarSSに対応</li>\n<li>\n<code>--no-content-hash</code>オプションの追加</li>\n</ul>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/CHANGELOG.md" rel="nofollow noopener" target="_blank">Changelog</a></p>\n</blockquote>\n\n<p>いくつか詳しく見ていきましょう</p>\n\n<h2>\n<span id="babel-7のサポート" class="fragment"></span><a href="#babel-7%E3%81%AE%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>Babel 7のサポート</h2>\n\n<p>8月末にリリースしたばかりのBabel 7ですが、Parcel v1.10.0で早くもサポートしました。<br>\nBabel 7を使うことによってビルドのパフォーマンスがやや向上するのに加えて、新しいBabelの機能を使えるようになります。</p>\n\n<p>また、Parcel v1.10.0ではBabel 6で作られた既存のプロジェクトもサポートしています。<br>\n<code>babel-core</code>が<code>package.json</code>で指定されている場合はBabel 6のプロジェクトとして認識されます。<br>\n既存プロジェクトをBabel 7へアップグレードするには、<code>package.json</code>から<code>babel-core</code>を削除し、<code>@babel/core</code>を追加してください。そして、<code>.babelrc</code>内のプラグインをBabel 7対応のものに変更してください。</p>\n\n<p>新規プロジェクトの場合には、<code>.babelrc</code>に書かれているプラグインがBabel 6/7どちらに依存しているかを検出して<code>babel-core</code>か<code>@babel/core</code>のいずれかが自動的にインストールされます。</p>\n\n<p>さらに、インストールされていないBabelプラグインをParcelが自動でインストールするようになりました。<code>.babelrc</code>へプラグインを書いておくだけでParcelが必要なプラグインを自動でインストールします。</p>\n\n<h1>\n<span id="flow-typeの自動検知" class="fragment"></span><a href="#flow-type%E3%81%AE%E8%87%AA%E5%8B%95%E6%A4%9C%E7%9F%A5"><i class="fa fa-link"></i></a>Flow Typeの自動検知</h1>\n\n<p>通常、Flowを使用する際には、ビルド時に型情報を取り除くBabelプラグインを追加する必要があります。Parcel v1.10.0では、この処理が自動化されます。</p>\n\n<p>Parcelは一番上のコメントに<code>@flow</code>が含まれるファイルを自動的に検出し、型情報を削除します。<br>\nこれによって、型情報を付加するのに手作業で設定を行う必要がなくなりました。</p>\n\n<h1>\n<span id="elmのサポート" class="fragment"></span><a href="#elm%E3%81%AE%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>Elmのサポート</h1>\n\n<p><a href="http://elm-lang.org/" rel="nofollow noopener" target="_blank">Elm</a>言語はJavaScriptへコンパイルされる関数型プログラミング言語です。Parcel v1.10.0では設定を書かずにElmを使用することができます。</p>\n\n<p>拡張子が<code>.elm</code>のファイルを検知するとParcelは必要なパッケージをインストールし、プロジェクトを初期化し<code>elm.json</code>を生成します。<br>\nElmのコンパイル時にはライブリロードが利用できます。</p>\n\n<p>プロダクションビルド時にParcelは高度な最適化を自動的に有効にしてJavaScriptのMinifierよりも遥かに小さいファイルを生成します。</p>\n\n<blockquote>\n<p><a href="http://elm-lang.org/0.19.0/optimize" rel="nofollow noopener" target="_blank">How to optimize Elm code</a></p>\n</blockquote>\n\n<h1>\n<span id="インラインスクリプトとスタイルのサポート" class="fragment"></span><a href="#%E3%82%A4%E3%83%B3%E3%83%A9%E3%82%A4%E3%83%B3%E3%82%B9%E3%82%AF%E3%83%AA%E3%83%97%E3%83%88%E3%81%A8%E3%82%B9%E3%82%BF%E3%82%A4%E3%83%AB%E3%81%AE%E3%82%B5%E3%83%9D%E3%83%BC%E3%83%88"><i class="fa fa-link"></i></a>インラインスクリプトとスタイルのサポート</h1>\n\n<p>Parcel v1.8.0で複数エントリーポイントに対応したことにより、SPA以外での使いみちも広がったParcelですが、v1.10.0でインラインスクリプトとスタイルに対応しました。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-image: url(\'./logo.jpg\')"</span><span class="nt">&gt;</span>Logo<span class="nt">&lt;/div&gt;</span>\n</pre></div></div>\n\n<p>としたときでもファイルの依存が解決され、正しくビルドされるようになりました。</p>\n\n<p>また、AltJSやCSSプリプロセッサも利用可能で、<code>type</code>属性を指定することによりインラインスクリプト・スタイルがコンパイルされます。</p>\n\n<div class="code-frame" data-lang="html"><div class="highlight"><pre><span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"application/ts"</span><span class="nt">&gt;</span>\n  <span class="c1">// TypeScriptコードを書く</span>\n<span class="nt">&lt;/script&gt;</span>\n</pre></div></div>\n\n<h1>\n<span id="終わりに" class="fragment"></span><a href="#%E7%B5%82%E3%82%8F%E3%82%8A%E3%81%AB"><i class="fa fa-link"></i></a>終わりに</h1>\n\n<p>いまのところはMediumのエントリーの意訳みたいな感じですが、後日、実際に使った感想など追記したいと思います。</p>\n\n<p>いま結構な流行になりつつある<a href="https://ja.nuxtjs.org/" rel="nofollow noopener" target="_blank">Nuxt</a>もZero Configurationで動作するように設計されており<sup id="fnref1"><a href="#fn1" rel="footnote" title="NuxtのビルドツールはWebpackのラッパーみたいな感じなのでParcelとはだいぶ違いますが">1</a></sup>、その知名度は着実に広がっていると思います。</p>\n\n<p><a href="https://qiita.com/simochee/items/40b46836b87a5711c401" id="reference-c12db9504f63de30389e">Parcel v2のREFも公開された</a>ので、今後のParcelからも目が離せません。</p>\n\n<div class="footnotes">\n<hr>\n<ol>\n\n<li id="fn1">\n<p>NuxtのビルドツールはWebpackのラッパーみたいな感じなのでParcelとはだいぶ違いますが <a href="#fnref1">↩</a></p>\n</li>\n\n</ol>\n</div>\n',body:'9/26（火）に**Parcel v1.10.0**がリリースされました。\n\n<blockquote class="twitter-tweet" data-lang="ja"><p lang="en" dir="ltr">Parcel v1.10.0 is out! 🚀<br><br>🐠 <a href="https://twitter.com/babeljs?ref_src=twsrc%5Etfw">@babeljs</a> 7 support<br>🌊 Automatic <a href="https://twitter.com/flowtype?ref_src=twsrc%5Etfw">@flowtype</a><br>🌳 <a href="https://twitter.com/elmlang?ref_src=twsrc%5Etfw">@elmlang</a> out of the box<br>👔 Inline script and style extraction<br>🏷 HTML bundle loader <br>🔗 JSON LD<br>🗺 Load existing source maps<br>💪 Many bug fixes and improvements!<br><br>📝 Read more: <a href="https://t.co/hcmQC5XZUt">https://t.co/hcmQC5XZUt</a></p>&mdash; Parcel (@parceljs) <a href="https://twitter.com/parceljs/status/1044621197013475328?ref_src=twsrc%5Etfw">2018年9月25日</a></blockquote>\n<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>\n\n> 元記事） [📦 Parcel v1.10.0 — Babel 7, Flow, Elm, and more! 🚀](https://medium.com/@devongovett/parcel-v1-10-0-babel-7-flow-elm-and-more-c20736553573)\n\n関連記事）[Parcel v1.5.0 〜 v1.8.0で追加された機能](http://simoothie-cafe.hatenablog.com/entry/2018/05/06/123752)\n関連記事）[Parcel v1.9.0 がリリースされました 🎉](https://qiita.com/simochee/items/14a178786524cfc507fb)\n\n# 新機能\n\nv1.10.0で追加された主な機能は次のとおりです。\n\n* Babel7に対応\n* Flow Typeの自動検知\n* Elm言語のサポート\n* インラインスクリプトとスタイルのサポート\n* HTMLをJavaScriptでimportできるようになった\n    * `import(\'./page.html\')`\n* JSON LDのサポート\n    * [JSON-LD](https://qiita.com/ikeyasu/items/29b4e12c4c54d415e67a)\n* 既存のソースマップを読み込めるようになった\n    * ライブラリなどのソースマップも読み込めるようになったようです\n* TypeScript 3.0に対応\n* SugarSSに対応\n* `--no-content-hash`オプションの追加\n\n> [Changelog](https://github.com/parcel-bundler/parcel/blob/master/CHANGELOG.md)\n\nいくつか詳しく見ていきましょう\n\n## Babel 7のサポート\n\n8月末にリリースしたばかりのBabel 7ですが、Parcel v1.10.0で早くもサポートしました。\nBabel 7を使うことによってビルドのパフォーマンスがやや向上するのに加えて、新しいBabelの機能を使えるようになります。\n\nまた、Parcel v1.10.0ではBabel 6で作られた既存のプロジェクトもサポートしています。\n`babel-core`が`package.json`で指定されている場合はBabel 6のプロジェクトとして認識されます。\n既存プロジェクトをBabel 7へアップグレードするには、`package.json`から`babel-core`を削除し、`@babel/core`を追加してください。そして、`.babelrc`内のプラグインをBabel 7対応のものに変更してください。\n\n新規プロジェクトの場合には、`.babelrc`に書かれているプラグインがBabel 6/7どちらに依存しているかを検出して`babel-core`か`@babel/core`のいずれかが自動的にインストールされます。\n\nさらに、インストールされていないBabelプラグインをParcelが自動でインストールするようになりました。`.babelrc`へプラグインを書いておくだけでParcelが必要なプラグインを自動でインストールします。\n\n# Flow Typeの自動検知\n\n通常、Flowを使用する際には、ビルド時に型情報を取り除くBabelプラグインを追加する必要があります。Parcel v1.10.0では、この処理が自動化されます。\n\nParcelは一番上のコメントに`@flow`が含まれるファイルを自動的に検出し、型情報を削除します。\nこれによって、型情報を付加するのに手作業で設定を行う必要がなくなりました。\n\n# Elmのサポート\n\n[Elm](http://elm-lang.org/)言語はJavaScriptへコンパイルされる関数型プログラミング言語です。Parcel v1.10.0では設定を書かずにElmを使用することができます。\n\n拡張子が`.elm`のファイルを検知するとParcelは必要なパッケージをインストールし、プロジェクトを初期化し`elm.json`を生成します。\nElmのコンパイル時にはライブリロードが利用できます。\n\nプロダクションビルド時にParcelは高度な最適化を自動的に有効にしてJavaScriptのMinifierよりも遥かに小さいファイルを生成します。\n\n> [How to optimize Elm code](http://elm-lang.org/0.19.0/optimize)\n\n# インラインスクリプトとスタイルのサポート\n\nParcel v1.8.0で複数エントリーポイントに対応したことにより、SPA以外での使いみちも広がったParcelですが、v1.10.0でインラインスクリプトとスタイルに対応しました。\n\n```html\n<div style="background-image: url(\'./logo.jpg\')">Logo</div>\n```\n\nとしたときでもファイルの依存が解決され、正しくビルドされるようになりました。\n\nまた、AltJSやCSSプリプロセッサも利用可能で、`type`属性を指定することによりインラインスクリプト・スタイルがコンパイルされます。\n\n```html\n<script type="application/ts">\n  // TypeScriptコードを書く\n<\/script>\n```\n\n# 終わりに\n\nいまのところはMediumのエントリーの意訳みたいな感じですが、後日、実際に使った感想など追記したいと思います。\n\nいま結構な流行になりつつある[Nuxt](https://ja.nuxtjs.org/)もZero Configurationで動作するように設計されており[^1]、その知名度は着実に広がっていると思います。\n\n[Parcel v2のREFも公開された](https://qiita.com/simochee/items/40b46836b87a5711c401)ので、今後のParcelからも目が離せません。\n\n[^1]: NuxtのビルドツールはWebpackのラッパーみたいな感じなのでParcelとはだいぶ違いますが\n',coediting:a,comments_count:0,created_at:"2018-09-27T07:37:47+09:00",group:p,id:"baac72cbcc9a11507a35",likes_count:10,private:a,reactions_count:0,tags:[{name:"JavaScript",versions:[]},{name:"flow",versions:[]},{name:"Elm",versions:[]},{name:"babel",versions:[]},{name:_,versions:[]}],title:"📦 Parcel v1.10.0 がリリースされました 🎉",updated_at:"2018-09-27T19:43:52+09:00",url:"https://qiita.com/simochee/items/baac72cbcc9a11507a35",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>Chrome　DevToolsにはCSSで設定されたMediaQueryを表示する機能があります。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fa8f2eae8-57f1-b9dc-0b81-099e12086be8.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=72c72b4807aa0d9a67ad377472dd328f" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fa8f2eae8-57f1-b9dc-0b81-099e12086be8.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=72c72b4807aa0d9a67ad377472dd328f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/a8f2eae8-57f1-b9dc-0b81-099e12086be8.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2Fa8f2eae8-57f1-b9dc-0b81-099e12086be8.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=1decab0dc02d37c720506df22fca482d 1x" loading="lazy"></a></p>\n\n<p>しかし、画面が拡大されている場合にMediaQueryと上記の画面サイズの値とがずれてしまうことがあります。</p>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F36e5cf80-78c6-bc4a-18fb-b19103f38de7.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=cd439c276cd123e4f185c0a76b71c1ea" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F36e5cf80-78c6-bc4a-18fb-b19103f38de7.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=cd439c276cd123e4f185c0a76b71c1ea" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/36e5cf80-78c6-bc4a-18fb-b19103f38de7.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F36e5cf80-78c6-bc4a-18fb-b19103f38de7.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=989336ac2dea8716573a7e7b6dc91fb0 1x" loading="lazy"></a></p>\n\n<p><strong>Media Queryと画面サイズがずれてしまう場合は、拡大率をリセットしてみてください</strong></p>\n',body:"Chrome　DevToolsにはCSSで設定されたMediaQueryを表示する機能があります。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/a8f2eae8-57f1-b9dc-0b81-099e12086be8.png)\n\nしかし、画面が拡大されている場合にMediaQueryと上記の画面サイズの値とがずれてしまうことがあります。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/36e5cf80-78c6-bc4a-18fb-b19103f38de7.png)\n\n**Media Queryと画面サイズがずれてしまう場合は、拡大率をリセットしてみてください**\n",coediting:a,comments_count:0,created_at:"2018-09-18T12:36:40+09:00",group:p,id:"f162ae5b083ef9100f68",likes_count:0,private:a,reactions_count:0,tags:[{name:"Chrome",versions:[]},{name:"ChromeDevTool",versions:[]},{name:"MediaQueries",versions:[]}],title:"ChromeでMediaQueryの値と実画面サイズがずれるときは",updated_at:"2018-09-19T14:34:59+09:00",url:"https://qiita.com/simochee/items/f162ae5b083ef9100f68",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="はじめに" class="fragment"></span><a href="#%E3%81%AF%E3%81%98%E3%82%81%E3%81%AB"><i class="fa fa-link"></i></a>はじめに</h1>\n\n<p>Fire TVをデバッグするにはAndroid SDKに付属するADBと呼ばれるツールを使ってWifi経由（またはUSB経由）でPCからFire TVへ接続しなければなりません。<br>\nこの開発環境（というかデバッグ環境）の構築がなかなか厄介だったので実際に構築した手順をまとめました。</p>\n\n<h2>\n<span id="対象" class="fragment"></span><a href="#%E5%AF%BE%E8%B1%A1"><i class="fa fa-link"></i></a>対象</h2>\n\n<p>フロントエンドしかしない&amp;Androidの開発しない方、とりあえずAmazon Fire TVの開発を始めたい方</p>\n\n<h2>\n<span id="環境" class="fragment"></span><a href="#%E7%92%B0%E5%A2%83"><i class="fa fa-link"></i></a>環境</h2>\n\n<ul>\n<li>macOS High Sierra</li>\n<li>Google Chrome 69</li>\n</ul>\n\n<h1>\n<span id="tldr" class="fragment"></span><a href="#tldr"><i class="fa fa-link"></i></a>tl;dr</h1>\n\n<ul>\n<li>Android Studioをインストール</li>\n<li>Platform-Toolsへのパスを通す</li>\n<li>Fire TVの開発者オプションでADBデバッグをオンにする</li>\n<li>Fire TVへWeb App Testerをインストールする</li>\n<li>\n<code>adb connect &lt;IP Address&gt;</code>でFire TVへ接続する</li>\n<li>Chrome DevToolsでデバッグする</li>\n</ul>\n\n<h1>\n<span id="adbをインストール" class="fragment"></span><a href="#adb%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>ADBをインストール</h1>\n\n<h2>\n<span id="adbとは" class="fragment"></span><a href="#adb%E3%81%A8%E3%81%AF"><i class="fa fa-link"></i></a>ADBとは</h2>\n\n<blockquote>\n<p>Android Debug Bridge は adb と省略されます。 これは Android SDK の <code>platform-tools</code> に含まれるツールです。</p>\n\n<p>このツールを用いると、現在利用可能なデバイス・エミュレータの列挙、シェルコマンドの発行、ファイルの転送などが行えます。</p>\n</blockquote>\n\n<p><a href="https://android.keicode.com/devenv/what-is-adb.php" rel="nofollow noopener" target="_blank">Android Debug Bridge (adb) とは？ - Android 開発入門<br>\n</a></p>\n\n<p>Fire TVでは、PCでChrome　DevToolsと接続させるために使用します。</p>\n\n<h2>\n<span id="android-studioインストール" class="fragment"></span><a href="#android-studio%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Android Studioインストール</h2>\n\n<p>ADBを使用するにはAndroid Studioをインストールするのが簡単です。</p>\n\n<p><a href="https://developer.android.com/studio" rel="nofollow noopener" target="_blank">Android Studioのダウンロードページ</a>からインストーラーをダウンロードしてください。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/1f559d6b-a0fe-6a73-0400-8465c250551a.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/1f559d6b-a0fe-6a73-0400-8465c250551a.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/1f559d6b-a0fe-6a73-0400-8465c250551a.png" loading="lazy"></a></p>\n\n<p>ダウンロードしたらAndroid Studio.appをApplicationsに移動させます。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/358f9135-a8c8-2941-2746-9a3acf003220.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/358f9135-a8c8-2941-2746-9a3acf003220.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/358f9135-a8c8-2941-2746-9a3acf003220.png" loading="lazy"></a></p>\n\n<p>以上で、Android Studioのインストールは完了です。</p>\n\n<h2>\n<span id="android-studioの起動" class="fragment"></span><a href="#android-studio%E3%81%AE%E8%B5%B7%E5%8B%95"><i class="fa fa-link"></i></a>Android Studioの起動</h2>\n\n<p>Android Studioを起動します。</p>\n\n<p>以下のようなポップアップが出ますが、初期設定の Do not Import settings のままでOKしてください。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/3b807ae8-be52-1726-2882-660d84fcc723.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/3b807ae8-be52-1726-2882-660d84fcc723.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/3b807ae8-be52-1726-2882-660d84fcc723.png" loading="lazy"></a></p>\n\n<p>セットアップウィザードも初期設定のままで大丈夫です。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/db90b4ef-cc19-14d2-b597-55c67b34234c.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/db90b4ef-cc19-14d2-b597-55c67b34234c.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/db90b4ef-cc19-14d2-b597-55c67b34234c.png" loading="lazy"></a></p>\n\n<h2>\n<span id="android-sdk-platform-toolsのインストール" class="fragment"></span><a href="#android-sdk-platform-tools%E3%81%AE%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Android SDK Platform-Toolsのインストール</h2>\n\n<p>ADBはPlatform-Toolsに含まれる機能のため、インストールが必要です。</p>\n\n<p>Android Studioのスタートウィンドウ下部にある<code>Configure</code>から<code>SDK Manager</code>を開きます。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/716fb8f1-3fde-562a-7409-e076622c8c46.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/716fb8f1-3fde-562a-7409-e076622c8c46.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/716fb8f1-3fde-562a-7409-e076622c8c46.png" loading="lazy"></a></p>\n\n<p><code>Android SDK</code>→<code>SDK Tools</code>で<code>Android SDK Platform-Tools</code>がインストールされているのを確認します。<br>\nもしステータスが<code>Not installed</code>の場合はチェックを入れ、Applyを押してインストールしてください。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/468fa164-b230-a61c-d85d-b141128c81e4.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/468fa164-b230-a61c-d85d-b141128c81e4.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/468fa164-b230-a61c-d85d-b141128c81e4.png" loading="lazy"></a></p>\n\n<h2>\n<span id="platform-toolsにpathを通す" class="fragment"></span><a href="#platform-tools%E3%81%ABpath%E3%82%92%E9%80%9A%E3%81%99"><i class="fa fa-link"></i></a>Platform-ToolsにPATHを通す</h2>\n\n<p>最後にADBをコマンドとして使えるようにPlatform-ToolsにPATHを通します。</p>\n\n<p>Platform-Toolsは先程のSDK Managerの上部にある<code>Android SDK Location</code>以下の<code>platform-tools</code>フォルダです。<br>\nデフォルトでは<code>/Users/{ユーザー名}/Library/Android/sdk/platform-tools</code>になります。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ echo \'export PATH=$PATH:/Users/{ユーザー名}/Library/Android/sdk/platform-tools\' &gt;&gt; ~/.zshrc\n</pre></div></div>\n\n<p>PATHを通したら設定ファイルを再読込して<code>adb</code>コマンドを実行してみてください。<br>\nADBのヘルプが表示できたら成功です。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/d642b57d-b20a-5714-1430-95ba2f74dbd0.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/d642b57d-b20a-5714-1430-95ba2f74dbd0.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/d642b57d-b20a-5714-1430-95ba2f74dbd0.png" loading="lazy"></a></p>\n\n<h1>\n<span id="fire-tvの設定" class="fragment"></span><a href="#fire-tv%E3%81%AE%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Fire TVの設定</h1>\n\n<h2>\n<span id="fire-tvの開発者オプションを設定" class="fragment"></span><a href="#fire-tv%E3%81%AE%E9%96%8B%E7%99%BA%E8%80%85%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E8%A8%AD%E5%AE%9A"><i class="fa fa-link"></i></a>Fire TVの開発者オプションを設定</h2>\n\n<p>Fire TVで<code>設定</code>→<code>端末</code>→<code>開発者オプション</code>よりADBデバッグを許可します。<br>\n（今回はホスティングアプリなので、不明ソースからのアプリへの許可は不要です）</p>\n\n<h2>\n<span id="web-app-testerをインストール" class="fragment"></span><a href="#web-app-tester%E3%82%92%E3%82%A4%E3%83%B3%E3%82%B9%E3%83%88%E3%83%BC%E3%83%AB"><i class="fa fa-link"></i></a>Web App Testerをインストール</h2>\n\n<p><strong>Web App Tester</strong>はオフィシャルなウェブアプリ開発のプラットフォームです。<br>\nWeb App TesterをFire TVにインストールします。</p>\n\n<p><a href="https://www.amazon.co.jp/Amazon-Digital-Services-Inc-Tester/dp/B00DZ3I1W8" class="autolink" rel="nofollow noopener" target="_blank">https://www.amazon.co.jp/Amazon-Digital-Services-Inc-Tester/dp/B00DZ3I1W8</a></p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/b4b08f06-b217-99cf-f97e-9c5589bc6903.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/b4b08f06-b217-99cf-f97e-9c5589bc6903.png" alt="screen.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/b4b08f06-b217-99cf-f97e-9c5589bc6903.png" loading="lazy"></a></p>\n\n<p>（初期状態では「このデバイスのアプリ」は空です）</p>\n\n<h1>\n<span id="adbでfire-tvへ接続する" class="fragment"></span><a href="#adb%E3%81%A7fire-tv%E3%81%B8%E6%8E%A5%E7%B6%9A%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ADBでFire TVへ接続する</h1>\n\n<p>それでは、ADBを使ってFire TVへ接続しましょう。<br>\nWeb App Testerの右上に出ているIPアドレスへ接続させます。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb connect 192.168.0.13\n</pre></div></div>\n\n<p>接続に成功したら <code>connected to 192.168.0.13:5555</code> と、失敗したら <code>failed to connect to 192.168.0.13:5555</code> と表示されます。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/6d1da689-8eb7-f766-2ed8-f4e4143b2d01.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/6d1da689-8eb7-f766-2ed8-f4e4143b2d01.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/6d1da689-8eb7-f766-2ed8-f4e4143b2d01.png" loading="lazy"></a></p>\n\n<p>接続できない場合は <a href="#adb%E3%81%AE%E6%8E%A5%E7%B6%9A%E3%81%8C%E5%A4%B1%E6%95%97%E3%81%99%E3%82%8B">トラブルシューティング</a> をご覧ください。</p>\n\n<h2>\n<span id="接続状態を確認する" class="fragment"></span><a href="#%E6%8E%A5%E7%B6%9A%E7%8A%B6%E6%85%8B%E3%82%92%E7%A2%BA%E8%AA%8D%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>接続状態を確認する</h2>\n\n<p>ADBが正しく接続できているかは下記のコマンドで確認できます。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb devices\n</pre></div></div>\n\n<p><a href="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6477dd22-c571-0cac-0255-67ef066b021e.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=e8775e1700738b7a53a86e6723b7388f" target="_blank" rel="nofollow noopener"><img src="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6477dd22-c571-0cac-0255-67ef066b021e.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;s=e8775e1700738b7a53a86e6723b7388f" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/6477dd22-c571-0cac-0255-67ef066b021e.png" srcset="https://qiita-user-contents.imgix.net/https%3A%2F%2Fqiita-image-store.s3.amazonaws.com%2F0%2F127934%2F6477dd22-c571-0cac-0255-67ef066b021e.png?ixlib=rb-1.2.2&amp;auto=compress%2Cformat&amp;gif-q=60&amp;w=1400&amp;fit=max&amp;s=61d740e9daf75f49e2df9e7b7635f34e 1x" loading="lazy"></a></p>\n\n<p><code>device</code>なら接続中、<code>offline</code>ならオフラインになります。</p>\n\n<p>オフラインのコネクションを再接続させるには以下のコマンドを使用します。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb reconnect offline\n</pre></div></div>\n\n<h1>\n<span id="chrome-devtoolsでfire-tvをデバッグ" class="fragment"></span><a href="#chrome-devtools%E3%81%A7fire-tv%E3%82%92%E3%83%87%E3%83%90%E3%83%83%E3%82%B0"><i class="fa fa-link"></i></a>Chrome DevToolsでFire TVをデバッグ</h1>\n\n<p>Chrome DevToolsでFire TVを表示してみましょう。<br>\n<a>chrome://inspect</a> へアクセスし、Remote Targetから先程のFire TVのIPアドレスを探します。</p>\n\n<p>下記の場合は<strong>WebView in com.amazon.webapps.performancetester (59.0.3071.125)</strong>がFire TVのWeb App Testerになります。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/93bcc6aa-352c-ff9a-cdde-0b2ef022c1b9.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/93bcc6aa-352c-ff9a-cdde-0b2ef022c1b9.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/93bcc6aa-352c-ff9a-cdde-0b2ef022c1b9.png" loading="lazy"></a></p>\n\n<p><code>inspect</code>をクリックしてDevToolsを起動しましょう。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/40a439d5-cff3-ba87-aa94-f663b5c7cb19.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/40a439d5-cff3-ba87-aa94-f663b5c7cb19.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/40a439d5-cff3-ba87-aa94-f663b5c7cb19.png" loading="lazy"></a></p>\n\n<p>このようにChorme DevToolsが起動します。<br>\n画面プレビューが出ない場合は左上の<strong>Toggle Screencast</strong> <a href="https://qiita-image-store.s3.amazonaws.com/0/127934/47892c7a-5af8-30f3-5c34-9d816fd525c0.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/47892c7a-5af8-30f3-5c34-9d816fd525c0.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/47892c7a-5af8-30f3-5c34-9d816fd525c0.png" loading="lazy"></a> を押してください。</p>\n\n<h1>\n<span id="hosted-applicationを追加する" class="fragment"></span><a href="#hosted-application%E3%82%92%E8%BF%BD%E5%8A%A0%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>Hosted Applicationを追加する</h1>\n\n<p>最後に、アプリケーションを登録してみましょう。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/5f918bd2-857b-1fd3-80ea-1f39186f74e1.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/5f918bd2-857b-1fd3-80ea-1f39186f74e1.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/5f918bd2-857b-1fd3-80ea-1f39186f74e1.png" loading="lazy"></a></p>\n\n<p>Web App Testerの「アプリに名前を付ける」、「テストを希望するアプリのURLを入力」の２つの欄を埋めて「デバイスに追加」ボタンを押しましょう。</p>\n\n<p>このとき、Fire TVのリモコンで入力していては埒が明かないので、 <a href="https://www.amazon.co.jp/Amazon-Fire-TV-Remote-App/dp/B00ODIASKC" rel="nofollow noopener" target="_blank">Amazon Fire TV Remote App</a> 経由か英数字のみならADBから入力すると簡単です。</p>\n\n<p>ADBの場合はFire TVでフォーカスした後、</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb shell input text Test%sApp\n</pre></div></div>\n\n<p>で入力できます。（例は"Test App"）</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/e8debbe9-8e87-7872-6931-711f7ab587dd.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/e8debbe9-8e87-7872-6931-711f7ab587dd.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/e8debbe9-8e87-7872-6931-711f7ab587dd.png" loading="lazy"></a></p>\n\n<p>入力できたら「デバイスに追加」を押しましょう。</p>\n\n<p><a href="https://qiita-image-store.s3.amazonaws.com/0/127934/3e6baa9a-bc96-1eed-5d2e-f37e2c7e8a64.png" target="_blank" rel="nofollow noopener"><img src="https://qiita-image-store.s3.amazonaws.com/0/127934/3e6baa9a-bc96-1eed-5d2e-f37e2c7e8a64.png" alt="image.png" data-canonical-src="https://qiita-image-store.s3.amazonaws.com/0/127934/3e6baa9a-bc96-1eed-5d2e-f37e2c7e8a64.png" loading="lazy"></a></p>\n\n<p>あとは、Test Appを選択し、Chromeからinspectすることでページをデバッグすることができます。</p>\n\n<h1>\n<span id="トラブルシューティング" class="fragment"></span><a href="#%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0"><i class="fa fa-link"></i></a>トラブルシューティング</h1>\n\n<h2>\n<span id="adbの接続が失敗する" class="fragment"></span><a href="#adb%E3%81%AE%E6%8E%A5%E7%B6%9A%E3%81%8C%E5%A4%B1%E6%95%97%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ADBの接続が失敗する</h2>\n\n<h3>\n<span id="ケース１他のpcで接続している場合" class="fragment"></span><a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%91%E4%BB%96%E3%81%AEpc%E3%81%A7%E6%8E%A5%E7%B6%9A%E3%81%97%E3%81%A6%E3%81%84%E3%82%8B%E5%A0%B4%E5%90%88"><i class="fa fa-link"></i></a>ケース１：他のPCで接続している場合</h3>\n\n<p>Fire TVへは１つのデバイスからしかADBで接続できないようです。<br>\n片方のコネクションを切断してください。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb disconnect 192.168.0.13\n</pre></div></div>\n\n<h3>\n<span id="ケース２fire-tvと異なるwifiへつながっている" class="fragment"></span><a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%92fire-tv%E3%81%A8%E7%95%B0%E3%81%AA%E3%82%8Bwifi%E3%81%B8%E3%81%A4%E3%81%AA%E3%81%8C%E3%81%A3%E3%81%A6%E3%81%84%E3%82%8B"><i class="fa fa-link"></i></a>ケース２：Fire TVと異なるWiFiへつながっている</h3>\n\n<p>Fire TVとは異なるWiFiへつながっている場合は当然ADBの接続も失敗します。<br>\n戒めを込めて。</p>\n\n<h3>\n<span id="ケース３ルータを再起動する" class="fragment"></span><a href="#%E3%82%B1%E3%83%BC%E3%82%B9%EF%BC%93%E3%83%AB%E3%83%BC%E3%82%BF%E3%82%92%E5%86%8D%E8%B5%B7%E5%8B%95%E3%81%99%E3%82%8B"><i class="fa fa-link"></i></a>ケース３：ルータを再起動する</h3>\n\n<p>どうしてもつながらない場合は使用しているWifiルータを再起動してみてください。<br>\nこれで結構改善することがありました。</p>\n\n<h2>\n<span id="adbからの応答がない" class="fragment"></span><a href="#adb%E3%81%8B%E3%82%89%E3%81%AE%E5%BF%9C%E7%AD%94%E3%81%8C%E3%81%AA%E3%81%84"><i class="fa fa-link"></i></a>ADBからの応答がない</h2>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb devices\n</pre></div></div>\n\n<p>などを実行した際にコマンドが終了しなくなることがありました。<br>\n<code>kill-server</code>も同様のためサーバーを落とせなくなってしまいました。</p>\n\n<p>このようなときは<code>lsof</code>で5037番ポートでLISTENしているプロセスを<code>kill</code>してADBを落としてやりましょう。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ sudo lsof -i | grep 5037\nadb        4864    user    8u  IPv4 0xbc565019363c87eb      0t0    TCP localhost:5037 (LISTEN)\n$ sudo kill 4864\n</pre></div></div>\n\n<blockquote>\n<p><a href="https://qiita.com/simochee/items/b77bd02807d5ca88e469" class="autolink" id="reference-99e74bd2dec24d8ade9d">https://qiita.com/simochee/items/b77bd02807d5ca88e469</a></p>\n</blockquote>\n\n<h1>\n<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h1>\n\n<ul>\n<li><a href="https://developer.amazon.com/ja/docs/fire-tv/webapp-app-tester.html" class="autolink" rel="nofollow noopener" target="_blank">https://developer.amazon.com/ja/docs/fire-tv/webapp-app-tester.html</a></li>\n<li><a href="https://developer.amazon.com/ja/docs/fire-tv/webapp-debug-app.html" class="autolink" rel="nofollow noopener" target="_blank">https://developer.amazon.com/ja/docs/fire-tv/webapp-debug-app.html</a></li>\n<li><a href="https://qiita.com/t2low/items/cb37cec5f864c4748e14" class="autolink" id="reference-9081f9b485693ecd710f">https://qiita.com/t2low/items/cb37cec5f864c4748e14</a></li>\n<li><a href="https://qiita.com/TNaruto/items/b2407f5668e15e42bedd" class="autolink" id="reference-6be516c579794a2857ed">https://qiita.com/TNaruto/items/b2407f5668e15e42bedd</a></li>\n</ul>\n',body:"# はじめに\n\nFire TVをデバッグするにはAndroid SDKに付属するADBと呼ばれるツールを使ってWifi経由（またはUSB経由）でPCからFire TVへ接続しなければなりません。\nこの開発環境（というかデバッグ環境）の構築がなかなか厄介だったので実際に構築した手順をまとめました。\n\n## 対象\n\nフロントエンドしかしない&Androidの開発しない方、とりあえずAmazon Fire TVの開発を始めたい方\n\n## 環境\n\n* macOS High Sierra\n* Google Chrome 69\n\n# tl;dr\n\n* Android Studioをインストール\n* Platform-Toolsへのパスを通す\n* Fire TVの開発者オプションでADBデバッグをオンにする\n* Fire TVへWeb App Testerをインストールする\n* `adb connect <IP Address>`でFire TVへ接続する\n* Chrome DevToolsでデバッグする\n\n# ADBをインストール\n\n## ADBとは\n\n> Android Debug Bridge は adb と省略されます。 これは Android SDK の `platform-tools` に含まれるツールです。\n>\n> このツールを用いると、現在利用可能なデバイス・エミュレータの列挙、シェルコマンドの発行、ファイルの転送などが行えます。\n\n[Android Debug Bridge (adb) とは？ - Android 開発入門\n](https://android.keicode.com/devenv/what-is-adb.php)\n\nFire TVでは、PCでChrome　DevToolsと接続させるために使用します。\n\n## Android Studioインストール\n\nADBを使用するにはAndroid Studioをインストールするのが簡単です。\n\n[Android Studioのダウンロードページ](https://developer.android.com/studio)からインストーラーをダウンロードしてください。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/1f559d6b-a0fe-6a73-0400-8465c250551a.png)\n\nダウンロードしたらAndroid Studio.appをApplicationsに移動させます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/358f9135-a8c8-2941-2746-9a3acf003220.png)\n\n以上で、Android Studioのインストールは完了です。\n\n## Android Studioの起動\n\nAndroid Studioを起動します。\n\n以下のようなポップアップが出ますが、初期設定の Do not Import settings のままでOKしてください。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/3b807ae8-be52-1726-2882-660d84fcc723.png)\n\nセットアップウィザードも初期設定のままで大丈夫です。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/db90b4ef-cc19-14d2-b597-55c67b34234c.png)\n\n## Android SDK Platform-Toolsのインストール\n\nADBはPlatform-Toolsに含まれる機能のため、インストールが必要です。\n\nAndroid Studioのスタートウィンドウ下部にある`Configure`から`SDK Manager`を開きます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/716fb8f1-3fde-562a-7409-e076622c8c46.png)\n\n`Android SDK`→`SDK Tools`で`Android SDK Platform-Tools`がインストールされているのを確認します。\nもしステータスが`Not installed`の場合はチェックを入れ、Applyを押してインストールしてください。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/468fa164-b230-a61c-d85d-b141128c81e4.png)\n\n## Platform-ToolsにPATHを通す\n\n最後にADBをコマンドとして使えるようにPlatform-ToolsにPATHを通します。\n\nPlatform-Toolsは先程のSDK Managerの上部にある`Android SDK Location`以下の`platform-tools`フォルダです。\nデフォルトでは`/Users/{ユーザー名}/Library/Android/sdk/platform-tools`になります。\n\n```\n$ echo 'export PATH=$PATH:/Users/{ユーザー名}/Library/Android/sdk/platform-tools' >> ~/.zshrc\n```\n\nPATHを通したら設定ファイルを再読込して`adb`コマンドを実行してみてください。\nADBのヘルプが表示できたら成功です。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/d642b57d-b20a-5714-1430-95ba2f74dbd0.png)\n\n# Fire TVの設定\n\n## Fire TVの開発者オプションを設定\n\nFire TVで`設定`→`端末`→`開発者オプション`よりADBデバッグを許可します。\n（今回はホスティングアプリなので、不明ソースからのアプリへの許可は不要です）\n\n## Web App Testerをインストール\n\n**Web App Tester**はオフィシャルなウェブアプリ開発のプラットフォームです。\nWeb App TesterをFire TVにインストールします。\n\nhttps://www.amazon.co.jp/Amazon-Digital-Services-Inc-Tester/dp/B00DZ3I1W8\n\n![screen.png](https://qiita-image-store.s3.amazonaws.com/0/127934/b4b08f06-b217-99cf-f97e-9c5589bc6903.png)\n\n（初期状態では「このデバイスのアプリ」は空です）\n\n# ADBでFire TVへ接続する\n\nそれでは、ADBを使ってFire TVへ接続しましょう。\nWeb App Testerの右上に出ているIPアドレスへ接続させます。\n\n```\n$ adb connect 192.168.0.13\n```\n\n接続に成功したら `connected to 192.168.0.13:5555` と、失敗したら `failed to connect to 192.168.0.13:5555` と表示されます。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/6d1da689-8eb7-f766-2ed8-f4e4143b2d01.png)\n\n接続できない場合は [トラブルシューティング](#adbの接続が失敗する) をご覧ください。\n\n## 接続状態を確認する\n\nADBが正しく接続できているかは下記のコマンドで確認できます。\n\n```\n$ adb devices\n```\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/6477dd22-c571-0cac-0255-67ef066b021e.png)\n\n`device`なら接続中、`offline`ならオフラインになります。\n\nオフラインのコネクションを再接続させるには以下のコマンドを使用します。\n\n```\n$ adb reconnect offline\n```\n\n# Chrome DevToolsでFire TVをデバッグ\n\nChrome DevToolsでFire TVを表示してみましょう。\n[chrome://inspect](chrome://inspect) へアクセスし、Remote Targetから先程のFire TVのIPアドレスを探します。\n\n下記の場合は**WebView in com.amazon.webapps.performancetester (59.0.3071.125)**がFire TVのWeb App Testerになります。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/93bcc6aa-352c-ff9a-cdde-0b2ef022c1b9.png)\n\n`inspect`をクリックしてDevToolsを起動しましょう。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/40a439d5-cff3-ba87-aa94-f663b5c7cb19.png)\n\nこのようにChorme DevToolsが起動します。\n画面プレビューが出ない場合は左上の**Toggle Screencast** ![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/47892c7a-5af8-30f3-5c34-9d816fd525c0.png) を押してください。\n\n# Hosted Applicationを追加する\n\n最後に、アプリケーションを登録してみましょう。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/5f918bd2-857b-1fd3-80ea-1f39186f74e1.png)\n\nWeb App Testerの「アプリに名前を付ける」、「テストを希望するアプリのURLを入力」の２つの欄を埋めて「デバイスに追加」ボタンを押しましょう。\n\nこのとき、Fire TVのリモコンで入力していては埒が明かないので、 [Amazon Fire TV Remote App](https://www.amazon.co.jp/Amazon-Fire-TV-Remote-App/dp/B00ODIASKC) 経由か英数字のみならADBから入力すると簡単です。\n\nADBの場合はFire TVでフォーカスした後、\n\n```\n$ adb shell input text Test%sApp\n```\n\nで入力できます。（例は\"Test App\"）\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/e8debbe9-8e87-7872-6931-711f7ab587dd.png)\n\n入力できたら「デバイスに追加」を押しましょう。\n\n![image.png](https://qiita-image-store.s3.amazonaws.com/0/127934/3e6baa9a-bc96-1eed-5d2e-f37e2c7e8a64.png)\n\nあとは、Test Appを選択し、Chromeからinspectすることでページをデバッグすることができます。\n\n# トラブルシューティング\n\n## ADBの接続が失敗する\n\n### ケース１：他のPCで接続している場合\n\nFire TVへは１つのデバイスからしかADBで接続できないようです。\n片方のコネクションを切断してください。\n\n```\n$ adb disconnect 192.168.0.13\n```\n\n### ケース２：Fire TVと異なるWiFiへつながっている\n\nFire TVとは異なるWiFiへつながっている場合は当然ADBの接続も失敗します。\n戒めを込めて。\n\n### ケース３：ルータを再起動する\n\nどうしてもつながらない場合は使用しているWifiルータを再起動してみてください。\nこれで結構改善することがありました。\n\n## ADBからの応答がない\n\n```\n$ adb devices\n```\n\nなどを実行した際にコマンドが終了しなくなることがありました。\n`kill-server`も同様のためサーバーを落とせなくなってしまいました。\n\nこのようなときは`lsof`で5037番ポートでLISTENしているプロセスを`kill`してADBを落としてやりましょう。\n\n```\n$ sudo lsof -i | grep 5037\nadb        4864    user    8u  IPv4 0xbc565019363c87eb      0t0    TCP localhost:5037 (LISTEN)\n$ sudo kill 4864\n```\n\n> https://qiita.com/simochee/items/b77bd02807d5ca88e469\n\n# 参考\n\n* https://developer.amazon.com/ja/docs/fire-tv/webapp-app-tester.html\n* https://developer.amazon.com/ja/docs/fire-tv/webapp-debug-app.html\n* https://qiita.com/t2low/items/cb37cec5f864c4748e14\n* https://qiita.com/TNaruto/items/b2407f5668e15e42bedd\n",coediting:a,comments_count:0,created_at:"2018-09-08T17:14:05+09:00",group:p,id:"b9267983ae2444d30339",likes_count:4,private:a,reactions_count:0,tags:[{name:"Amazon",versions:[]},{name:"adb",versions:[]},{name:"FireTV",versions:[]}],title:"Amazon Fire TV ウェブアプリの開発環境を構築する",updated_at:"2018-09-08T17:25:05+09:00",url:"https://qiita.com/simochee/items/b9267983ae2444d30339",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'<p>ある時から、ADBを実行すると応答しなくなるようになりました。</p>\n\n<p>たとえば、</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb start-server\n\n</pre></div></div>\n\n<p>や</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ adb devices\nList of devices attached\n\n</pre></div></div>\n\n<p>のあと、待機状態のまま応答しなくなります。</p>\n\n<p>そして<code>kill-server</code>も同様に応答がなくなり使えません。</p>\n\n<p>このような場合の対処としては、<code>lsof</code>で5037番ポートでLISTENしているプロセスをkillしてADBを落としてやりましょう。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ sudo lsof -i | grep 5037\nadb        4864    user    6u  IPv4 0xbc565019343e37eb      0t0    TCP localhost:5037-&gt;localhost:64155 (CLOSE_WAIT)\nadb        4864    user    8u  IPv4 0xbc565019363c87eb      0t0    TCP localhost:5037 (LISTEN)\nadb        5918    user    3u  IPv4 0xbc565019363eaaab      0t0    TCP localhost:50581-&gt;localhost:5037 (ESTABLISHED)\nadb        7411    user    3u  IPv4 0xbc56501936384aab      0t0    TCP localhost:51923-&gt;localhost:5037 (ESTABLISHED)\nadb        7790    user    3u  IPv4 0xbc5650192d8de7eb      0t0    TCP localhost:52002-&gt;localhost:5037 (ESTABLISHED)\nadb        8190    user    3u  IPv4 0xbc565019365007eb      0t0    TCP localhost:52385-&gt;localhost:5037 (ESTABLISHED)\n</pre></div></div>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ sudo kill 4864\n</pre></div></div>\n\n<p><code>kill-server</code>できないときの奥の手ということで。</p>\n\n<h2>\n<span id="参考" class="fragment"></span><a href="#%E5%8F%82%E8%80%83"><i class="fa fa-link"></i></a>参考</h2>\n\n<p><a href="https://stackoverflow.com/questions/17851480/adb-not-responding-you-can-wait-more-or-kill-adb-exe-windows-8" class="autolink" rel="nofollow noopener" target="_blank">https://stackoverflow.com/questions/17851480/adb-not-responding-you-can-wait-more-or-kill-adb-exe-windows-8</a></p>\n',body:"ある時から、ADBを実行すると応答しなくなるようになりました。\n\nたとえば、\n\n```\n$ adb start-server\n\n```\n\nや\n\n```\n$ adb devices\nList of devices attached\n\n```\n\nのあと、待機状態のまま応答しなくなります。\n\nそして`kill-server`も同様に応答がなくなり使えません。\n\nこのような場合の対処としては、`lsof`で5037番ポートでLISTENしているプロセスをkillしてADBを落としてやりましょう。\n\n```\n$ sudo lsof -i | grep 5037\nadb        4864    user    6u  IPv4 0xbc565019343e37eb      0t0    TCP localhost:5037->localhost:64155 (CLOSE_WAIT)\nadb        4864    user    8u  IPv4 0xbc565019363c87eb      0t0    TCP localhost:5037 (LISTEN)\nadb        5918    user    3u  IPv4 0xbc565019363eaaab      0t0    TCP localhost:50581->localhost:5037 (ESTABLISHED)\nadb        7411    user    3u  IPv4 0xbc56501936384aab      0t0    TCP localhost:51923->localhost:5037 (ESTABLISHED)\nadb        7790    user    3u  IPv4 0xbc5650192d8de7eb      0t0    TCP localhost:52002->localhost:5037 (ESTABLISHED)\nadb        8190    user    3u  IPv4 0xbc565019365007eb      0t0    TCP localhost:52385->localhost:5037 (ESTABLISHED)\n```\n\n```\n$ sudo kill 4864\n```\n\n`kill-server`できないときの奥の手ということで。\n\n## 参考\n\nhttps://stackoverflow.com/questions/17851480/adb-not-responding-you-can-wait-more-or-kill-adb-exe-windows-8\n",coediting:a,comments_count:0,created_at:"2018-09-08T16:04:29+09:00",group:p,id:"b77bd02807d5ca88e469",likes_count:0,private:a,reactions_count:0,tags:[{name:"adb",versions:[]}],title:"ADBでkill-serverできないときは",updated_at:"2018-09-08T16:36:30+09:00",url:"https://qiita.com/simochee/items/b77bd02807d5ca88e469",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p},{rendered_body:'\n<h1>\n<span id="tldr" class="fragment"></span><a href="#tldr"><i class="fa fa-link"></i></a>tl;dr</h1>\n\n<ul>\n<li><a href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%90%8D%E3%81%8Cparcel%E3%81%B8%E5%A4%89%E6%9B%B4">ParcelのCLIがかなり変わったよ</a></li>\n<li><a href="#parcelrc">設定ファイルを<strong>任意で</strong>作れるようになったよ</a></li>\n</ul>\n\n<h1>\n<span id="published-the-parcel-v2-rfc" class="fragment"></span><a href="#published-the-parcel-v2-rfc"><i class="fa fa-link"></i></a>Published the Parcel v2 RFC!!!</h1>\n\n<p>8/28、Parcel v2のRFCが公開されました 🎉🎉🎉</p>\n\n<blockquote class="twitter-tweet">\n<p>⚡️ Super excited to publish the <a href="https://twitter.com/parceljs?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">@parceljs</a> v2 RFC today! Check it out and leave feedback! 🔥<br><br>📝 Read here: <a href="https://t.co/gjhAw74wPL" rel="nofollow noopener" target="_blank">https://t.co/gjhAw74wPL</a><br>💬 Comment on the PR: <a href="https://t.co/l6ktGCm160" rel="nofollow noopener" target="_blank">https://t.co/l6ktGCm160</a><br><br>HUGE thanks to <a href="https://twitter.com/jamiebuilds?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">@jamiebuilds</a> for writing it up, and putting up with me over the last few months! 🙂</p>— Devon Govett (@devongovett) <a href="https://twitter.com/devongovett/status/1034488820186603521?ref_src=twsrc%5Etfw" rel="nofollow noopener" target="_blank">2018年8月28日</a>\n</blockquote>\n\n<script async src="https://platform.twitter.com/widgets.js"><\/script>\n\n<p>所感としては、Parcelがバンドラからオールインワンの開発ツールへ進化を遂げたという感じでした。<br>\nParcelの持ち味であるZero Configurationを維持しつつ、開発ツールとしてのすべての機能を拡張できるようになりました。<br>\nまた、追加された設定ファイルもLinterのようなシンプルなものに設計されており、手軽に使用することができそうです。</p>\n\n<p>それでは、8/30 20:00時点でのParcelの新機能や仕様の変更箇所をご紹介します。</p>\n\n<h1>\n<span id="パッケージ名がparcelへ変更" class="fragment"></span><a href="#%E3%83%91%E3%83%83%E3%82%B1%E3%83%BC%E3%82%B8%E5%90%8D%E3%81%8Cparcel%E3%81%B8%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>パッケージ名が<code>parcel</code>へ変更</h1>\n\n<p>これまで、<code>parcel-bundler</code>としていたパッケージ名が<code>parcel</code>へ変更になるようです。</p>\n\n<p>また、これまではグローバルなCLIツールのような立ち位置でしたが、プロジェクトごとにインストールして使うように紹介されています。</p>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#parcel-cli" rel="nofollow noopener" target="_blank">Parcel CLI</a></p>\n</blockquote>\n\n<h1>\n<span id="実行時の引数フラグの変更" class="fragment"></span><a href="#%E5%AE%9F%E8%A1%8C%E6%99%82%E3%81%AE%E5%BC%95%E6%95%B0%E3%83%95%E3%83%A9%E3%82%B0%E3%81%AE%E5%A4%89%E6%9B%B4"><i class="fa fa-link"></i></a>実行時の引数・フラグの変更</h1>\n\n<p>これまでParcelは<code>parcel serve</code>、<code>parcel build</code>のように用途によってオプションを指定していましたが、Parcel v2からは引数として指定するようになるようです。</p>\n\n<div class="code-frame" data-lang="text"><div class="highlight"><pre>$ parcel src/*.pug --serve --watch --port 3000\n</pre></div></div>\n\n<p>また、いくつかのフラグも変更になります。</p>\n\n<ul>\n<li>\n<code>--[no-]source-map</code>\n\n<ul>\n<li>1.xでは<code>--no-source-map</code>のみだったものがOn/Offを明示できるようになりました。デフォルトは本番ビルド以外でOnです。</li>\n</ul>\n</li>\n<li>\n<code>--autoinstall [npm/yarn], --no-autoinstall</code>\n\n<ul>\n<li>こちらも明示できるようになりました。さらに、yarnとnpmも選択可能になりました。デフォルトはyarn.lockがなければnpmです。</li>\n</ul>\n</li>\n<li>\n<code>--cache &lt;dir&gt;, --no-cache</code>\n\n<ul>\n<li>キャッシュについても明示できるようになり、ディレクトリを指定できるようになりました。</li>\n</ul>\n</li>\n<li>\n<code>--mode &lt;mode&gt;</code>\n\n<ul>\n<li>独自にモードを設定できます。デフォルトはNODE_ENVです。</li>\n<li>エイリアスがあり、<code>--development (--dev)</code>、<code>--production (--prod)</code>、<code>--test</code>が用意されています。</li>\n</ul>\n</li>\n</ul>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#cli-args--flags" rel="nofollow noopener" target="_blank">CLI Args &amp; Flags</a></p>\n</blockquote>\n\n<h1>\n<span id="packagejsonの利用" class="fragment"></span><a href="#packagejson%E3%81%AE%E5%88%A9%E7%94%A8"><i class="fa fa-link"></i></a><code>package.json</code>の利用</h1>\n\n<p>Parcelの設定を<code>package.json</code>に記述できるようになるようです。</p>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#packagejson" rel="nofollow noopener" target="_blank">Configuring Parcel</a></p>\n</blockquote>\n\n<h1>\n<span id="parcelrc" class="fragment"></span><a href="#parcelrc"><i class="fa fa-link"></i></a><code>.parcelrc</code>\n</h1>\n\n<p>Parcel v2の目玉、設定ファイルが利用できるようになります。<br>\nもちろん、Parcelの持ち味である<strong>Zero Configuration</strong>は健在で、設定ファイルがなければ標準の設定で利用できます。</p>\n\n<p>すべての設定を書くと以下のようになります。</p>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/config-default"</span><span class="p">],</span><span class="w">\n  </span><span class="nl">"resolvers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/resolver-default"</span><span class="p">],</span><span class="w">\n  </span><span class="nl">"bundler"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/bundler-default"</span><span class="p">,</span><span class="w">\n  </span><span class="nl">"transforms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.vue"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-vue"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.scss"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-sass"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-babel"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.css"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-postcss"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.html"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-posthtml"</span><span class="p">],</span><span class="w">\n  </span><span class="p">},</span><span class="w">\n  </span><span class="nl">"packagers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/packager-js"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.css"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/packager-css"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.html"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/packager-html"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.wasm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/packager-wasm"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.raw"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/packager-raw"</span><span class="w">\n  </span><span class="p">},</span><span class="w">\n  </span><span class="nl">"optimizers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/optimizer-uglify"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.css"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/optimizer-cssnano"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.html"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/optimizer-htmlnano"</span><span class="p">],</span><span class="w">\n    </span><span class="nl">"*.{png,jpg,jpeg,svg,...}"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/optimizer-imagemin"</span><span class="p">]</span><span class="w">\n  </span><span class="p">},</span><span class="w">\n  </span><span class="nl">"loaders"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/loader-js"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.wasm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/loader-wasm"</span><span class="w">\n  </span><span class="p">},</span><span class="w">\n  </span><span class="nl">"reporters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/reporter-detailed"</span><span class="p">]</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<p>それぞれ見ていきましょう。</p>\n\n<h2>\n<span id="parcelrcextends" class="fragment"></span><a href="#parcelrcextends"><i class="fa fa-link"></i></a><code>.parcelrc#extends</code>\n</h2>\n\n<p>既存の設定を継承します。<br>\n２つ以上を継承する場合は配列で指定できます。</p>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/config-default"</span><span class="p">,</span><span class="w">\n  </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="s2">"../.parcelrc"</span><span class="p">,</span><span class="w">\n  </span><span class="nl">"extends"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/config-default"</span><span class="p">,</span><span class="w"> </span><span class="s2">"@company/parcel-config"</span><span class="p">]</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcresolvers" class="fragment"></span><a href="#parcelrcresolvers"><i class="fa fa-link"></i></a><code>.parcelrc#resolvers</code>\n</h2>\n\n<p>パス解決パッケージを指定します。<br>\nParcelでは無視されるURLによる依存解決などを拡張することができます。</p>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"resolvers"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/resolver-v1"</span><span class="p">]</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrctransforms" class="fragment"></span><a href="#parcelrctransforms"><i class="fa fa-link"></i></a><code>.parcelrc#transforms</code>\n</h2>\n\n<p>変換パッケージを指定します。<br>\nParcelでは以下のコンパイラ、トランスパイラが提供されます。</p>\n\n<ul>\n<li><code>@parcel/transform-babel</code></li>\n<li><code>@parcel/transform-coffeescript</code></li>\n<li><code>@parcel/transform-graphql</code></li>\n<li><code>@parcel/transform-json</code></li>\n<li><code>@parcel/transform-json5</code></li>\n<li><code>@parcel/transform-less</code></li>\n<li><code>@parcel/transform-posthtml</code></li>\n<li><code>@parcel/transform-postcss</code></li>\n<li><code>@parcel/transform-pug</code></li>\n<li><code>@parcel/transform-raw</code></li>\n<li><code>@parcel/transform-reason</code></li>\n<li><code>@parcel/transform-rust</code></li>\n<li><code>@parcel/transform-stylus</code></li>\n<li><code>@parcel/transform-toml</code></li>\n<li><code>@parcel/transform-typescript</code></li>\n<li><code>@parcel/transform-vue</code></li>\n<li><code>@parcel/transform-wasm</code></li>\n<li><code>@parcel/transform-webmanifest</code></li>\n<li><code>@parcel/transform-yaml</code></li>\n</ul>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"transforms"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/transform-babel"</span><span class="p">]</span><span class="w">\n  </span><span class="p">}</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcbundler" class="fragment"></span><a href="#parcelrcbundler"><i class="fa fa-link"></i></a><code>.parcelrc#bundler</code>\n</h2>\n\n<p>複数ファイルをまとめるためのバンドラを指定します。<br>\n<code>parcel-bundler</code>から名前が変わったのは、バンドラすら差し替えられる拡張性のためだったのでしょうか。</p>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"bundler"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/bundler-v1"</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcpackager" class="fragment"></span><a href="#parcelrcpackager"><i class="fa fa-link"></i></a><code>.parcelrc#packager</code>\n</h2>\n\n<p>異なるアセット（js, css, htmlなど）を１つのバンドルにまとめるためのパッケージャを指定します。<br>\nParcelでは以下のパッケージャが提供されます。</p>\n\n<ul>\n<li><code>@parcel/packager-html</code></li>\n<li><code>@parcel/packager-js</code></li>\n<li><code>@parcel/packager-css</code></li>\n<li><code>@parcel/packager-wasm</code></li>\n<li><code>@parcel/packager-raw</code></li>\n</ul>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"packagers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/packager-js"</span><span class="p">]</span><span class="w">\n  </span><span class="p">}</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcoptimizers" class="fragment"></span><a href="#parcelrcoptimizers"><i class="fa fa-link"></i></a><code>.parcelrc#optimizers</code>\n</h2>\n\n<p>ファイルの最適化を行うオプティマイザを指定します。<br>\nここはまだ公式のパッケージが未確定なようです。</p>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"optimizers"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/optimizer-uglify"</span><span class="p">]</span><span class="w">\n  </span><span class="p">}</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcloaders" class="fragment"></span><a href="#parcelrcloaders"><i class="fa fa-link"></i></a><code>.parcelrc#loaders</code>\n</h2>\n\n<p>　ローダーは最終的なバンドルで書き出されるファイルを生成します。<br>\nこのloaderは<strong>Webpackのloaderとは異なるものです</strong>。<br>\nParcelでは以下のローダーが提供されます。</p>\n\n<ul>\n<li><code>@parcel/loader-js</code></li>\n<li><code>@parcel/loader-css</code></li>\n<li><code>@parcel/loader-wasm</code></li>\n<li><code>@parcel/loader-raw</code></li>\n</ul>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"loaders"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">\n    </span><span class="nl">"*.js"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/loader-js"</span><span class="p">,</span><span class="w">\n    </span><span class="nl">"*.wasm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"@parcel/loader-wasm"</span><span class="w">\n  </span><span class="p">}</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<h2>\n<span id="parcelrcreporters" class="fragment"></span><a href="#parcelrcreporters"><i class="fa fa-link"></i></a><code>.parcelrc#reporters</code>\n</h2>\n\n<p>レポーターはParcelで発生したイベントによってコンソールへ表示したりファイルを生成したりできます。<br>\nParcelでは以下のレポーターが提供されます。</p>\n\n<ul>\n<li><code>@parcel/reporter-pretty</code></li>\n<li><code>@parcel/reporter-detailed</code></li>\n<li><code>@parcel/reporter-graph</code></li>\n<li><code>@parcel/reporter-visualizer</code></li>\n</ul>\n\n<div class="code-frame" data-lang="json"><div class="highlight"><pre><span class="p">{</span><span class="w">\n  </span><span class="nl">"reporters"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"@parcel/reporter-detailed"</span><span class="p">]</span><span class="w">\n</span><span class="p">}</span><span class="w">\n</span></pre></div></div>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#parcelrc" rel="nofollow noopener" target="_blank">.parcelrc</a></p>\n</blockquote>\n\n<h1>\n<span id="プラグインの作成" class="fragment"></span><a href="#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3%E3%81%AE%E4%BD%9C%E6%88%90"><i class="fa fa-link"></i></a>プラグインの作成</h1>\n\n<p><code>.parcelrc</code>の通り、様々な機能に対してプラグインを作成することができます。<br>\nParcel v2では、プラグインの命名規則が厳格に定められています。<br>\nまた、<code>package.json#engines</code>に<code>"parcel": "2.x"</code>の記述がないとエラーが表示されます。</p>\n\n<p>詳しくは以下。</p>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#creating-plugins" rel="nofollow noopener" target="_blank">Creating Plugins</a></p>\n</blockquote>\n\n<h1>\n<span id="プラグインapi" class="fragment"></span><a href="#%E3%83%97%E3%83%A9%E3%82%B0%E3%82%A4%E3%83%B3api"><i class="fa fa-link"></i></a>プラグインAPI</h1>\n\n<p>Parcel v2ではプラグインAPIがどの機能でも共通のフォーマットで作成できます。</p>\n\n<div class="code-frame" data-lang="javascript"><div class="highlight"><pre><span class="k">import</span> <span class="p">{</span> <span class="nx">NameOfPluginType</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">\'</span><span class="s1">@parcel/plugin</span><span class="dl">\'</span><span class="p">;</span>\n\n<span class="k">export</span> <span class="k">default</span> <span class="k">new</span> <span class="nx">NameOfPluginType</span><span class="p">({</span>\n  <span class="k">async</span> <span class="nx">methodName</span><span class="p">(</span><span class="na">opts</span><span class="p">:</span> <span class="nx">JSONObject</span><span class="p">):</span> <span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">JSONObject</span><span class="o">&gt;</span> <span class="p">{</span>\n    <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>\n  <span class="p">},</span>\n<span class="p">});</span>\n</pre></div></div>\n\n<p>詳しくは以下。</p>\n\n<blockquote>\n<p><a href="https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#plugin-apis" rel="nofollow noopener" target="_blank">Plugin APIs</a></p>\n</blockquote>\n',body:'# tl;dr\n\n* [ParcelのCLIがかなり変わったよ](#パッケージ名がparcelへ変更)\n* [設定ファイルを**任意で**作れるようになったよ](#parcelrc)\n\n# Published the Parcel v2 RFC!!!\n\n8/28、Parcel v2のRFCが公開されました 🎉🎉🎉\n\n<blockquote class="twitter-tweet" data-lang="ja"><p lang="en" dir="ltr">⚡️ Super excited to publish the <a href="https://twitter.com/parceljs?ref_src=twsrc%5Etfw">@parceljs</a> v2 RFC today! Check it out and leave feedback! 🔥<br><br>📝 Read here: <a href="https://t.co/gjhAw74wPL">https://t.co/gjhAw74wPL</a><br>💬 Comment on the PR: <a href="https://t.co/l6ktGCm160">https://t.co/l6ktGCm160</a><br><br>HUGE thanks to <a href="https://twitter.com/jamiebuilds?ref_src=twsrc%5Etfw">@jamiebuilds</a> for writing it up, and putting up with me over the last few months! 🙂</p>&mdash; Devon Govett (@devongovett) <a href="https://twitter.com/devongovett/status/1034488820186603521?ref_src=twsrc%5Etfw">2018年8月28日</a></blockquote>\n<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>\n\n所感としては、Parcelがバンドラからオールインワンの開発ツールへ進化を遂げたという感じでした。\nParcelの持ち味であるZero Configurationを維持しつつ、開発ツールとしてのすべての機能を拡張できるようになりました。\nまた、追加された設定ファイルもLinterのようなシンプルなものに設計されており、手軽に使用することができそうです。\n\nそれでは、8/30 20:00時点でのParcelの新機能や仕様の変更箇所をご紹介します。\n\n# パッケージ名が`parcel`へ変更\n\nこれまで、`parcel-bundler`としていたパッケージ名が`parcel`へ変更になるようです。\n\nまた、これまではグローバルなCLIツールのような立ち位置でしたが、プロジェクトごとにインストールして使うように紹介されています。\n\n> [Parcel CLI](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#parcel-cli)\n\n# 実行時の引数・フラグの変更\n\nこれまでParcelは`parcel serve`、`parcel build`のように用途によってオプションを指定していましたが、Parcel v2からは引数として指定するようになるようです。\n\n```\n$ parcel src/*.pug --serve --watch --port 3000\n```\n\nまた、いくつかのフラグも変更になります。\n\n* `--[no-]source-map`\n    * 1.xでは`--no-source-map`のみだったものがOn/Offを明示できるようになりました。デフォルトは本番ビルド以外でOnです。\n* `--autoinstall [npm/yarn], --no-autoinstall`\n    * こちらも明示できるようになりました。さらに、yarnとnpmも選択可能になりました。デフォルトはyarn.lockがなければnpmです。\n* `--cache <dir>, --no-cache`\n    * キャッシュについても明示できるようになり、ディレクトリを指定できるようになりました。\n* `--mode <mode>`\n    * 独自にモードを設定できます。デフォルトはNODE_ENVです。\n    * エイリアスがあり、`--development (--dev)`、`--production (--prod)`、`--test`が用意されています。\n\n> [CLI Args & Flags](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#cli-args--flags)\n\n# `package.json`の利用\n\nParcelの設定を`package.json`に記述できるようになるようです。\n\n> [Configuring Parcel](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#packagejson)\n\n# `.parcelrc`\n\nParcel v2の目玉、設定ファイルが利用できるようになります。\nもちろん、Parcelの持ち味である**Zero Configuration**は健在で、設定ファイルがなければ標準の設定で利用できます。\n\nすべての設定を書くと以下のようになります。\n\n```json\n{\n  "extends": ["@parcel/config-default"],\n  "resolvers": ["@parcel/resolver-default"],\n  "bundler": "@parcel/bundler-default",\n  "transforms": {\n    "*.vue": ["@parcel/transform-vue"],\n    "*.scss": ["@parcel/transform-sass"],\n    "*.js": ["@parcel/transform-babel"],\n    "*.css": ["@parcel/transform-postcss"],\n    "*.html": ["@parcel/transform-posthtml"],\n  },\n  "packagers": {\n    "*.js": "@parcel/packager-js",\n    "*.css": "@parcel/packager-css",\n    "*.html": "@parcel/packager-html",\n    "*.wasm": "@parcel/packager-wasm",\n    "*.raw": "@parcel/packager-raw"\n  },\n  "optimizers": {\n    "*.js": ["@parcel/optimizer-uglify"],\n    "*.css": ["@parcel/optimizer-cssnano"],\n    "*.html": ["@parcel/optimizer-htmlnano"],\n    "*.{png,jpg,jpeg,svg,...}": ["@parcel/optimizer-imagemin"]\n  },\n  "loaders": {\n    "*.js": "@parcel/loader-js",\n    "*.wasm": "@parcel/loader-wasm"\n  },\n  "reporters": ["@parcel/reporter-detailed"]\n}\n```\n\nそれぞれ見ていきましょう。\n\n## `.parcelrc#extends`\n\n既存の設定を継承します。\n２つ以上を継承する場合は配列で指定できます。\n\n```json\n{\n  "extends": "@parcel/config-default",\n  "extends": "../.parcelrc",\n  "extends": ["@parcel/config-default", "@company/parcel-config"]\n}\n```\n\n## `.parcelrc#resolvers`\n\nパス解決パッケージを指定します。\nParcelでは無視されるURLによる依存解決などを拡張することができます。\n\n```json\n{\n  "resolvers": ["@parcel/resolver-v1"]\n}\n```\n\n## `.parcelrc#transforms`\n\n変換パッケージを指定します。\nParcelでは以下のコンパイラ、トランスパイラが提供されます。\n\n* `@parcel/transform-babel`\n* `@parcel/transform-coffeescript`\n* `@parcel/transform-graphql`\n* `@parcel/transform-json`\n* `@parcel/transform-json5`\n* `@parcel/transform-less`\n* `@parcel/transform-posthtml`\n* `@parcel/transform-postcss`\n* `@parcel/transform-pug`\n* `@parcel/transform-raw`\n* `@parcel/transform-reason`\n* `@parcel/transform-rust`\n* `@parcel/transform-stylus`\n* `@parcel/transform-toml`\n* `@parcel/transform-typescript`\n* `@parcel/transform-vue`\n* `@parcel/transform-wasm`\n* `@parcel/transform-webmanifest`\n* `@parcel/transform-yaml`\n\n```json\n{\n  "transforms": {\n    "*.js": ["@parcel/transform-babel"]\n  }\n}\n```\n\n## `.parcelrc#bundler`\n\n複数ファイルをまとめるためのバンドラを指定します。\n`parcel-bundler`から名前が変わったのは、バンドラすら差し替えられる拡張性のためだったのでしょうか。\n\n```json\n{\n  "bundler": "@parcel/bundler-v1"\n}\n```\n\n## `.parcelrc#packager`\n\n異なるアセット（js, css, htmlなど）を１つのバンドルにまとめるためのパッケージャを指定します。\nParcelでは以下のパッケージャが提供されます。\n\n* `@parcel/packager-html`\n* `@parcel/packager-js`\n* `@parcel/packager-css`\n* `@parcel/packager-wasm`\n* `@parcel/packager-raw`\n\n```json\n{\n  "packagers": {\n    "*.js": ["@parcel/packager-js"]\n  }\n}\n```\n\n## `.parcelrc#optimizers`\n\nファイルの最適化を行うオプティマイザを指定します。\nここはまだ公式のパッケージが未確定なようです。\n\n```json\n{\n  "optimizers": {\n    "*.js": ["@parcel/optimizer-uglify"]\n  }\n}\n```\n\n## `.parcelrc#loaders`\n\n　ローダーは最終的なバンドルで書き出されるファイルを生成します。\nこのloaderは**Webpackのloaderとは異なるものです**。\nParcelでは以下のローダーが提供されます。\n\n* `@parcel/loader-js`\n* `@parcel/loader-css`\n* `@parcel/loader-wasm`\n* `@parcel/loader-raw`\n\n```json\n{\n  "loaders": {\n    "*.js": "@parcel/loader-js",\n    "*.wasm": "@parcel/loader-wasm"\n  }\n}\n```\n\n## `.parcelrc#reporters`\n\nレポーターはParcelで発生したイベントによってコンソールへ表示したりファイルを生成したりできます。\nParcelでは以下のレポーターが提供されます。\n\n* `@parcel/reporter-pretty`\n* `@parcel/reporter-detailed`\n* `@parcel/reporter-graph`\n* `@parcel/reporter-visualizer`\n\n```json\n{\n  "reporters": ["@parcel/reporter-detailed"]\n}\n```\n\n> [.parcelrc](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#parcelrc)\n\n# プラグインの作成\n\n`.parcelrc`の通り、様々な機能に対してプラグインを作成することができます。\nParcel v2では、プラグインの命名規則が厳格に定められています。\nまた、`package.json#engines`に`"parcel": "2.x"`の記述がないとエラーが表示されます。\n\n詳しくは以下。\n\n> [Creating Plugins](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#creating-plugins)\n\n# プラグインAPI\n\nParcel v2ではプラグインAPIがどの機能でも共通のフォーマットで作成できます。\n\n```javascript\nimport { NameOfPluginType } from \'@parcel/plugin\';\n\nexport default new NameOfPluginType({\n  async methodName(opts: JSONObject): Promise<JSONObject> {\n    return result;\n  },\n});\n```\n\n詳しくは以下。\n\n> [Plugin APIs](https://github.com/parcel-bundler/parcel/blob/master/PARCEL_2_RFC.md#plugin-apis)\n',coediting:a,comments_count:0,created_at:"2018-08-31T21:21:08+09:00",group:p,id:"40b46836b87a5711c401",likes_count:11,private:a,reactions_count:0,tags:[{name:_,versions:[]}],title:"📦 Parcel v2のRFCが公開されました 🎉",updated_at:"2019-05-28T01:51:06+09:00",url:"https://qiita.com/simochee/items/40b46836b87a5711c401",user:{description:l,facebook_id:s,followees_count:9,followers_count:t,github_login_name:o,id:i,items_count:e,linkedin_id:s,location:r,name:s,organization:s,permanent_id:d,profile_image_url:m,team_only:a,twitter_screen_name:u,website_url:s},page_views_count:p}]}],error:p,serverRendered:!0}}("",!1,0,null,27,"Nuxt & TypeScript大好きマンです",0,14,"tamuraryoya","simochee","Chiba, Japan",127934,"https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/127934/profile-images/1558357993","lollipop_onl","TypeScript","Vue.js","nuxt.js","2019-10-17T21:35:57+09:00",0,"2019-09-12T10:12:34+09:00","2019-07-05T21:43:22+09:00","vue-property-decorator",0,0,0,"parcel")</script><script src="/_nuxt/63f2c43b668bc41801ef.js" defer></script><script src="/_nuxt/d3c720332ba6bc309111.js" defer></script><script src="/_nuxt/7ad8d55b9f2306065a8d.js" defer></script><script src="/_nuxt/c0393ebd98189b802a9a.js" defer></script>
  </body>
</html>
